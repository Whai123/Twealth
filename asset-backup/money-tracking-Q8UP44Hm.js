const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/csv-analysis-panel-BqnaBnim.js","assets/index-B1iCb0U8.js","assets/index-hqrqeBcj.css","assets/textarea-BqHY_pYZ.js","assets/alert-BQPTTYEE.js","assets/file-text-Cyp2q6dJ.js","assets/index-Ck0Sj8wK.js"])))=>i.map(i=>d[i]);
import{c as W,ay as Qe,az as js,r as g,aA as ys,aB as bs,aC as Ns,aD as vs,aE as ws,aF as xe,aG as Ss,aH as ks,aI as Cs,aJ as Ts,aK as Ms,aL as Ds,aM as Fs,aN as Ye,aO as Es,aP as zs,aQ as As,aR as Ls,aS as $s,aT as Os,aU as Is,aV as Ps,aW as Bs,aX as Vs,aY as ce,aZ as Rs,a_ as _s,a$ as Ws,b0 as Hs,j as e,n as M,x as H,s as V,t as R,w as P,P as Ze,E as me,W as ve,z as Q,a as Je,g as ge,h as K,y as ue,a1 as Xe,D as fe,ag as es,B as I,ah as ss,b as je,d as Ae,e as Le,ab as pe,F as ne,H as re,J as ie,K as le,M as B,I as $e,L as Oe,q as he,o as G,A as Ie,S as ye,b1 as Y,V as L,b2 as Us,b3 as qs,b4 as Ks,b5 as ts,b6 as Gs,X as Qs,b7 as as,b8 as ns,b9 as rs,T as Pe,U as is,a0 as Ys,a5 as Zs,ba as Js,bb as Xs,bc as ls,bd as et,be as st,bf as tt,ac as at}from"./index-B1iCb0U8.js";import{E as cs,B as nt}from"./empty-state-B00YxJ5W.js";import{T as rt,a as it,b as Z,c as J}from"./tabs-BIKejfai.js";import{B as $}from"./badge-BLQt1mrv.js";import{t as we,c as lt,g as ct,s as Be}from"./startOfWeek-D6dzzDOw.js";import{a as ot,C as dt}from"./addMonths-4pYBL7X2.js";import{A as Se,a as ke}from"./arrow-up-right-BxWo8o4Y.js";import{C as os}from"./calendar-BhxlC1A9.js";import{C as Ce,L as be}from"./lightbulb-bY4g1OJs.js";import{C as ee}from"./circle-check-big-BvO-LMIQ.js";import{e as mt}from"./endOfMonth-AzK47_pP.js";import{T as ut}from"./trash-2-CRPKIWBw.js";import{Z as oe}from"./zap-Dg1ivvH7.js";import{A as ds}from"./award-CtYuvMv3.js";import{T as de}from"./trending-down-DnWrfQjq.js";import{F as xt}from"./file-text-Cyp2q6dJ.js";import{G as pt}from"./gift-DaYAbzLt.js";import{C as ht}from"./car-DrHqCdV0.js";import"./message-square-CI5kBZgv.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=W("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=W("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=W("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=W("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=W("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=W("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=W("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=W("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=W("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]);function ms(s){const t=Qe(()=>js(s)),{isStatic:a}=g.useContext(ys);if(a){const[,i]=g.useState(s);g.useEffect(()=>t.on("change",i),[])}return t}function us(s,t){const a=ms(t()),i=()=>a.set(t());return i(),bs(()=>{const n=()=>Ns.preRender(i,!1,!0),o=s.map(m=>m.on("change",n));return()=>{o.forEach(m=>m()),vs(i)}}),a}const vt=s=>s&&typeof s=="object"&&s.mix,wt=s=>vt(s)?s.mix:void 0;function St(...s){const t=!Array.isArray(s[0]),a=t?0:-1,i=s[0+a],n=s[1+a],o=s[2+a],m=s[3+a],u=ws(n,o,{mixer:wt(o[0]),...m});return t?u(i):u}function kt(s){xe.current=[],s();const t=us(xe.current,s);return xe.current=void 0,t}function We(s,t,a,i){if(typeof s=="function")return kt(s);const n=typeof t=="function"?t:St(t,a,i);return Array.isArray(s)?He(s,n):He([s],([o])=>n(o))}function He(s,t){const a=Qe(()=>[]);return us(s,()=>{a.length=0;const i=s.length;for(let n=0;n<i;n++)a[n]=s[n].get();return t(a)})}function Ct(s,t=100,a){const i=a({...s,keyframes:[0,t]}),n=Math.min(Ss(i),ks);return{type:"keyframes",ease:o=>i.next(n*o).value/t,duration:Cs(n)}}function Te(s){return typeof s=="object"&&!Array.isArray(s)}function xs(s,t,a,i){return typeof s=="string"&&Te(t)?Ts(s,a,i):s instanceof NodeList?Array.from(s):Array.isArray(s)?s:[s]}function Ue(s,t,a,i){var n;return typeof t=="number"?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,s+parseFloat(t)):t==="<"?a:(n=i.get(t))!==null&&n!==void 0?n:s}const Tt=(s,t,a)=>{const i=t-s;return((a-s)%i+i)%i+s};function Mt(s,t){return Ms(s)?s[Tt(0,s.length,t)]:s}function Dt(s,t,a){for(let i=0;i<s.length;i++){const n=s[i];n.at>t&&n.at<a&&(Fs(s,n),i--)}}function Ft(s,t,a,i,n,o){Dt(s,n,o);for(let m=0;m<t.length;m++)s.push({value:t[m],at:Ds(n,o,i[m]),easing:Mt(a,m)})}function Et(s,t){return s.at===t.at?s.value===null?1:t.value===null?-1:0:s.at-t.at}const zt="easeInOut";function At(s,{defaultTransition:t={},...a}={},i,n){const o=t.duration||.3,m=new Map,u=new Map,x={},b=new Map;let F=0,S=0,z=0;for(let C=0;C<s.length;C++){const E=s[C];if(typeof E=="string"){b.set(E,S);continue}else if(!Array.isArray(E)){b.set(E.name,Ue(S,E.at,F,b));continue}let[h,l,d={}]=E;d.at!==void 0&&(S=Ue(S,d.at,F,b));let v=0;const T=(f,N,p,j=0,k=0)=>{const c=Lt(f),{delay:w=0,times:y=Es(c),type:A="keyframes",...U}=N;let{ease:_=t.ease||"easeOut",duration:r}=N;const D=typeof w=="function"?w(j,k):w,O=c.length,q=As(A)?A:n==null?void 0:n[A];if(O<=2&&q){let Fe=100;if(O===2&&It(c)){const fs=c[1]-c[0];Fe=Math.abs(fs)}const Ee={...U};r!==void 0&&(Ee.duration=Ls(r));const ze=Ct(Ee,Fe,q);_=ze.ease,r=ze.duration}r??(r=o);const se=S+D,Me=se+r;y.length===1&&y[0]===0&&(y[1]=1);const De=y.length-c.length;De>0&&zs(y,De),c.length===1&&c.unshift(null),Ft(p,c,_,y,se,Me),v=Math.max(D+r,v),z=Math.max(Me,z)};if(Ye(h)){const f=qe(h,u);T(l,d,Ke("default",f))}else{const f=xs(h,l,i,x),N=f.length;for(let p=0;p<N;p++){l=l,d=d;const j=f[p],k=qe(j,u);for(const c in l)T(l[c],$t(d,c),Ke(c,k),p,N)}}F=S,S+=v}return u.forEach((C,E)=>{for(const h in C){const l=C[h];l.sort(Et);const d=[],v=[],T=[];for(let N=0;N<l.length;N++){const{at:p,value:j,easing:k}=l[N];d.push(j),v.push($s(0,z,p)),T.push(k||"easeOut")}v[0]!==0&&(v.unshift(0),d.unshift(d[0]),T.unshift(zt)),v[v.length-1]!==1&&(v.push(1),d.push(null)),m.has(E)||m.set(E,{keyframes:{},transition:{}});const f=m.get(E);f.keyframes[h]=d,f.transition[h]={...t,duration:z,ease:T,times:v,...a}}}),m}function qe(s,t){return!t.has(s)&&t.set(s,{}),t.get(s)}function Ke(s,t){return t[s]||(t[s]=[]),t[s]}function Lt(s){return Array.isArray(s)?s:[s]}function $t(s,t){return s&&s[t]?{...s,...s[t]}:{...s}}const Ot=s=>typeof s=="number",It=s=>s.every(Ot);function Pt(s,t){return s in t}class Bt extends Os{constructor(){super(...arguments),this.type="object"}readValueFromInstance(t,a){if(Pt(a,t)){const i=t[a];if(typeof i=="string"||typeof i=="number")return i}}getBaseTargetFromProps(){}removeValueFromRenderState(t,a){delete a.output[t]}measureInstanceViewportBox(){return Is()}build(t,a){Object.assign(t.output,a)}renderInstance(t,{output:a}){Object.assign(t,a)}sortInstanceNodePosition(){return 0}}function Vt(s){const t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},a=Ps(s)?new Bs(t):new Vs(t);a.mount(s),ce.set(s,a)}function Rt(s){const t={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},a=new Bt(t);a.mount(s),ce.set(s,a)}function _t(s,t){return Ye(s)||typeof s=="number"||typeof s=="string"&&!Te(t)}function ps(s,t,a,i){const n=[];if(_t(s,t))n.push(Rs(s,Te(t)&&t.default||t,a&&(a.default||a)));else{const o=xs(s,t,i),m=o.length;for(let u=0;u<m;u++){const x=o[u],b=x instanceof Element?Vt:Rt;ce.has(x)||b(x);const F=ce.get(x),S={...a};"delay"in S&&typeof S.delay=="function"&&(S.delay=S.delay(u,m)),n.push(..._s(F,{...t,transition:S},{}))}}return n}function Wt(s,t,a){const i=[];return At(s,t,a,{spring:Ws}).forEach(({keyframes:o,transition:m},u)=>{i.push(...ps(u,o,m))}),i}function Ht(s){return Array.isArray(s)&&Array.isArray(s[0])}function Ut(s){function t(a,i,n){let o=[];return Ht(a)?o=Wt(a,i,s):o=ps(a,i,n,s),new Hs(o)}return t}const X=Ut();function qt(s,t){const a=we(s);return isNaN(t)?lt(s,NaN):(a.setDate(a.getDate()+t),a)}function Kt(s,t){const a=t*7;return qt(s,a)}function Ne(s){const t=we(s);return t.setDate(1),t.setHours(0,0,0,0),t}function Gt(s,t){var u,x;const a=ct(),i=a.weekStartsOn??((x=(u=a.locale)==null?void 0:u.options)==null?void 0:x.weekStartsOn)??0,n=we(s),o=n.getDay(),m=(o<i?-7:0)+6-(o-i);return n.setDate(n.getDate()+m),n.setHours(23,59,59,999),n}function Qt(s,t){return ot(s,-1)}function Yt(s,t){return Kt(s,-1)}function Zt({transactions:s,timeRange:t}){const[a,i]=g.useState("month"),n=s.filter(p=>p.type==="expense"),o=n.reduce((p,j)=>{const k=j.category||"other";return p[k]=(p[k]||0)+parseFloat(j.amount),p},{}),m=Object.values(o).reduce((p,j)=>p+j,0),u=Object.entries(o).sort(([,p],[,j])=>j-p).slice(0,6),x=new Date,b=Ne(x),F=Ne(Qt(x)),S=n.filter(p=>new Date(p.date)>=b).reduce((p,j)=>p+parseFloat(j.amount),0),z=n.filter(p=>{const j=new Date(p.date);return j>=F&&j<b}).reduce((p,j)=>p+parseFloat(j.amount),0),C=z>0?(S-z)/z*100:0,E=parseInt(t),h=m/E,l=7,v=n.filter(p=>{const j=new Date(p.date),k=new Date(Date.now()-l*24*60*60*1e3);return j>=k}).reduce((p,j)=>p+parseFloat(j.amount),0)/l,T=v>h?"increasing":"stable",f=p=>{const j=["bg-primary","bg-primary/80","bg-primary/60","bg-primary/40","bg-muted-foreground/60","bg-muted-foreground/40"];return j[p%j.length]},N=p=>"";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Monthly Change"}),e.jsxs("p",{className:`text-2xl font-bold ${C>=0?"text-red-600":"text-green-600"}`,children:[C>=0?"+":"",C.toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"vs last month"})]}),e.jsx("div",{className:`w-12 h-12 ${C>=0?"bg-red-100 dark:bg-red-900/20":"bg-green-100 dark:bg-green-900/20"} rounded-lg flex items-center justify-center`,children:C>=0?e.jsx(Se,{className:"text-red-600",size:24}):e.jsx(ke,{className:"text-green-600",size:24})})]})}),e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Daily Average"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["$",h.toFixed(0)]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["last ",t," days"]})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex items-center justify-center",children:e.jsx(os,{className:"text-blue-600",size:24})})]})}),e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Spending Velocity"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["$",v.toFixed(0),"/day"]}),e.jsx($,{variant:T==="increasing"?"destructive":"secondary",className:"mt-1",children:T==="increasing"?"High":"Stable"})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-100 dark:bg-orange-900/20 rounded-lg flex items-center justify-center",children:e.jsx(H,{className:"text-orange-600",size:24})})]})})]}),e.jsxs(M,{className:"p-6",children:[e.jsx(V,{className:"px-0 pt-0",children:e.jsxs(R,{className:"flex items-center",children:[e.jsx(dt,{className:"mr-2",size:20}),"Spending by Category"]})}),e.jsx(P,{className:"px-0",children:e.jsx("div",{className:"space-y-4",children:u.map(([p,j],k)=>{const c=m>0?j/m*100:0;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-lg mr-2",children:N()}),e.jsx("span",{className:"font-medium capitalize",children:p.replace("_"," ")})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold",children:["$",j.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[c.toFixed(1),"%"]})]})]}),e.jsx(Ze,{value:c,className:"h-2"})]},p)})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(M,{className:"p-6",children:[e.jsx(V,{className:"px-0 pt-0",children:e.jsxs(R,{className:"flex items-center",children:[e.jsx(Ce,{className:"mr-2",size:20}),"Top Spending Categories"]})}),e.jsx(P,{className:"px-0",children:e.jsx("div",{className:"space-y-3",children:u.slice(0,3).map(([p,j],k)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 ${f(k)} rounded-full mr-3`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium capitalize",children:p.replace("_"," ")}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[m>0?(j/m*100).toFixed(1):0,"% of spending"]})]})]}),e.jsxs("p",{className:"font-bold",children:["$",j.toLocaleString()]})]},p))})})]}),e.jsxs(M,{className:"p-6",children:[e.jsx(V,{className:"px-0 pt-0",children:e.jsxs(R,{className:"flex items-center",children:[e.jsx(me,{className:"mr-2",size:20}),"Spending Health"]})}),e.jsx(P,{className:"px-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ee,{className:"text-green-600 mr-3",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Consistent Spending"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Good weekly patterns"})]})]}),e.jsx($,{variant:"secondary",className:"bg-green-100 text-green-800 dark:bg-green-900/20",children:"Healthy"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ve,{className:"text-yellow-600 mr-3",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"High Dining Expenses"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Consider meal planning"})]})]}),e.jsx($,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20",children:"Watch"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{className:"text-blue-600 mr-3",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Savings Opportunity"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Reduce entertainment by 15%"})]})]}),e.jsx($,{variant:"secondary",className:"bg-blue-100 text-blue-800 dark:bg-blue-900/20",children:"Opportunity"})]})]})})]})]})]})}const Ge=[{value:"dining",label:"Dining Out"},{value:"groceries",label:"Groceries"},{value:"transport",label:"Transportation"},{value:"utilities",label:"Utilities"},{value:"entertainment",label:"Entertainment"},{value:"shopping",label:"Shopping"},{value:"healthcare",label:"Healthcare"},{value:"education",label:"Education"},{value:"insurance",label:"Insurance"},{value:"rent",label:"Rent/Mortgage"},{value:"subscriptions",label:"Subscriptions"},{value:"other",label:"Other"}];function Jt({transactions:s,timeRange:t}){const{toast:a}=Je(),[i,n]=g.useState(!1),[o,m]=g.useState(null),[u,x]=g.useState({category:"",monthlyLimit:""}),{data:b=[],isLoading:F}=ge({queryKey:["/api/budgets"]}),S=new Date,z=Ne(S),C=mt(S),h=s.filter(r=>{const D=new Date(r.date);return r.type==="expense"&&D>=z&&D<=C}).reduce((r,D)=>{const O=(D.category||"other").toLowerCase();return r[O]=(r[O]||0)+parseFloat(D.amount),r},{}),l=b.map(r=>{const D=h[r.category]||0,O=parseFloat(r.monthlyLimit),q=O>0?D/O*100:0,se=q>100?"over":q>80?"warning":"good";return{...r,spent:D,limit:O,percentage:q,status:se,remaining:Math.max(0,O-D)}}).sort((r,D)=>D.percentage-r.percentage),d=l.reduce((r,D)=>r+D.limit,0),v=l.reduce((r,D)=>r+D.spent,0),T=d>0?v/d*100:0,f=K({mutationFn:async r=>await G("POST","/api/budgets",r),onSuccess:()=>{he.invalidateQueries({queryKey:["/api/budgets"]}),a({title:"Budget Created",description:"Your budget has been added successfully."}),n(!1),x({category:"",monthlyLimit:""})},onError:r=>{a({title:"Error",description:r.message,variant:"destructive"})}}),N=K({mutationFn:async({id:r,data:D})=>await G("PUT",`/api/budgets/${r}`,D),onSuccess:()=>{he.invalidateQueries({queryKey:["/api/budgets"]}),a({title:"Budget Updated",description:"Your budget has been updated successfully."}),m(null)},onError:r=>{a({title:"Error",description:r.message,variant:"destructive"})}}),p=K({mutationFn:async r=>await G("DELETE",`/api/budgets/${r}`),onSuccess:()=>{he.invalidateQueries({queryKey:["/api/budgets"]}),a({title:"Budget Deleted",description:"Budget has been removed."})},onError:r=>{a({title:"Error",description:r.message,variant:"destructive"})}}),j=r=>{if(r.preventDefault(),!u.category||!u.monthlyLimit){a({title:"Validation Error",description:"Please fill in all fields",variant:"destructive"});return}o?N.mutate({id:o.id,data:{monthlyLimit:u.monthlyLimit}}):f.mutate(u)},k=r=>{switch(r){case"over":return"text-red-600";case"warning":return"text-yellow-600";default:return"text-green-600"}},c=r=>{switch(r){case"over":return e.jsx($,{variant:"destructive",children:"Over Budget"});case"warning":return e.jsx($,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20",children:"Near Limit"});default:return e.jsx($,{variant:"secondary",className:"bg-green-100 text-green-800 dark:bg-green-900/20",children:"On Track"})}},w=r=>{const D=Ge.find(O=>O.value===r);return D?D.label:r.charAt(0).toUpperCase()+r.slice(1)},y=[],A=l.filter(r=>r.status==="over");A.length>0&&y.push({type:"warning",title:"Reduce Overspending",description:`Cut back on ${A[0].category} by $${(A[0].spent-A[0].limit).toFixed(0)}`,impact:"Get back on track this month"}),b.length===0&&y.push({type:"opportunity",title:"Start Budget Tracking",description:"Create budgets for your top spending categories",impact:"Take control of your finances"});const U=l.filter(r=>r.status==="good").length,_=l.length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Budget"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["$",d.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[b.length," ",b.length===1?"category":"categories"]})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex items-center justify-center",children:e.jsx(me,{className:"text-blue-600",size:24})})]})}),e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Budget Used"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[T.toFixed(0),"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["$",v.toLocaleString()," spent"]})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-100 dark:bg-orange-900/20 rounded-lg flex items-center justify-center",children:e.jsx(H,{className:"text-orange-600",size:24})})]})}),e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Remaining"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["$",(d-v).toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"for this month"})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-lg flex items-center justify-center",children:e.jsx(ue,{className:"text-green-600",size:24})})]})})]}),e.jsxs(M,{className:"p-6",children:[e.jsxs(V,{className:"px-0 pt-0 flex flex-row items-center justify-between",children:[e.jsxs(R,{className:"flex items-center",children:[e.jsx(Xe,{className:"mr-2",size:20}),"Your Budgets"]}),e.jsxs(fe,{open:i,onOpenChange:n,children:[e.jsx(es,{asChild:!0,children:e.jsxs(I,{size:"sm","data-testid":"button-add-budget",children:[e.jsx(ss,{className:"mr-1",size:16}),"Add Budget"]})}),e.jsxs(je,{children:[e.jsx(Ae,{children:e.jsx(Le,{children:"Create Budget"})}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(pe,{htmlFor:"budget-category",children:"Category"}),e.jsxs(ne,{value:u.category,onValueChange:r=>x({...u,category:r}),required:!0,children:[e.jsx(re,{id:"budget-category","data-testid":"select-budget-category",children:e.jsx(ie,{placeholder:"Select category"})}),e.jsx(le,{children:Ge.map(r=>e.jsx(B,{value:r.value,children:r.label},r.value))})]})]}),e.jsxs("div",{children:[e.jsx(pe,{htmlFor:"budget-limit",children:"Monthly Limit ($)"}),e.jsx($e,{id:"budget-limit",type:"number",step:"0.01",min:"0",placeholder:"500.00",value:u.monthlyLimit,onChange:r=>x({...u,monthlyLimit:r.target.value}),"data-testid":"input-budget-limit",required:!0})]}),e.jsxs(I,{type:"submit",disabled:f.isPending,"data-testid":"button-submit-budget",children:[f.isPending&&e.jsx(Oe,{className:"mr-2 h-4 w-4"}),f.isPending?"Creating...":"Create Budget"]})]})]})]})]}),e.jsx(P,{className:"px-0",children:F?e.jsx("p",{className:"text-muted-foreground",children:"Loading budgets..."}):l.length===0?e.jsx(cs,{illustration:"budgets",title:"No Budgets Created Yet",description:"Set up your first budget to track spending and stay on top of your finances.",actionLabel:"Create Your First Budget",onAction:()=>n(!0),actionTestId:"button-create-first-budget"}):e.jsx("div",{className:"space-y-4",children:l.map(r=>e.jsxs("div",{className:"space-y-2 p-4 rounded-lg border border-transparent hover:border-border hover:bg-muted/50 hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center flex-1",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:w(r.category)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",r.spent.toLocaleString()," of $",r.limit.toLocaleString()]})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right mr-2",children:[e.jsxs("p",{className:`font-bold ${k(r.status)}`,children:[r.percentage.toFixed(0),"%"]}),c(r.status)]}),e.jsx(I,{variant:"ghost",size:"icon",onClick:()=>{m(r),x({category:r.category,monthlyLimit:r.monthlyLimit})},"data-testid":`button-edit-budget-${r.id}`,children:e.jsx(jt,{size:16})}),e.jsx(I,{variant:"ghost",size:"icon",onClick:()=>p.mutate(r.id),"data-testid":`button-delete-budget-${r.id}`,children:e.jsx(ut,{size:16,className:"text-red-600"})})]})]}),e.jsx(Ze,{value:Math.min(r.percentage,100),className:"h-2"}),r.status==="good"&&r.remaining>0&&e.jsxs("p",{className:"text-xs text-green-600",children:["$",r.remaining.toFixed(0)," remaining this month"]}),r.status==="over"&&e.jsxs("p",{className:"text-xs text-red-600",children:["Over budget by $",(r.spent-r.limit).toFixed(0)]})]},r.id))})})]}),o&&e.jsx(fe,{open:!!o,onOpenChange:()=>m(null),children:e.jsxs(je,{children:[e.jsx(Ae,{children:e.jsxs(Le,{children:["Edit Budget - ",w(o.category)]})}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(pe,{children:"Monthly Limit"}),e.jsx($e,{type:"number",step:"0.01",value:u.monthlyLimit,onChange:r=>x({...u,monthlyLimit:r.target.value}),"data-testid":"input-edit-budget-limit"})]}),e.jsxs(I,{type:"submit",disabled:N.isPending,"data-testid":"button-update-budget",children:[N.isPending&&e.jsx(Oe,{className:"mr-2 h-4 w-4"}),N.isPending?"Updating...":"Update Budget"]})]})]})}),y.length>0&&e.jsxs(M,{className:"p-6",children:[e.jsx(V,{className:"px-0 pt-0",children:e.jsxs(R,{className:"flex items-center",children:[e.jsx(oe,{className:"mr-2",size:20}),"Smart Recommendations"]})}),e.jsx(P,{className:"px-0",children:e.jsx("div",{className:"space-y-4",children:y.map((r,D)=>e.jsxs("div",{className:"flex items-start p-4 bg-muted/30 rounded-lg",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mr-3 ${r.type==="warning"?"bg-red-100 dark:bg-red-900/20":r.type==="opportunity"?"bg-green-100 dark:bg-green-900/20":"bg-blue-100 dark:bg-blue-900/20"}`,children:r.type==="warning"?e.jsx(ve,{className:"text-red-600",size:20}):r.type==="opportunity"?e.jsx(H,{className:"text-green-600",size:20}):e.jsx(ds,{className:"text-blue-600",size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:r.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description}),e.jsx("p",{className:"text-xs text-green-600 font-medium mt-1",children:r.impact})]})]},D))})})]}),l.length>0&&e.jsxs(M,{className:"p-6",children:[e.jsx(V,{className:"px-0 pt-0",children:e.jsxs(R,{className:"flex items-center",children:[e.jsx(ee,{className:"mr-2",size:20}),"Budget Performance"]})}),e.jsx(P,{className:"px-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:[_>0?Math.round(U/_*100):0,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"On Track"}),e.jsxs($,{variant:"secondary",className:"bg-green-100 text-green-800 dark:bg-green-900/20 mt-2",children:[U,"/",_," Categories"]})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:_}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Budgets"}),e.jsx($,{variant:"secondary",className:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 mt-2",children:"Tracking"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:["$",(d-v>0?d-v:0).toLocaleString()]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Left to Spend"}),e.jsx($,{variant:"secondary",className:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 mt-2",children:"This Month"})]})]})})]})]})}function Xt({transactions:s,timeRange:t}){const[a,i]=g.useState("all"),n=g.useMemo(()=>s.filter(l=>l.type==="expense"),[s]),o=g.useMemo(()=>s.filter(l=>l.type==="income"),[s]),m=g.useMemo(()=>n.reduce((l,d)=>l+parseFloat(d.amount),0),[n]),u=g.useMemo(()=>o.reduce((l,d)=>l+parseFloat(d.amount),0),[o]),{thisWeekExpenses:x,lastWeekExpenses:b}=g.useMemo(()=>{const l=new Date,d=Yt(l),v=n.filter(f=>new Date(f.date)>=Be(l)).reduce((f,N)=>f+parseFloat(N.amount),0),T=n.filter(f=>{const N=new Date(f.date);return N>=Be(d)&&N<Gt(d)}).reduce((f,N)=>f+parseFloat(N.amount),0);return{thisWeekExpenses:v,lastWeekExpenses:T}},[n]),F=g.useMemo(()=>n.reduce((l,d)=>{const v=new Date(d.date).getDay(),f=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][v];return l[f]=(l[f]||0)+parseFloat(d.amount),l},{}),[n]),S=()=>{const l=[],d=(F.Saturday||0)+(F.Sunday||0),v=m-d;d>v*.4&&l.push({type:"pattern",title:"High Weekend Spending",description:"You spend 40% more on weekends. Consider planning weekend activities with a budget.",potential_saving:d*.2,action:"Set weekend spending limit",priority:"medium",icon:os});const T=n.filter(c=>parseFloat(c.amount)<50).length,f=n.filter(c=>parseFloat(c.amount)>=50).length;T>f*2&&l.push({type:"behavior",title:"Frequent Small Purchases",description:`${T} small purchases under $50. These add up quickly.`,potential_saving:T*15,action:"Track micro-spending",priority:"high",icon:ve});const N=n.reduce((c,w)=>{const y=w.category||"other";return c[y]=(c[y]||0)+parseFloat(w.amount),c},{}),p=Object.entries(N).reduce((c,[w,y])=>y>c.amount?{category:w,amount:y}:c,{category:"",amount:0});p.amount>m*.4&&l.push({type:"concentration",title:"Category Over-Concentration",description:`${p.category} represents ${(p.amount/m*100).toFixed(0)}% of spending.`,potential_saving:p.amount*.15,action:"Diversify spending",priority:"medium",icon:me});const j=u>0?(u-m)/u*100:0;j<20&&u>0&&l.push({type:"opportunity",title:"Savings Opportunity",description:`Current savings rate: ${j.toFixed(1)}%. Aim for 20%+ for financial health.`,potential_saving:u*.2-(u-m),action:"Increase savings rate",priority:"high",icon:ue});const k=b>0?(x-b)/b*100:0;return Math.abs(k)>25&&l.push({type:"trend",title:k>0?"Spending Spike":"Spending Drop",description:`${Math.abs(k).toFixed(0)}% ${k>0?"increase":"decrease"} from last week.`,potential_saving:k>0?x*.1:0,action:k>0?"Review recent purchases":"Maintain good habits",priority:k>0?"high":"low",icon:k>0?H:de}),l.sort((c,w)=>{const y={high:3,medium:2,low:1};return y[w.priority]-y[c.priority]})},z=g.useMemo(()=>S(),[s,n,m,u,F,x,b]),C=()=>{const l=[],d=n.reduce((f,N)=>{const p=parseFloat(N.amount),j=Math.ceil(p)-p;return f+j},0);l.push({type:"automation",title:"Round-Up Savings",description:"Automatically save spare change from purchases.",benefit:`$${d.toFixed(0)} saved this period`,action:"Enable round-up",difficulty:"Easy"}),n.filter(f=>parseFloat(f.amount)>5&&parseFloat(f.amount)<100&&f.category==="entertainment").length>3&&l.push({type:"optimization",title:"Subscription Audit",description:"Review recurring entertainment expenses for unused services.",benefit:"Save $50-200/month",action:"Review subscriptions",difficulty:"Medium"});const T=n.filter(f=>f.category==="dining").reduce((f,N)=>f+parseFloat(N.amount),0);return T>300&&l.push({type:"lifestyle",title:"Meal Prep Opportunity",description:"High dining expenses. Meal prepping could reduce costs significantly.",benefit:`Save $${(T*.4).toFixed(0)}/month`,action:"Start meal prepping",difficulty:"Medium"}),l.slice(0,3)},E=g.useMemo(()=>C(),[n,m,u,s]),h=l=>{switch(l){case"high":return e.jsx($,{variant:"destructive",children:"High Priority"});case"medium":return e.jsx($,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20",children:"Medium"});default:return e.jsx($,{variant:"secondary",className:"bg-green-100 text-green-800 dark:bg-green-900/20",children:"Low Priority"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Insights Generated"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:z.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"AI-powered"})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex items-center justify-center",children:e.jsx(Xe,{className:"text-blue-600",size:24})})]})}),e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Potential Savings"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["$",z.reduce((l,d)=>l+(d.potential_saving||0),0).toFixed(0)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"per month"})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-lg flex items-center justify-center",children:e.jsx(Q,{className:"text-green-600",size:24})})]})}),e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Weekly Trend"}),e.jsx("p",{className:`text-2xl font-bold ${x>b?"text-red-600":"text-green-600"}`,children:b>0?`${x>b?"+":""}${((x-b)/b*100).toFixed(0)}%`:"0%"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"vs last week"})]}),e.jsx("div",{className:`w-12 h-12 ${x>b?"bg-red-100 dark:bg-red-900/20":"bg-green-100 dark:bg-green-900/20"} rounded-lg flex items-center justify-center`,children:x>b?e.jsx(H,{className:"text-red-600",size:24}):e.jsx(de,{className:"text-green-600",size:24})})]})})]}),e.jsxs(M,{className:"p-6",children:[e.jsx(V,{className:"px-0 pt-0",children:e.jsxs(R,{className:"flex items-center",children:[e.jsx(be,{className:"mr-2",size:20}),"AI-Powered Spending Insights"]})}),e.jsx(P,{className:"px-0",children:e.jsx("div",{className:"space-y-4",children:z.map((l,d)=>e.jsxs("div",{className:"flex items-start justify-between p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center mr-3",children:e.jsx(l.icon,{className:"text-blue-600",size:20})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold",children:l.title}),h(l.priority)]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.description}),l.potential_saving>0&&e.jsxs("p",{className:"text-sm text-green-600 font-medium mt-1",children:["Save $",l.potential_saving.toFixed(0),"/month"]})]})]}),e.jsxs(I,{variant:"outline",size:"sm",children:[l.action,e.jsx(Ie,{className:"ml-1",size:14})]})]},d))})})]}),e.jsxs(M,{className:"p-6",children:[e.jsx(V,{className:"px-0 pt-0",children:e.jsxs(R,{className:"flex items-center",children:[e.jsx(ye,{className:"mr-2",size:20}),"Smart Money-Saving Recommendations"]})}),e.jsx(P,{className:"px-0",children:e.jsx("div",{className:"space-y-4",children:E.map((l,d)=>e.jsxs("div",{className:"flex items-start justify-between p-4 bg-white dark:bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-white dark:bg-gray-900 rounded-full flex items-center justify-center mr-3",children:e.jsx(oe,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold",children:l.title}),e.jsx($,{variant:"outline",children:l.difficulty})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.description}),e.jsx("p",{className:"text-sm text-green-600 font-medium mt-1",children:l.benefit})]})]}),e.jsxs(I,{className:"bg-primary text-primary-foreground",size:"sm",children:[l.action,e.jsx(Ie,{className:"ml-1",size:14})]})]},d))})})]}),e.jsxs(M,{className:"p-6",children:[e.jsx(V,{className:"px-0 pt-0",children:e.jsxs(R,{className:"flex items-center",children:[e.jsx(ds,{className:"mr-2",size:20}),"Your Spending Patterns"]})}),e.jsx(P,{className:"px-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Daily Spending Average"}),Object.entries(F).map(([l,d])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:l}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-20 h-2 bg-muted rounded-full mr-2",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${d/Math.max(...Object.values(F).map(Number))*100}%`}})}),e.jsxs("span",{className:"text-sm font-medium",children:["$",d.toFixed(0)]})]})]},l))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Smart Insights Score"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Spending Awareness"}),e.jsx("span",{className:"text-sm font-medium",children:"85%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Budget Control"}),e.jsx("span",{className:"text-sm font-medium",children:"78%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Savings Potential"}),e.jsx("span",{className:"text-sm font-medium",children:"92%"})]}),e.jsxs("div",{className:"flex justify-between font-semibold",children:[e.jsx("span",{className:"text-sm",children:"Overall Score"}),e.jsx("span",{className:"text-sm text-green-600",children:"85/100"})]})]})]})]})})]})]})}const te=80;function ea({transaction:s,onArchive:t,onFlag:a}){const[i,n]=g.useState(!1),[o,m]=g.useState(!1),u=g.useRef(null),x=ms(0),b=We(x,[-te,0],[1,0]),F=We(x,[0,te],[0,1]),S=g.useCallback(h=>{h.key==="ArrowLeft"&&t?(h.preventDefault(),X(x,-300,{duration:.3,ease:"easeOut",onComplete:()=>{t(s.id),x.set(0)}})):h.key==="ArrowRight"&&a?(h.preventDefault(),X(x,300,{duration:.3,ease:"easeOut",onComplete:()=>{a(s.id),x.set(0)}})):h.key==="a"&&t?(h.preventDefault(),t(s.id)):h.key==="f"&&a&&(h.preventDefault(),a(s.id))},[x,t,a,s.id]),z=h=>{switch(h){case"income":return e.jsx(H,{className:"text-green-600",size:16});case"expense":return e.jsx(de,{className:"text-red-600",size:16});case"transfer":return e.jsx(Q,{className:"text-blue-600",size:16});default:return e.jsx(Q,{className:"text-gray-600",size:16})}},C=h=>{switch(h){case"income":return"text-green-600";case"expense":return"text-red-600";case"transfer":return"text-blue-600";default:return"text-gray-600"}},E=(h,l)=>{n(!1);const d=l.offset.x;d<-te&&t?X(x,-300,{duration:.3,ease:"easeOut",onComplete:()=>{t(s.id),x.set(0)}}):d>te&&a?X(x,300,{duration:.3,ease:"easeOut",onComplete:()=>{a(s.id),x.set(0)}}):X(x,0,{duration:.3,ease:"easeOut"})};return e.jsxs("div",{ref:u,tabIndex:0,role:"button","aria-label":`${s.description||s.category}: ${s.type==="income"?"+":"-"}$${Math.abs(parseFloat(s.amount)).toLocaleString()}. Press left arrow or A to archive, right arrow or F to flag.`,onKeyDown:S,onFocus:()=>m(!0),onBlur:()=>m(!1),className:Y("relative overflow-hidden rounded-lg border outline-none",o&&"ring-2 ring-blue-500 ring-offset-2 ring-offset-background"),children:[e.jsxs("div",{className:"absolute inset-0 flex items-center justify-between px-6 pointer-events-none",children:[e.jsxs(L.div,{style:{opacity:b},className:"flex items-center gap-2 text-red-600 font-medium",children:[e.jsx(Ve,{size:20}),e.jsx("span",{className:"text-sm",children:"Archive"})]}),e.jsxs(L.div,{style:{opacity:F},className:"flex items-center gap-2 text-amber-600 font-medium",children:[e.jsx("span",{className:"text-sm",children:"Flag"}),e.jsx(_e,{size:20})]})]}),e.jsxs(L.div,{drag:"x",dragConstraints:{left:-150,right:150},dragElastic:.2,onDragStart:()=>n(!0),onDragEnd:E,style:{x},className:Y("flex items-center justify-between bg-background border-0 rounded-lg transition-colors relative z-10",i?"cursor-grabbing":"cursor-grab hover:bg-muted/50"),children:[e.jsxs("div",{className:"flex items-center min-w-0 flex-1",style:{gap:"var(--space-3)",padding:"var(--space-3)"},children:[e.jsx("div",{className:"bg-muted rounded-lg flex items-center justify-center flex-shrink-0",style:{width:"32px",height:"32px"},children:z(s.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-foreground truncate","data-testid":`text-transaction-${s.id}`,style:{fontSize:"var(--text-sm)"},title:s.description||s.category,children:s.description||s.category}),e.jsxs("div",{className:"flex items-center text-muted-foreground",style:{gap:"var(--space-2)",fontSize:"var(--text-xs)"},children:[e.jsx("span",{children:new Date(s.date).toLocaleDateString()}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:s.category.replace("_"," ")}),s.isArchived&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{className:"text-red-600 flex items-center gap-1",children:[e.jsx(Ve,{size:12}),"Archived"]})]}),s.isFlagged&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{className:"text-amber-600 flex items-center gap-1",children:[e.jsx(_e,{size:12}),"Flagged"]})]})]})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",style:{paddingRight:"var(--space-3)"},children:[e.jsxs("span",{className:`font-semibold whitespace-nowrap ${C(s.type)}`,style:{fontSize:"var(--text-base)"},"data-testid":`text-amount-${s.id}`,children:[s.type==="income"?"+":"-","$",Math.abs(parseFloat(s.amount)).toLocaleString()]}),s.goalId&&e.jsx("p",{className:"text-muted-foreground whitespace-nowrap",style:{fontSize:"var(--text-xs)"},children:"Goal contribution"})]})]})]})}const sa=Us,ta=qs,aa=Ks,hs=g.forwardRef(({className:s,...t},a)=>e.jsx(as,{ref:a,className:Y("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));hs.displayName=as.displayName;const gs=g.forwardRef(({className:s,children:t,...a},i)=>e.jsxs(aa,{children:[e.jsx(hs,{}),e.jsxs(ts,{ref:i,className:Y("fixed bottom-0 left-0 right-0 z-50 grid w-full gap-4 border-t bg-background p-6 shadow-lg","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom","rounded-t-2xl","max-h-[85vh] overflow-y-auto",s),...a,children:[e.jsx("div",{className:"mx-auto w-12 h-1.5 rounded-full bg-muted-foreground/20 mb-4"}),t,e.jsxs(Gs,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground","data-testid":"button-close-sheet",children:[e.jsx(Qs,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));gs.displayName=ts.displayName;const na=g.forwardRef(({className:s,...t},a)=>e.jsx(ns,{ref:a,className:Y("text-xl font-semibold leading-none tracking-tight",s),...t}));na.displayName=ns.displayName;const ra=g.forwardRef(({className:s,...t},a)=>e.jsx(rs,{ref:a,className:Y("text-sm text-muted-foreground",s),...t}));ra.displayName=rs.displayName;function ia({open:s,onOpenChange:t,triggerButton:a}){const[i,n]=g.useState(!1);g.useEffect(()=>{const u=()=>{n(window.innerWidth<768)};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]);const o=e.jsxs(I,{className:"bg-primary hover:bg-primary/90 text-primary-foreground shadow-sm min-h-[44px] hidden md:flex","data-testid":"button-add-transaction",children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Add"]}),m=()=>{t&&t(!1)};return i?e.jsxs(sa,{open:s,onOpenChange:t,children:[e.jsx(ta,{asChild:!0,children:a||o}),e.jsx(gs,{children:e.jsx(Pe,{onSuccess:m})})]}):e.jsxs(fe,{open:s,onOpenChange:t,children:[e.jsx(es,{asChild:!0,children:a||o}),e.jsx(je,{className:"max-w-md",children:e.jsx(Pe,{onSuccess:m})})]})}function la({items:s,renderItem:t,keyExtractor:a,initialVisible:i=5,showMoreLabel:n="Show more",showLessLabel:o="Show less",className:m="",emptyState:u}){const[x,b]=g.useState(!1),F=g.useRef(new Set),S=g.useRef(null),z=x?s:s.slice(0,i),C=s.length>i,E=g.useCallback(l=>F.current.has(l)?!1:(F.current.add(l),!0),[]),h=g.useCallback(()=>{b(l=>!l)},[]);return s.length===0&&u?e.jsx(e.Fragment,{children:u}):e.jsxs("div",{ref:S,className:m,children:[e.jsx(is,{mode:"sync",children:z.map((l,d)=>{const v=a(l),T=E(v),f=x&&d>=i;return e.jsx(L.div,{initial:T?{opacity:0,y:12}:!1,animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.2,delay:T&&f?(d-i)*.025:T?Math.min(d*.025,.15):0,ease:[.25,.1,.25,1]},children:t(l,d)},v)})}),C&&e.jsxs(L.button,{initial:{opacity:0},animate:{opacity:1},onClick:h,className:"w-full py-3 text-sm text-primary hover:text-primary/80 font-medium flex items-center justify-center gap-2 transition-colors","data-testid":"button-toggle-list-expansion",children:[e.jsx(L.span,{animate:{rotate:x?180:0},transition:{duration:.2},children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m6 9 6 6 6-6"})})}),x?o:`${n} (${s.length-i} more)`]})]})}const ca=g.lazy(()=>et(()=>import("./csv-analysis-panel-BqnaBnim.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),oa={income:["salary","freelance","investment","gift","other"],expense:["rent","utilities","groceries","dining","transport","healthcare","entertainment","shopping","other"],transfer:["savings","investment","goal_contribution"]},da=s=>({salary:e.jsx(nt,{className:"w-4 h-4"}),freelance:e.jsx(oe,{className:"w-4 h-4"}),investment:e.jsx(H,{className:"w-4 h-4"}),rent:e.jsx(at,{className:"w-4 h-4"}),utilities:e.jsx(oe,{className:"w-4 h-4"}),groceries:e.jsx(bt,{className:"w-4 h-4"}),dining:e.jsx(Nt,{className:"w-4 h-4"}),transport:e.jsx(ht,{className:"w-4 h-4"}),healthcare:e.jsx(ft,{className:"w-4 h-4"}),entertainment:e.jsx(tt,{className:"w-4 h-4"}),shopping:e.jsx(st,{className:"w-4 h-4"}),gift:e.jsx(pt,{className:"w-4 h-4"}),savings:e.jsx(ue,{className:"w-4 h-4"}),travel:e.jsx(yt,{className:"w-4 h-4"}),coffee:e.jsx(gt,{className:"w-4 h-4"}),other:e.jsx(ls,{className:"w-4 h-4"})})[s.toLowerCase()]||e.jsx(Q,{className:"w-4 h-4"});function ma({value:s,prefix:t="$",decimals:a=0}){const[i,n]=g.useState(0);return g.useEffect(()=>{const u=s/60;let x=0;const b=setInterval(()=>{x+=u,x>=s?(n(s),clearInterval(b)):n(x)},1e3/60);return()=>clearInterval(b)},[s]),e.jsxs("span",{children:[t,i.toLocaleString(void 0,{minimumFractionDigits:a,maximumFractionDigits:a})]})}function ae({title:s,value:t,icon:a,trend:i,trendLabel:n,colorClass:o,bgClass:m,delay:u=0}){return e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:u},children:e.jsxs(M,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300 border-border/40",children:[e.jsx("div",{className:`absolute inset-0 ${m} opacity-50`}),e.jsxs(P,{className:"relative p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3 sm:mb-4",children:[e.jsx("div",{className:`p-2 sm:p-2.5 rounded-xl ${m}`,children:e.jsx(a,{className:`w-4 h-4 sm:w-5 sm:h-5 ${o}`})}),i&&e.jsxs("div",{className:`flex items-center gap-1 text-xs font-medium ${i==="up"?"text-green-600":i==="down"?"text-red-600":"text-muted-foreground"}`,children:[i==="up"?e.jsx(Se,{className:"w-3 h-3"}):i==="down"?e.jsx(ke,{className:"w-3 h-3"}):null,n]})]}),e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground mb-1",children:s}),e.jsx("p",{className:`text-xl sm:text-3xl font-bold tracking-tight ${o}`,children:e.jsx(ma,{value:t})})]})]})})}function ua({transactions:s}){const t=g.useMemo(()=>{const i={};return s.filter(n=>n.type==="expense").forEach(n=>{const o=n.category||"other";i[o]=(i[o]||0)+parseFloat(n.amount)}),Object.entries(i).map(([n,o])=>({category:n,amount:o})).sort((n,o)=>o.amount-n.amount).slice(0,5)},[s]),a=t.reduce((i,n)=>i+n.amount,0);return t.length===0?null:e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.3},children:e.jsxs(M,{className:"border-border/40",children:[e.jsx(V,{className:"pb-3 sm:pb-4",children:e.jsxs(R,{className:"text-sm sm:text-base font-semibold flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4 text-primary"}),"Top Spending Categories"]})}),e.jsx(P,{className:"space-y-3 sm:space-y-4",children:t.map((i,n)=>{const o=a>0?i.amount/a*100:0;return e.jsxs(L.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:n*.1},className:"space-y-1.5 sm:space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-muted",children:da(i.category)}),e.jsx("span",{className:"font-medium capitalize",children:i.category})]}),e.jsxs("span",{className:"font-semibold",children:["$",i.amount.toLocaleString()]})]}),e.jsx("div",{className:"relative h-2 bg-muted rounded-full overflow-hidden",children:e.jsx(L.div,{className:"absolute inset-y-0 left-0 bg-primary rounded-full",initial:{width:0},animate:{width:`${o}%`},transition:{duration:.8,delay:.2+n*.1}})}),e.jsxs("p",{className:"text-[10px] sm:text-xs text-muted-foreground text-right",children:[o.toFixed(1),"% of expenses"]})]},i.category)})})]})})}function za(){const{t:s}=Ys(),t=Zs(),{toast:a}=Je(),[i,n]=g.useState(!1),[o,m]=g.useState("overview"),[u,x]=g.useState(!1);g.useEffect(()=>{new URLSearchParams(window.location.search).get("add")==="1"&&(n(!0),window.history.replaceState({},"","/money-tracking"))},[]);const[b,F]=g.useState("all"),[S,z]=g.useState("all"),[C,E]=g.useState("30"),{data:h,isLoading:l}=ge({queryKey:["/api/transactions",b,S,C],queryFn:()=>fetch("/api/transactions?limit=100").then(c=>c.json())}),{data:d}=ge({queryKey:["/api/dashboard/stats"]}),v=K({mutationFn:async()=>{const c=(h==null?void 0:h.filter(y=>y.category==="Other"||y.category==="other").map(y=>y.id))||[];if(c.length===0)throw new Error("No uncategorized transactions to fix");return await(await G("POST","/api/transactions/bulk-categorize",{transactionIds:c})).json()},onSuccess:c=>{t.invalidateQueries({queryKey:["/api/transactions"]}),a({title:"Categories Fixed",description:`Successfully categorized ${c.updated} of ${c.total} transactions using AI detection.`,variant:"default"})},onError:c=>{a({title:"Error",description:c.message||"Failed to categorize transactions",variant:"destructive"})}}),T=K({mutationFn:async c=>await(await G("PATCH",`/api/transactions/${c}/archive`)).json(),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/transactions"]}),a({title:"Transaction Archived",description:"Transaction has been archived successfully"})},onError:c=>{a({title:"Error",description:c.message||"Failed to archive transaction",variant:"destructive"})}}),f=K({mutationFn:async c=>await(await G("PATCH",`/api/transactions/${c}/flag`)).json(),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/transactions"]}),a({title:"Transaction Flagged",description:"Transaction has been flagged for review"})},onError:c=>{a({title:"Error",description:c.message||"Failed to flag transaction",variant:"destructive"})}}),N=g.useMemo(()=>h?h.filter(c=>{const w=b==="all"||c.type===b,y=S==="all"||c.category===S,A=new Date(c.date),U=new Date(Date.now()-parseInt(C)*24*60*60*1e3),_=A>=U;return w&&y&&_}):[],[h,b,S,C]),{totalIncome:p,totalExpenses:j,netCashFlow:k}=g.useMemo(()=>{const c=N.filter(y=>y.type==="income").reduce((y,A)=>y+parseFloat(A.amount),0),w=N.filter(y=>y.type==="expense").reduce((y,A)=>y+parseFloat(A.amount),0);return{totalIncome:c,totalExpenses:w,netCashFlow:c-w}},[N]);return l?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border/40 sticky top-0 z-30",children:e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 py-6",children:[e.jsx("div",{className:"h-8 bg-muted/50 rounded-lg w-48 mb-2 animate-pulse"}),e.jsx("div",{className:"h-4 bg-muted/50 rounded w-64 animate-pulse"})]})}),e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 py-8",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[...Array(4)].map((c,w)=>e.jsxs(M,{className:"p-6 border-border/50",children:[e.jsx("div",{className:"h-10 w-10 bg-muted/50 rounded-xl mb-4 animate-pulse"}),e.jsx("div",{className:"h-4 bg-muted/50 rounded w-1/2 mb-2 animate-pulse"}),e.jsx("div",{className:"h-8 bg-muted/50 rounded w-3/4 animate-pulse"})]},w))}),e.jsx(M,{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((c,w)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-10 bg-muted/50 rounded-full animate-pulse"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-muted/50 rounded w-1/3 mb-2 animate-pulse"}),e.jsx("div",{className:"h-3 bg-muted/50 rounded w-1/4 animate-pulse"})]}),e.jsx("div",{className:"h-6 bg-muted/50 rounded w-20 animate-pulse"})]},w))})})]})]}):e.jsxs("div",{className:"min-h-screen-mobile bg-background pb-24 md:pb-0",children:[e.jsx("header",{className:"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border/40 sticky top-0 z-30",children:e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4 lg:py-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs(L.div,{className:"flex-1 min-w-0",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4},children:[e.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl xl:text-3xl font-semibold tracking-tight text-foreground truncate",children:"Money Tracking"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5 sm:mt-1 hidden sm:block line-clamp-1",children:"Monitor your income, expenses, and cash flow"})]}),e.jsx(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.2},children:e.jsx(ia,{open:i,onOpenChange:n})})]})})}),e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:e.jsxs(rt,{value:o,onValueChange:m,className:"w-full",children:[e.jsx(L.div,{className:"overflow-x-auto -mx-4 px-4 md:mx-0 md:px-0 mb-4 sm:mb-6 scrollbar-none scroll-snap-x",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(it,{className:"inline-flex w-auto min-w-full md:grid md:w-full md:grid-cols-5 p-1 gap-1 bg-muted/50",children:[e.jsxs(Z,{value:"overview",className:"flex items-center justify-center gap-1.5 px-3 sm:px-4 py-2 text-xs whitespace-nowrap min-h-[44px] touch-target data-[state=active]:bg-background data-[state=active]:shadow-sm scroll-snap-item","data-testid":"tab-overview",children:[e.jsx(Q,{size:14,className:"flex-shrink-0"}),e.jsx("span",{children:"Overview"})]}),e.jsxs(Z,{value:"analytics",className:"flex items-center justify-center gap-1.5 px-3 sm:px-4 py-2 text-xs whitespace-nowrap min-h-[44px] touch-target data-[state=active]:bg-background data-[state=active]:shadow-sm scroll-snap-item","data-testid":"tab-analytics",children:[e.jsx(Ce,{size:14,className:"flex-shrink-0"}),e.jsx("span",{children:"Analytics"})]}),e.jsxs(Z,{value:"budget",className:"flex items-center justify-center gap-1.5 px-3 sm:px-4 py-2 text-xs whitespace-nowrap min-h-[44px] touch-target data-[state=active]:bg-background data-[state=active]:shadow-sm scroll-snap-item","data-testid":"tab-budget",children:[e.jsx(me,{size:14,className:"flex-shrink-0"}),e.jsx("span",{children:"Budget"})]}),e.jsxs(Z,{value:"insights",className:"flex items-center justify-center gap-1.5 px-3 sm:px-4 py-2 text-xs whitespace-nowrap min-h-[44px] touch-target data-[state=active]:bg-background data-[state=active]:shadow-sm scroll-snap-item","data-testid":"tab-insights",children:[e.jsx(be,{size:14,className:"flex-shrink-0"}),e.jsx("span",{children:"Insights"})]}),e.jsxs(Z,{value:"csv-analyzer",className:"flex items-center justify-center gap-1.5 px-3 sm:px-4 py-2 text-xs whitespace-nowrap min-h-[44px] touch-target data-[state=active]:bg-background data-[state=active]:shadow-sm scroll-snap-item","data-testid":"tab-csv-analyzer",children:[e.jsx(xt,{size:14,className:"flex-shrink-0"}),e.jsx("span",{children:"CSV"})]})]})}),e.jsxs(J,{value:"overview",className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx(ae,{title:"Total Income",value:p,icon:H,trend:"up",trendLabel:"This period",colorClass:"text-green-600 dark:text-green-400",bgClass:"bg-green-500/10",delay:0}),e.jsx(ae,{title:"Total Expenses",value:j,icon:de,trend:"down",trendLabel:"This period",colorClass:"text-red-600 dark:text-red-400",bgClass:"bg-red-500/10",delay:.1}),e.jsx(ae,{title:"Net Cash Flow",value:Math.abs(k),icon:k>=0?Se:ke,trend:k>=0?"up":"down",trendLabel:k>=0?"Positive":"Negative",colorClass:k>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",bgClass:k>=0?"bg-green-500/10":"bg-red-500/10",delay:.2}),e.jsx(ae,{title:"Total Savings",value:(d==null?void 0:d.totalSavings)||0,icon:ue,trend:"neutral",trendLabel:"All time",colorClass:"text-blue-600 dark:text-blue-400",bgClass:"bg-blue-500/10",delay:.3})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4 sm:space-y-6",children:[e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},children:e.jsxs(M,{className:"border-border/40",children:[e.jsxs("button",{className:"flex items-center justify-between w-full p-4 sm:p-6 md:cursor-default",onClick:()=>x(!u),"data-testid":"button-toggle-filters",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-muted",children:e.jsx(Re,{className:"w-4 h-4"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"text-sm sm:text-base font-semibold",children:"Filters"}),e.jsxs("span",{className:"text-xs sm:text-sm text-muted-foreground ml-2",children:["(",N.length," transactions)"]})]})]}),e.jsx(Js,{className:`w-4 h-4 md:hidden transition-transform ${u?"rotate-180":""}`})]}),e.jsx("div",{className:`${u?"block":"hidden"} md:block px-4 sm:px-6 pb-4 sm:pb-6`,children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium mb-1.5 block text-muted-foreground",children:"Time Range"}),e.jsxs(ne,{value:C,onValueChange:E,children:[e.jsx(re,{"data-testid":"select-time-range",className:"h-9 sm:h-10 text-xs sm:text-sm",children:e.jsx(ie,{})}),e.jsxs(le,{children:[e.jsx(B,{value:"7",children:"Last 7 days"}),e.jsx(B,{value:"30",children:"Last 30 days"}),e.jsx(B,{value:"90",children:"Last 3 months"}),e.jsx(B,{value:"365",children:"Last year"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium mb-1.5 block text-muted-foreground",children:"Type"}),e.jsxs(ne,{value:b,onValueChange:F,children:[e.jsx(re,{"data-testid":"select-transaction-type",className:"h-9 sm:h-10 text-xs sm:text-sm",children:e.jsx(ie,{})}),e.jsxs(le,{children:[e.jsx(B,{value:"all",children:"All Types"}),e.jsx(B,{value:"income",children:"Income"}),e.jsx(B,{value:"expense",children:"Expense"}),e.jsx(B,{value:"transfer",children:"Transfer"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium mb-1.5 block text-muted-foreground",children:"Category"}),e.jsxs(ne,{value:S,onValueChange:z,children:[e.jsx(re,{"data-testid":"select-filter-category",className:"h-9 sm:h-10 text-xs sm:text-sm",children:e.jsx(ie,{})}),e.jsxs(le,{children:[e.jsx(B,{value:"all",children:"All Categories"}),Object.entries(oa).map(([c,w])=>w.map(y=>e.jsx(B,{value:y,children:y.charAt(0).toUpperCase()+y.slice(1).replace("_"," ")},`${c}-${y}`)))]})]})]}),e.jsxs("div",{className:"flex items-end gap-2 col-span-2 md:col-span-1",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{F("all"),z("all"),E("30")},"data-testid":"button-clear-filters",className:"text-xs h-9 sm:h-10 flex-1",children:"Clear"}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{const c=new URLSearchParams;b!=="all"&&c.set("type",b),S!=="all"&&c.set("category",S);const w=parseInt(C),y=new Date,A=new Date;A.setDate(A.getDate()-w),c.set("startDate",A.toISOString().split("T")[0]),c.set("endDate",y.toISOString().split("T")[0]),window.location.href=`/api/transactions/export?${c.toString()}`},"data-testid":"button-export-csv",className:"text-xs h-9 sm:h-10 flex-1",children:[e.jsx(Xs,{size:14,className:"mr-1.5"}),"Export"]})]})]})})]})}),e.jsx(is,{mode:"wait",children:(h==null?void 0:h.filter(c=>c.category==="Other"||c.category==="other").length)>0&&e.jsx(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:e.jsx(M,{className:"p-4 bg-primary/5 border-primary/20",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(ye,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-semibold text-foreground flex items-center gap-2 text-sm sm:text-base",children:"AI Smart Categorization"}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:[h==null?void 0:h.filter(c=>c.category==="Other"||c.category==="other").length," uncategorized transactions detected"]})]})]}),e.jsx(I,{onClick:()=>v.mutate(),disabled:v.isPending,size:"sm",className:"font-medium flex-shrink-0","data-testid":"button-fix-categories",children:v.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-3.5 w-3.5 border-2 border-white border-t-transparent mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Categorizing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-3.5 h-3.5 mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Fix Categories"}),e.jsx("span",{className:"sm:hidden",children:"Fix"})]})})]})})})}),e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.3},children:e.jsxs(M,{className:"border-border/40",children:[e.jsx(V,{className:"pb-3 sm:pb-4 px-4 sm:px-6 pt-4 sm:pt-6",children:e.jsxs(R,{className:"text-sm sm:text-base font-semibold flex items-center gap-2",children:[e.jsx(ls,{className:"w-4 h-4 text-primary"}),"Recent Transactions"]})}),e.jsx(P,{className:"px-4 sm:px-6 pb-4 sm:pb-6",children:N.length===0?(h==null?void 0:h.length)===0?e.jsx(cs,{illustration:"transactions",title:"No Transactions Yet",description:"Start tracking your financial journey by adding your first transaction. Every dollar tracked brings you closer to your goals.",actionLabel:"Add Your First Transaction",onAction:()=>n(!0),actionTestId:"button-add-first-transaction"}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-muted rounded-2xl flex items-center justify-center mb-4",children:e.jsx(Re,{className:"w-8 h-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-base font-semibold mb-2",children:"No transactions match your filters"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-md mx-auto",children:"Try adjusting your date range or category filters to see more transactions"}),e.jsx(I,{variant:"outline",onClick:()=>{F("all"),z("all"),E("30")},children:"Clear Filters"})]}):e.jsx(la,{items:N,keyExtractor:c=>c.id,initialVisible:10,showMoreLabel:"View all transactions",showLessLabel:"Show fewer transactions",className:"space-y-2 sm:space-y-3",renderItem:c=>e.jsx(ea,{transaction:c,onArchive:w=>T.mutate(w),onFlag:w=>f.mutate(w)})})})]})})]}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(ua,{transactions:N}),e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.4},children:e.jsxs(M,{className:"border-border/40 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-sm sm:text-base font-semibold mb-4 flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-amber-500"}),"Quick Tips"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-muted/50",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Track expenses daily for accurate budgeting"})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-muted/50",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Review spending categories weekly"})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-muted/50",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Set budget limits for each category"})]})]})]})})]})]})]}),e.jsx(J,{value:"analytics",className:"space-y-6",children:e.jsx(Zt,{transactions:N||[],timeRange:C})}),e.jsx(J,{value:"budget",className:"space-y-6",children:e.jsx(Jt,{transactions:N||[],timeRange:C})}),e.jsx(J,{value:"insights",className:"space-y-6",children:e.jsx(Xt,{transactions:N||[],timeRange:C})}),e.jsx(J,{value:"csv-analyzer",className:"space-y-6",children:e.jsx(g.Suspense,{fallback:e.jsx(M,{className:"p-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-primary border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading CSV Analyzer..."})]})}),children:e.jsx(ca,{})})})]})})]})}export{za as default};
