import{y as f,j as e,aB as A,a7 as U,O as t,Q as n,S as d,ar as N,V as c,ab as i}from"./index-NNgTI0RQ.js";import{T as C,a as T,b as p,c as x,d as B,e as m}from"./table-DCuZy44m.js";import{B as l}from"./badge-D7Q8E7hz.js";import{S as b}from"./sparkles-yxnOzOhM.js";import{B as g}from"./building-2-BMcy1mLL.js";import{f as E}from"./format-BI6KV3YQ.js";import"./startOfWeek-D6dzzDOw.js";function H(){const{data:r,isLoading:o,error:j}=f({queryKey:["/api/admin/stats"]}),{data:h,isLoading:w,error:u}=f({queryKey:["/api/admin/users"]});if(j||u){const s=j||u,a=s instanceof Error?s.message:"Access denied";return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] p-8",children:[e.jsx(A,{className:"h-16 w-16 text-red-500 mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-red-500 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:a.includes("403")||a.includes("Admin")?"You don't have permission to view this page. Admin access is required.":a})]})}const y=s=>{switch(s){case"enterprise":return e.jsxs(l,{className:"bg-purple-600",children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),"Enterprise"]});case"pro":return e.jsxs(l,{className:"bg-blue-600",children:[e.jsx(b,{className:"h-3 w-3 mr-1"}),"Pro"]});default:return e.jsx(l,{variant:"secondary",children:"Free"})}},v=s=>{switch(s){case"active":return e.jsx(l,{className:"bg-green-600",children:"Active"});case"canceled":return e.jsx(l,{variant:"destructive",children:"Canceled"});case"past_due":return e.jsx(l,{className:"bg-orange-500",children:"Past Due"});default:return e.jsx(l,{variant:"outline",children:"No Sub"})}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{className:"h-8 w-8 text-yellow-500"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Admin Dashboard"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(t,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(N,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(c,{children:o?e.jsx(i,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold",children:(r==null?void 0:r.totalUsers)||0})})]}),e.jsxs(t,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Free Users"}),e.jsx(N,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(c,{children:o?e.jsx(i,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold",children:(r==null?void 0:r.freeUsers)||0})})]}),e.jsxs(t,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Pro Users"}),e.jsx(b,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(c,{children:o?e.jsx(i,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(r==null?void 0:r.proUsers)||0})})]}),e.jsxs(t,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Enterprise Users"}),e.jsx(g,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(c,{children:o?e.jsx(i,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:(r==null?void 0:r.enterpriseUsers)||0})})]})]}),e.jsxs(t,{children:[e.jsx(n,{children:e.jsx(d,{children:"All Users"})}),e.jsx(c,{children:w?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((s,a)=>e.jsx(i,{className:"h-12 w-full"},a))}):e.jsxs(C,{children:[e.jsx(T,{children:e.jsxs(p,{children:[e.jsx(x,{children:"Email"}),e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Plan"}),e.jsx(x,{children:"Status"}),e.jsx(x,{children:"Joined"})]})}),e.jsx(B,{children:h==null?void 0:h.users.map(s=>{var a;return e.jsxs(p,{"data-testid":`row-user-${s.user.id}`,children:[e.jsx(m,{className:"font-medium","data-testid":`text-email-${s.user.id}`,children:s.user.email||"No email"}),e.jsxs(m,{"data-testid":`text-name-${s.user.id}`,children:[s.user.firstName||""," ",s.user.lastName||""]}),e.jsx(m,{children:y(s.planName)}),e.jsx(m,{children:v((a=s.subscription)==null?void 0:a.status)}),e.jsx(m,{className:"text-muted-foreground",children:s.user.createdAt?E(new Date(s.user.createdAt),"MMM d, yyyy"):"Unknown"})]},s.user.id)})})]})})]})]})}export{H as default};
