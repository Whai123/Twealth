import{r as g,u as Qe,j as e,b as He,b8 as Ye,f as L,P as te,e as W,b9 as We,ba as Ne,aV as ze,aU as Ge,o as Xe,O as Y,Q as ue,S as we,V as Z,Y as Ze,X as Je,I as M,ar as ke,H as U,aB as Se,a7 as J,a4 as z,ag as et,_ as tt,B as pe,E as P,q as st,p as at,y as G,ab as H,bb as ie,bc as Ce,J as rt,U as it}from"./index-NNgTI0RQ.js";import{B as D}from"./badge-D7Q8E7hz.js";import{P as nt}from"./progress-COOXQNiG.js";import{C as lt}from"./calculator-DIBepEto.js";import{C as ot}from"./clock-QmJAeAa1.js";import{S as q}from"./sparkles-yxnOzOhM.js";import{T as ee}from"./trending-up-BnP5NHLE.js";import{S as ct,a as dt,b as mt,c as xt}from"./index-DdC2qtWE.js";import{E as ut,l as pt,u as Pe,a as ht,C as be,b as gt,c as ft,P as yt}from"./react-stripe.esm-BHTGQQV3.js";import{A as ne}from"./index-BV8oB33o.js";import{m as j}from"./proxy-C8xz_zGI.js";import{C as le}from"./credit-card-BRwojsv2.js";import{S as he}from"./shield-DTrErQQt.js";import{L as oe}from"./lock-C-52eLxF.js";import{C as bt}from"./calendar-CwD0FHKB.js";import{A as ge}from"./arrow-right-l9D0Ocf3.js";import{A as Ae}from"./arrow-left-CwkJQlvl.js";import{Z as T}from"./zap-jVm97dbR.js";import{S as jt}from"./star-DAdPyuou.js";import"./index-hdTjj1pu.js";var Ee=["PageUp","PageDown"],Fe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],_e={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},$="Slider",[ce,vt,Nt]=Ye($),[Ie]=He($,[Nt]),[wt,se]=Ie($),Re=g.forwardRef((t,a)=>{const{name:s,min:r=0,max:l=100,step:x=1,orientation:i="horizontal",disabled:c=!1,minStepsBetweenThumbs:o=0,defaultValue:n=[r],value:y,onValueChange:m=()=>{},onValueCommit:h=()=>{},inverted:u=!1,form:f,...b}=t,d=g.useRef(new Set),p=g.useRef(0),N=i==="horizontal"?kt:St,[w=[],I]=Qe({prop:y,defaultProp:n,onChange:v=>{var E;(E=[...d.current][p.current])==null||E.focus(),m(v)}}),O=g.useRef(w);function K(v){const k=Ft(w,v);R(v,k)}function ae(v){R(v,p.current)}function V(){const v=O.current[p.current];w[p.current]!==v&&h(w)}function R(v,k,{commit:E}={commit:!1}){const B=Dt(x),F=Ut(Math.round((v-r)/x)*x+r,B),_=Ne(F,[r,l]);I((A=[])=>{const S=At(A,_,k);if(Rt(S,o*x)){p.current=S.indexOf(_);const Q=String(S)!==String(A);return Q&&E&&h(S),Q?S:A}else return A})}return e.jsx(wt,{scope:t.__scopeSlider,name:s,disabled:c,min:r,max:l,valueIndexToChangeRef:p,thumbs:d.current,values:w,orientation:i,form:f,children:e.jsx(ce.Provider,{scope:t.__scopeSlider,children:e.jsx(ce.Slot,{scope:t.__scopeSlider,children:e.jsx(N,{"aria-disabled":c,"data-disabled":c?"":void 0,...b,ref:a,onPointerDown:L(b.onPointerDown,()=>{c||(O.current=w)}),min:r,max:l,inverted:u,onSlideStart:c?void 0:K,onSlideMove:c?void 0:ae,onSlideEnd:c?void 0:V,onHomeKeyDown:()=>!c&&R(r,0,{commit:!0}),onEndKeyDown:()=>!c&&R(l,w.length-1,{commit:!0}),onStepKeyDown:({event:v,direction:k})=>{if(!c){const F=Ee.includes(v.key)||v.shiftKey&&Fe.includes(v.key)?10:1,_=p.current,A=w[_],S=x*F*k;R(A+S,_,{commit:!0})}}})})})})});Re.displayName=$;var[De,Ue]=Ie($,{startEdge:"left",endEdge:"right",size:"width",direction:1}),kt=g.forwardRef((t,a)=>{const{min:s,max:r,dir:l,inverted:x,onSlideStart:i,onSlideMove:c,onSlideEnd:o,onStepKeyDown:n,...y}=t,[m,h]=g.useState(null),u=W(a,N=>h(N)),f=g.useRef(void 0),b=We(l),d=b==="ltr",p=d&&!x||!d&&x;function C(N){const w=f.current||m.getBoundingClientRect(),I=[0,w.width],K=fe(I,p?[s,r]:[r,s]);return f.current=w,K(N-w.left)}return e.jsx(De,{scope:t.__scopeSlider,startEdge:p?"left":"right",endEdge:p?"right":"left",direction:p?1:-1,size:"width",children:e.jsx(Le,{dir:b,"data-orientation":"horizontal",...y,ref:u,style:{...y.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:N=>{const w=C(N.clientX);i==null||i(w)},onSlideMove:N=>{const w=C(N.clientX);c==null||c(w)},onSlideEnd:()=>{f.current=void 0,o==null||o()},onStepKeyDown:N=>{const I=_e[p?"from-left":"from-right"].includes(N.key);n==null||n({event:N,direction:I?-1:1})}})})}),St=g.forwardRef((t,a)=>{const{min:s,max:r,inverted:l,onSlideStart:x,onSlideMove:i,onSlideEnd:c,onStepKeyDown:o,...n}=t,y=g.useRef(null),m=W(a,y),h=g.useRef(void 0),u=!l;function f(b){const d=h.current||y.current.getBoundingClientRect(),p=[0,d.height],N=fe(p,u?[r,s]:[s,r]);return h.current=d,N(b-d.top)}return e.jsx(De,{scope:t.__scopeSlider,startEdge:u?"bottom":"top",endEdge:u?"top":"bottom",size:"height",direction:u?1:-1,children:e.jsx(Le,{"data-orientation":"vertical",...n,ref:m,style:{...n.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const d=f(b.clientY);x==null||x(d)},onSlideMove:b=>{const d=f(b.clientY);i==null||i(d)},onSlideEnd:()=>{h.current=void 0,c==null||c()},onStepKeyDown:b=>{const p=_e[u?"from-bottom":"from-top"].includes(b.key);o==null||o({event:b,direction:p?-1:1})}})})}),Le=g.forwardRef((t,a)=>{const{__scopeSlider:s,onSlideStart:r,onSlideMove:l,onSlideEnd:x,onHomeKeyDown:i,onEndKeyDown:c,onStepKeyDown:o,...n}=t,y=se($,s);return e.jsx(te.span,{...n,ref:a,onKeyDown:L(t.onKeyDown,m=>{m.key==="Home"?(i(m),m.preventDefault()):m.key==="End"?(c(m),m.preventDefault()):Ee.concat(Fe).includes(m.key)&&(o(m),m.preventDefault())}),onPointerDown:L(t.onPointerDown,m=>{const h=m.target;h.setPointerCapture(m.pointerId),m.preventDefault(),y.thumbs.has(h)?h.focus():r(m)}),onPointerMove:L(t.onPointerMove,m=>{m.target.hasPointerCapture(m.pointerId)&&l(m)}),onPointerUp:L(t.onPointerUp,m=>{const h=m.target;h.hasPointerCapture(m.pointerId)&&(h.releasePointerCapture(m.pointerId),x(m))})})}),Te="SliderTrack",Me=g.forwardRef((t,a)=>{const{__scopeSlider:s,...r}=t,l=se(Te,s);return e.jsx(te.span,{"data-disabled":l.disabled?"":void 0,"data-orientation":l.orientation,...r,ref:a})});Me.displayName=Te;var de="SliderRange",qe=g.forwardRef((t,a)=>{const{__scopeSlider:s,...r}=t,l=se(de,s),x=Ue(de,s),i=g.useRef(null),c=W(a,i),o=l.values.length,n=l.values.map(h=>Oe(h,l.min,l.max)),y=o>1?Math.min(...n):0,m=100-Math.max(...n);return e.jsx(te.span,{"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,...r,ref:c,style:{...t.style,[x.startEdge]:y+"%",[x.endEdge]:m+"%"}})});qe.displayName=de;var me="SliderThumb",$e=g.forwardRef((t,a)=>{const s=vt(t.__scopeSlider),[r,l]=g.useState(null),x=W(a,c=>l(c)),i=g.useMemo(()=>r?s().findIndex(c=>c.ref.current===r):-1,[s,r]);return e.jsx(Ct,{...t,ref:x,index:i})}),Ct=g.forwardRef((t,a)=>{const{__scopeSlider:s,index:r,name:l,...x}=t,i=se(me,s),c=Ue(me,s),[o,n]=g.useState(null),y=W(a,C=>n(C)),m=o?i.form||!!o.closest("form"):!0,h=ze(o),u=i.values[r],f=u===void 0?0:Oe(u,i.min,i.max),b=Et(r,i.values.length),d=h==null?void 0:h[c.size],p=d?_t(d,f,c.direction):0;return g.useEffect(()=>{if(o)return i.thumbs.add(o),()=>{i.thumbs.delete(o)}},[o,i.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${f}% + ${p}px)`},children:[e.jsx(ce.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(te.span,{role:"slider","aria-label":t["aria-label"]||b,"aria-valuemin":i.min,"aria-valuenow":u,"aria-valuemax":i.max,"aria-orientation":i.orientation,"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,tabIndex:i.disabled?void 0:0,...x,ref:y,style:u===void 0?{display:"none"}:t.style,onFocus:L(t.onFocus,()=>{i.valueIndexToChangeRef.current=r})})}),m&&e.jsx(Pt,{name:l??(i.name?i.name+(i.values.length>1?"[]":""):void 0),form:i.form,value:u},r)]})});$e.displayName=me;var Pt=t=>{const{value:a,...s}=t,r=g.useRef(null),l=Ge(a);return g.useEffect(()=>{const x=r.current,i=window.HTMLInputElement.prototype,o=Object.getOwnPropertyDescriptor(i,"value").set;if(l!==a&&o){const n=new Event("input",{bubbles:!0});o.call(x,a),x.dispatchEvent(n)}},[l,a]),e.jsx("input",{style:{display:"none"},...s,ref:r,defaultValue:a})};function At(t=[],a,s){const r=[...t];return r[s]=a,r.sort((l,x)=>l-x)}function Oe(t,a,s){const x=100/(s-a)*(t-a);return Ne(x,[0,100])}function Et(t,a){return a>2?`Value ${t+1} of ${a}`:a===2?["Minimum","Maximum"][t]:void 0}function Ft(t,a){if(t.length===1)return 0;const s=t.map(l=>Math.abs(l-a)),r=Math.min(...s);return s.indexOf(r)}function _t(t,a,s){const r=t/2,x=fe([0,50],[0,r]);return(r-x(a)*s)*s}function It(t){return t.slice(0,-1).map((a,s)=>t[s+1]-a)}function Rt(t,a){if(a>0){const s=It(t);return Math.min(...s)>=a}return!0}function fe(t,a){return s=>{if(t[0]===t[1]||a[0]===a[1])return a[0];const r=(a[1]-a[0])/(t[1]-t[0]);return a[0]+r*(s-t[0])}}function Dt(t){return(String(t).split(".")[1]||"").length}function Ut(t,a){const s=Math.pow(10,a);return Math.round(t*s)/s}var Ke=Re,Lt=Me,Tt=qe,je=$e;const xe=g.forwardRef(({className:t,...a},s)=>e.jsxs(Ke,{ref:s,className:Xe("relative flex w-full touch-none select-none items-center",t),...a,children:[e.jsx(Lt,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(Tt,{className:"absolute h-full bg-primary"})}),e.jsx(je,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"}),e.jsx(je,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));xe.displayName=Ke.displayName;const Mt={free:{monthlyPrice:0,scoutQueries:50,advancedQueries:0,hoursPerQuery:.25},pro:{monthlyPrice:9.99,scoutQueries:500,advancedQueries:100,hoursPerQuery:.5},enterprise:{monthlyPrice:49.99,scoutQueries:999999,advancedQueries:500,hoursPerQuery:1}};function qt({userCurrency:t,currentTier:a}){const[s,r]=g.useState(50),[l,x]=g.useState(50),i=g.useMemo(()=>{const o=Mt[a],n=s*.5,y=s*.05,m=n-y,h=m*l,u=h-o.monthlyPrice,f=o.monthlyPrice>0?(h/o.monthlyPrice*100).toFixed(0):"Infinite";return{hoursWithoutAI:n,hoursWithAI:y,hoursSaved:m,moneySaved:h,netSavings:u,roi:f,monthlyPrice:o.monthlyPrice}},[s,l,a]),c=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:t||"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(o);return e.jsxs(Y,{className:"border-border/40 bg-gradient-to-br from-background to-muted/20",children:[e.jsx(ue,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(lt,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx(we,{className:"text-lg font-semibold",children:"AI Value Calculator"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:"See how much time and money you save"})]})]}),e.jsxs(D,{variant:"secondary",className:"text-xs",children:[a.charAt(0).toUpperCase()+a.slice(1)," Plan"]})]})}),e.jsxs(Z,{className:"space-y-8",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"Financial questions per month"}),e.jsx("span",{className:"text-sm font-bold text-primary",children:s})]}),e.jsx(xe,{value:[s],onValueChange:o=>r(o[0]),min:10,max:200,step:10,className:"w-full","data-testid":"slider-queries"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Budget reviews, spending analysis, investment questions, tax planning..."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"Your hourly value"}),e.jsxs("span",{className:"text-sm font-bold text-primary",children:[c(l),"/hr"]})]}),e.jsx(xe,{value:[l],onValueChange:o=>x(o[0]),min:15,max:200,step:5,className:"w-full","data-testid":"slider-hourly-rate"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"What's your time worth? Consider salary or consulting rate."})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-white dark:bg-gray-900 border border-border/30 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ot,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Time Without AI"})]}),e.jsxs("div",{className:"text-2xl font-bold text-foreground",children:[i.hoursWithoutAI.toFixed(1),"h"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Research, calculations, analysis"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-white dark:bg-gray-900 border border-border/30 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Time With AI"})]}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[i.hoursWithAI.toFixed(1),"h"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Quick answers, instant insights"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-green-50 dark:bg-green-900/20 border border-green-200/30 dark:border-green-800/30 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Hours Saved"})]}),e.jsxs("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[i.hoursSaved.toFixed(1),"h"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Per month productivity gain"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-primary/5 border border-primary/20 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary",children:[e.jsx(Ze,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Value Created"})]}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:c(i.moneySaved)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Time savings converted to money"})]})]}),e.jsx("div",{className:"p-6 rounded-xl bg-gradient-to-r from-primary/10 via-primary/5 to-transparent border border-primary/20",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground",children:"Your Monthly ROI"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:i.monthlyPrice>0?`After ${c(i.monthlyPrice)}/month subscription`:"Free plan - no subscription cost"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:i.monthlyPrice>0?`${i.roi}%`:c(i.moneySaved)}),i.monthlyPrice>0&&e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 font-medium",children:["Net savings: ",c(i.netSavings),"/mo"]})]})]})})]})]})}const ve=pt("pk_live_51RgqaaGwNQ3ybqXe7zIfJAb9ZLficTZSYtkJWhNV8wdD5DeZ4kgtM8tQG389FbLTSh9TZBtjou775mrxgpBCu7HV00yvoDNqW2"),$t={style:{base:{fontSize:"16px",color:"#1f2937",fontFamily:'"Inter", system-ui, -apple-system, sans-serif',fontSmoothing:"antialiased","::placeholder":{color:"#9ca3af"}},invalid:{color:"#ef4444",iconColor:"#ef4444"}}},Ot={style:{base:{fontSize:"16px",color:"#f9fafb",fontFamily:'"Inter", system-ui, -apple-system, sans-serif',fontSmoothing:"antialiased","::placeholder":{color:"#6b7280"}},invalid:{color:"#ef4444",iconColor:"#ef4444"}}};function Ve({currentStep:t,totalSteps:a}){return e.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:Array.from({length:a},(s,r)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(j.div,{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium transition-all ${r+1<=t?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,initial:!1,animate:{scale:r+1===t?1.1:1},children:r+1<t?e.jsx(M,{className:"w-4 h-4"}):r+1}),r<a-1&&e.jsx("div",{className:`w-8 h-0.5 mx-1 transition-colors ${r+1<t?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`})]},r))})}function Kt({plan:t,localizedPrice:a,onSuccess:s,onError:r,isEnterprise:l,isPro:x}){const i=Pe(),[c,o]=g.useState(null),[n,y]=g.useState(!1);return g.useEffect(()=>{if(!i)return;const m=i.paymentRequest({country:"US",currency:a.currency.code.toLowerCase(),total:{label:`Twealth ${t.displayName}`,amount:Math.round(a.amount*100)},requestPayerName:!0,requestPayerEmail:!0});m.canMakePayment().then(h=>{h&&(o(m),y(!0))}),m.on("paymentmethod",async h=>{try{const f=await(await pe("POST","/api/subscription/create-payment-intent",{planId:t.id})).json();if(!f.clientSecret){h.complete("fail"),r("Unable to process payment");return}const{error:b,paymentIntent:d}=await i.confirmCardPayment(f.clientSecret,{payment_method:h.paymentMethod.id},{handleActions:!1});if(b)h.complete("fail"),r(b.message||"Payment failed");else if((d==null?void 0:d.status)==="succeeded")h.complete("success"),P.invalidateQueries({queryKey:["/api/subscription/current"]}),P.invalidateQueries({queryKey:["/api/subscription/usage"]}),s();else if((d==null?void 0:d.status)==="requires_action"){h.complete("success");const{error:p}=await i.confirmCardPayment(f.clientSecret);p?r(p.message||"Authentication failed"):(P.invalidateQueries({queryKey:["/api/subscription/current"]}),P.invalidateQueries({queryKey:["/api/subscription/usage"]}),s())}else h.complete("fail"),r("Payment could not be completed")}catch(u){h.complete("fail"),r(u.message||"Payment failed")}})},[i,t,a]),!n||!c?null:e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-200 dark:bg-gray-700"}),e.jsx("span",{children:"Express Checkout"}),e.jsx("div",{className:"flex-1 h-px bg-gray-200 dark:bg-gray-700"})]}),e.jsx("div",{className:"rounded-xl overflow-hidden border border-gray-200/50 dark:border-gray-700/50",children:e.jsx(yt,{options:{paymentRequest:c,style:{paymentRequestButton:{type:"default",theme:"dark",height:"48px"}}}})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-200 dark:bg-gray-700"}),e.jsx("span",{children:"Or pay with card"}),e.jsx("div",{className:"flex-1 h-px bg-gray-200 dark:bg-gray-700"})]})]})}function Vt({plan:t,localizedPrice:a,userCurrency:s,onSuccess:r,onBack:l,isEnterprise:x,isPro:i,onAuthError:c}){const o=Pe(),n=ht(),[y,m]=g.useState(!1),[h,u]=g.useState(null),[f,b]=g.useState({cardNumber:!1,cardExpiry:!1,cardCvc:!1}),[d,p]=g.useState(null),[C,N]=g.useState(!1),[w,I]=g.useState(!0);g.useEffect(()=>{N(document.documentElement.classList.contains("dark"));const v=new MutationObserver(()=>{N(document.documentElement.classList.contains("dark"))});return v.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>v.disconnect()},[]);const O=f.cardNumber&&f.cardExpiry&&f.cardCvc,K=async v=>{var E,B;if(v.preventDefault(),u(null),!o||!n){u("Payment system not initialized. Please try again.");return}const k=n.getElement(be);if(!k){u("Card input not found");return}m(!0);try{const _=await(await pe("POST","/api/subscription/create-payment-intent",{planId:t.id})).json();if(_.requiresSetup){u("Payment processing is being configured. Please try again later."),m(!1);return}const{clientSecret:A}=_;if(!A){u("Unable to initialize payment. Please try again."),m(!1);return}const S=await o.confirmCardPayment(A,{payment_method:{card:k},setup_future_usage:w?"off_session":void 0});if(S.error){S.error.type==="card_error"||S.error.type==="validation_error"?u(S.error.message||"Your card was declined. Please try a different card."):S.error.code==="payment_intent_authentication_failure"?u("Authentication failed. Please try again or use a different card."):u(S.error.message||"Payment failed. Please try again."),m(!1);return}const{paymentIntent:Q}=S;if(Q)switch(Q.status){case"succeeded":P.invalidateQueries({queryKey:["/api/subscription/current"]}),P.invalidateQueries({queryKey:["/api/subscription/usage"]}),r();break;case"requires_action":case"requires_confirmation":const{error:ye,paymentIntent:re}=await o.confirmCardPayment(A);ye?u(ye.message||"Authentication failed. Please try again."):(re==null?void 0:re.status)==="succeeded"?(P.invalidateQueries({queryKey:["/api/subscription/current"]}),P.invalidateQueries({queryKey:["/api/subscription/usage"]}),r()):u("Payment could not be completed. Please try again.");break;case"requires_payment_method":u("Your card was declined. Please check your card details or try a different card."),b({cardNumber:!1,cardExpiry:!1,cardCvc:!1});break;case"processing":P.invalidateQueries({queryKey:["/api/subscription/current"]}),r();break;case"canceled":u("Payment was canceled. Please try again.");break;default:u("Unexpected payment status. Please contact support if the issue persists.")}}catch(F){if((E=F.message)!=null&&E.includes("sign in")||(B=F.message)!=null&&B.includes("401")){c();return}u(F.message||"An unexpected error occurred. Please try again.")}finally{m(!1)}},ae=()=>x?"from-amber-500 to-yellow-600":i?"from-blue-600 to-indigo-600":"from-gray-700 to-gray-900",V=C?Ot:$t,R=(a.amount/30).toFixed(2);return e.jsxs("form",{onSubmit:K,className:"space-y-5",children:[e.jsx(Ve,{currentStep:2,totalSteps:2}),e.jsx(Kt,{plan:t,localizedPrice:a,onSuccess:r,onError:u,isEnterprise:x,isPro:i}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Card Number"]}),e.jsxs("div",{className:`relative rounded-xl border transition-all duration-200 ${d==="number"?"border-blue-500 ring-2 ring-blue-500/20":"border-gray-200/50 dark:border-gray-700/50"} bg-white/60 dark:bg-gray-800/60 backdrop-blur-sm`,children:[e.jsx("div",{className:"px-4 py-3.5",children:e.jsx(be,{options:V,onFocus:()=>p("number"),onBlur:()=>p(null),onChange:v=>b(k=>({...k,cardNumber:v.complete}))})}),f.cardNumber&&e.jsx(j.div,{initial:{scale:0},animate:{scale:1},className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(z,{className:"w-5 h-5 text-green-500"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Expiry Date"}),e.jsxs("div",{className:`relative rounded-xl border transition-all duration-200 ${d==="expiry"?"border-blue-500 ring-2 ring-blue-500/20":"border-gray-200/50 dark:border-gray-700/50"} bg-white/60 dark:bg-gray-800/60 backdrop-blur-sm`,children:[e.jsx("div",{className:"px-4 py-3.5",children:e.jsx(gt,{options:V,onFocus:()=>p("expiry"),onBlur:()=>p(null),onChange:v=>b(k=>({...k,cardExpiry:v.complete}))})}),f.cardExpiry&&e.jsx(j.div,{initial:{scale:0},animate:{scale:1},className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(z,{className:"w-5 h-5 text-green-500"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"CVC"}),e.jsxs("div",{className:`relative rounded-xl border transition-all duration-200 ${d==="cvc"?"border-blue-500 ring-2 ring-blue-500/20":"border-gray-200/50 dark:border-gray-700/50"} bg-white/60 dark:bg-gray-800/60 backdrop-blur-sm`,children:[e.jsx("div",{className:"px-4 py-3.5",children:e.jsx(ft,{options:V,onFocus:()=>p("cvc"),onBlur:()=>p(null),onChange:v=>b(k=>({...k,cardCvc:v.complete}))})}),f.cardCvc&&e.jsx(j.div,{initial:{scale:0},animate:{scale:1},className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(z,{className:"w-5 h-5 text-green-500"})})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-gray-50/50 dark:bg-gray-800/30 border border-gray-200/50 dark:border-gray-700/30",children:[e.jsx(et,{id:"save-card",checked:w,onCheckedChange:v=>I(v),"data-testid":"checkbox-save-card"}),e.jsx("label",{htmlFor:"save-card",className:"text-sm text-gray-600 dark:text-gray-400 cursor-pointer",children:"Save card for future payments"})]}),e.jsx(ne,{children:h&&e.jsxs(j.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex items-center gap-2 p-3 rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800/30 text-red-600 dark:text-red-400 text-sm","data-testid":"alert-payment-error",children:[e.jsx(Se,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:h})]})}),e.jsxs("div",{className:"pt-2 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(ke,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Join 12,000+ users managing their wealth"})]}),e.jsx(U,{type:"submit",disabled:!o||!O||y,className:`w-full h-12 rounded-xl font-medium transition-all duration-300 bg-gradient-to-r ${ae()} text-white shadow-lg ${x?"shadow-amber-500/25 hover:shadow-amber-500/40":i?"shadow-blue-500/25 hover:shadow-blue-500/40":"shadow-gray-500/25"} disabled:opacity-50 disabled:cursor-not-allowed`,"data-testid":"button-pay-now",children:y?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Processing Payment..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsxs("span",{children:["Pay ",a.currency.symbol,a.amount.toFixed(2)]})]})}),e.jsxs("div",{className:"text-center text-xs text-gray-500 dark:text-gray-400",children:["Only ",a.currency.symbol,R,"/day"]}),e.jsxs(U,{type:"button",variant:"ghost",onClick:l,disabled:y,className:"w-full h-10 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-100/50 dark:hover:bg-gray-800/50","data-testid":"button-back-to-plan",children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Back to plan details"]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 text-xs text-gray-400 dark:text-gray-500 pt-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(he,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"256-bit SSL"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(oe,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"PCI Compliant"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(z,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"30-day guarantee"})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-3 pt-1",children:[e.jsx(ct,{className:"w-8 h-5 text-gray-400"}),e.jsx(dt,{className:"w-8 h-5 text-gray-400"}),e.jsx(mt,{className:"w-8 h-5 text-gray-400"}),e.jsx(xt,{className:"w-8 h-5 text-gray-400"})]})]})}function Bt({plan:t,onClose:a}){return e.jsxs(j.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-8 space-y-6",children:[e.jsx(j.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:15,stiffness:200,delay:.2},className:"w-20 h-20 mx-auto rounded-full bg-gradient-to-br from-green-400 to-emerald-500 flex items-center justify-center shadow-lg shadow-green-500/30",children:e.jsx(M,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-2xl font-bold text-gray-900 dark:text-white",children:["Welcome to ",t.displayName,"!"]}),e.jsx(j.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"text-gray-600 dark:text-gray-400",children:"Your subscription is now active. Enjoy your premium features!"})]}),e.jsx(j.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsxs(U,{onClick:a,className:"px-8 h-12 rounded-xl bg-gradient-to-r from-green-500 to-emerald-600 text-white font-medium shadow-lg shadow-green-500/25","data-testid":"button-close-success",children:["Start Exploring",e.jsx(ge,{className:"w-4 h-4 ml-2"})]})})]})}function Qt({isOpen:t,onClose:a,plan:s,localizedPrice:r,userCurrency:l,onSuccess:x}){const[i,c]=g.useState("confirm");if(g.useEffect(()=>{t||c("confirm")},[t]),!s)return null;const o=s.name==="pro",n=s.name==="enterprise",y=(r.amount/30).toFixed(2),m=()=>n?"from-amber-500/20 via-yellow-500/10 to-orange-500/20":o?"from-blue-500/20 via-indigo-500/10 to-purple-500/20":"from-gray-500/20 via-slate-500/10 to-gray-500/20",h=()=>n?"text-amber-400":o?"text-blue-400":"text-gray-400",u=()=>n?"shadow-[0_0_60px_-15px_rgba(251,191,36,0.3)]":o?"shadow-[0_0_60px_-15px_rgba(59,130,246,0.3)]":"shadow-[0_0_60px_-15px_rgba(100,100,100,0.3)]",f=()=>n?e.jsx(J,{className:"w-6 h-6 text-amber-400"}):o?e.jsx(q,{className:"w-6 h-6 text-blue-400"}):e.jsx(T,{className:"w-6 h-6 text-gray-400"}),b=()=>{const N=[];return s.scoutLimit===999999?N.push("Unlimited Scout AI queries"):N.push(`${s.scoutLimit} Scout AI queries/month`),s.sonnetLimit>0&&N.push(`${s.sonnetLimit} Sonnet reasoning queries`),s.gpt5Limit>0&&N.push(`${s.gpt5Limit} GPT-5 math queries`),s.opusLimit>0&&N.push(`${s.opusLimit===999999?"Unlimited":s.opusLimit} Opus CFO queries`),N.slice(0,4)},d=()=>{c("payment")},p=()=>{c("success"),x()},C=()=>{c("confirm"),a()};return e.jsx(ne,{children:t&&e.jsxs(e.Fragment,{children:[e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",onClick:i!=="payment"?C:void 0,"data-testid":"modal-backdrop"}),e.jsx(j.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:10},transition:{type:"spring",damping:25,stiffness:300,duration:.4},className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none overflow-y-auto",children:e.jsxs("div",{className:`relative w-full max-w-md pointer-events-auto my-4 ${u()}`,"data-testid":"modal-checkout",children:[e.jsx("div",{className:`absolute inset-0 rounded-3xl bg-gradient-to-br ${m()} blur-xl opacity-50`}),e.jsxs("div",{className:"relative rounded-3xl border border-white/20 dark:border-white/10 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl overflow-hidden max-h-[90vh] overflow-y-auto",children:[e.jsx("button",{onClick:C,className:"absolute top-4 right-4 p-2 rounded-full bg-white/20 dark:bg-gray-800/50 backdrop-blur-sm hover:bg-white/30 dark:hover:bg-gray-700/50 transition-colors z-10","data-testid":"button-close-modal",children:e.jsx(Je,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})}),e.jsxs(ne,{mode:"wait",children:[i==="confirm"&&e.jsxs(j.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{className:"relative p-6 pb-4",children:[e.jsx(Ve,{currentStep:1,totalSteps:2}),e.jsx("div",{className:`absolute top-0 left-0 right-0 h-32 bg-gradient-to-br ${m()} opacity-60`}),e.jsx("div",{className:"relative",children:e.jsxs(j.div,{className:"w-full aspect-[1.586/1] rounded-2xl relative overflow-hidden mb-6",initial:{rotateY:-10,rotateX:5},animate:{rotateY:0,rotateX:0},transition:{duration:.6,delay:.1},style:{perspective:1e3,transformStyle:"preserve-3d"},children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${n?"from-amber-600 via-yellow-500 to-orange-600":o?"from-blue-600 via-indigo-600 to-purple-600":"from-gray-700 via-gray-600 to-gray-800"} rounded-2xl`}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-white/0 via-white/10 to-white/20 rounded-2xl"}),e.jsxs("div",{className:"absolute inset-0 opacity-20",children:[e.jsx("div",{className:"absolute top-4 left-4 w-12 h-12 rounded-full bg-white/30 blur-lg"}),e.jsx("div",{className:"absolute bottom-8 right-8 w-20 h-20 rounded-full bg-white/20 blur-xl"})]}),e.jsxs("div",{className:"absolute inset-0 p-5 flex flex-col justify-between text-white",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f(),e.jsx("span",{className:"font-semibold text-lg tracking-wide",children:s.displayName})]}),e.jsx("div",{className:"flex flex-col items-end",children:e.jsx(le,{className:"w-8 h-8 opacity-80"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-end gap-2 mb-1",children:[e.jsxs("span",{className:"text-4xl font-bold tracking-tight",children:[r.currency.symbol,r.amount.toFixed(2)]}),e.jsxs("span",{className:"text-white/70 text-sm mb-1.5",children:["/",s.billingInterval]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l!=="USD"&&e.jsxs("p",{className:"text-white/60 text-xs",children:["â‰ˆ $",parseFloat(s.priceUsd).toFixed(2)," USD"]}),e.jsxs("p",{className:"text-white/60 text-xs",children:["(",r.currency.symbol,y,"/day)"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-white/60 tracking-widest",children:["TWEALTH ",s.name.toUpperCase()]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-white/30"}),e.jsx("div",{className:"w-6 h-6 rounded-full bg-white/20 -ml-3"})]})]})]})]})})]}),e.jsxs("div",{className:"px-6 pb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"What you'll get"}),e.jsx("div",{className:"space-y-2.5",children:b().map((N,w)=>e.jsxs(j.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.2+w*.1},className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${n?"bg-amber-100 dark:bg-amber-900/30":o?"bg-blue-100 dark:bg-blue-900/30":"bg-gray-100 dark:bg-gray-800"}`,children:e.jsx(M,{className:`w-3 h-3 ${h()}`})}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:N})]},w))})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50/50 dark:bg-gray-800/30 border-t border-gray-200/50 dark:border-gray-700/30",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(ke,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Join 12,000+ users managing their wealth"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4 text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(he,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Secure checkout"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(oe,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"256-bit encryption"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(bt,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"30-day guarantee"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(U,{variant:"outline",onClick:C,className:"flex-1 h-12 rounded-xl border-gray-200 dark:border-gray-700 bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm hover:bg-gray-100/80 dark:hover:bg-gray-700/50","data-testid":"button-cancel-checkout",children:"Cancel"}),e.jsx(U,{onClick:d,className:`flex-1 h-12 rounded-xl font-medium transition-all duration-300 ${n?"bg-gradient-to-r from-amber-500 to-yellow-600 hover:from-amber-600 hover:to-yellow-700 text-white shadow-lg shadow-amber-500/25":o?"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-lg shadow-blue-500/25":"bg-gray-900 dark:bg-white text-white dark:text-gray-900 hover:bg-gray-800 dark:hover:bg-gray-100"}`,"data-testid":"button-continue-to-payment",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{children:"Continue"}),e.jsx(ge,{className:"w-4 h-4"})]})})]})]})]},"confirm"),i==="payment"&&e.jsxs(j.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},className:"p-6",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f(),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s.displayName}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r.currency.symbol,r.amount.toFixed(2),"/",s.billingInterval]})]})]})}),ve?e.jsx(ut,{stripe:ve,children:e.jsx(Vt,{plan:s,localizedPrice:r,userCurrency:l,onSuccess:p,onBack:()=>c("confirm"),isEnterprise:n,isPro:o,onAuthError:()=>{C(),window.location.href="/auth"}})}):e.jsxs("div",{className:"text-center py-8 space-y-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center",children:e.jsx(Se,{className:"w-8 h-8 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"Payment Not Available"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Payment processing is being configured. Please try again later or contact support."})]}),e.jsxs(U,{onClick:()=>c("confirm"),variant:"outline",className:"mt-4",children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})]},"payment"),i==="success"&&e.jsx(j.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3},className:"p-6",children:e.jsx(Bt,{plan:s,onClose:C})},"success")]})]})]})})]})})}function Be({value:t,delay:a=0}){const[s,r]=g.useState(0);return g.useEffect(()=>{const l=setTimeout(()=>{const c=t/40;let o=0;const n=setInterval(()=>{o+=c,o>=t?(r(t),clearInterval(n)):r(o)},800/40);return()=>clearInterval(n)},a);return()=>clearTimeout(l)},[t,a]),e.jsx("span",{children:Math.round(s).toLocaleString()})}function Ht({value:t,className:a}){const[s,r]=g.useState(0);return g.useEffect(()=>{const l=setTimeout(()=>{r(t)},300);return()=>clearTimeout(l)},[t]),e.jsx(nt,{value:s,className:a})}function X({title:t,used:a,limit:s,icon:r,color:l,badge:x,delay:i=0}){const c=s===999999?0:a/s*100,o=c>=80,n=s===999999;return e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:i},className:`p-4 sm:p-5 bg-card rounded-xl border ${l==="blue"?"border-blue-200/30 dark:border-blue-800/30":l==="emerald"?"border-emerald-200/30 dark:border-emerald-800/30":l==="amber"?"border-amber-200/30 dark:border-amber-800/30":"border-border/30"} space-y-4`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{className:`w-4 h-4 ${l==="blue"?"text-blue-600 dark:text-blue-400":l==="emerald"?"text-emerald-600 dark:text-emerald-400":l==="amber"?"text-amber-600 dark:text-amber-400":"text-primary"}`}),e.jsx("span",{className:"text-sm font-semibold",children:t})]}),e.jsx(D,{className:`text-xs px-2 py-0.5 ${l==="blue"?"bg-blue-500 text-white":l==="emerald"?"bg-emerald-500 text-white":l==="amber"?"bg-gradient-to-r from-amber-500 to-yellow-600 text-white":"bg-primary text-primary-foreground"}`,children:x})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:`text-2xl font-bold ${l==="blue"?"text-blue-600 dark:text-blue-400":l==="emerald"?"text-emerald-600 dark:text-emerald-400":l==="amber"?"text-amber-600 dark:text-amber-400":"text-primary"}`,children:e.jsx(Be,{value:a,delay:i*1e3})}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:["/ ",n?"Unlimited":s.toLocaleString()]})]}),!n&&e.jsxs(e.Fragment,{children:[e.jsx(Ht,{value:c,className:`h-2 ${l==="blue"?"bg-blue-100 dark:bg-blue-900/30":l==="emerald"?"bg-emerald-100 dark:bg-emerald-900/30":l==="amber"?"bg-amber-100 dark:bg-amber-900/30":"bg-muted"}`}),o&&e.jsxs(j.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex items-center gap-2 text-xs text-orange-600 dark:text-orange-400 bg-orange-100 dark:bg-orange-900/20 rounded-lg p-2",children:[e.jsx(rt,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium",children:"Running low!"})]})]}),n&&e.jsx("div",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:"Unlimited queries available"})]})}function Yt({plan:t,isCurrentPlan:a,userCurrency:s,onUpgrade:r,delay:l=0}){const x=t.name==="pro",i=t.name==="enterprise",c=t.priceUsd==="0.00"||t.name==="free",o=parseFloat(t.priceUsd),n=Ce(o,s);return e.jsx(j.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5,delay:l},className:"h-full",children:e.jsxs(Y,{className:`relative h-full flex flex-col transition-all duration-300 ${x?"border-primary/40 shadow-lg ring-1 ring-primary/20 hover:shadow-xl":"border-border/40 hover:border-border hover:shadow-lg"} ${a?"ring-2 ring-primary bg-primary/5":""}`,"data-testid":`card-plan-${t.name.toLowerCase()}`,children:[x&&e.jsx(j.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:l+.2},children:e.jsx(D,{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 bg-primary text-primary-foreground px-4 py-1 text-xs font-medium z-10",children:"MOST POPULAR"})}),i&&e.jsx(j.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:l+.2},children:e.jsx(D,{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-amber-500 to-yellow-600 text-white px-4 py-1 text-xs font-medium z-10",children:"BEST FOR CFO TEAMS"})}),e.jsxs(ue,{className:"space-y-4 p-5 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(we,{className:"text-lg font-bold",children:t.displayName}),a&&e.jsx(D,{className:"bg-primary text-primary-foreground px-3 py-1 text-xs font-medium",children:"Active"})]}),e.jsx(it,{className:"text-sm leading-relaxed",children:t.description}),e.jsx("div",{className:"space-y-2 pt-2",children:c?e.jsx("div",{className:"flex items-baseline",children:e.jsx("span",{className:"text-4xl sm:text-5xl font-bold",children:"Free"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-4xl sm:text-5xl font-bold",children:[n.currency.symbol,n.amount.toFixed(2)]}),e.jsx("span",{className:"text-muted-foreground text-base",children:"/month"})]}),n.isDiscounted&&n.originalAmount&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground line-through",children:ie(n.originalAmount,s)}),e.jsxs(D,{className:"bg-green-500 text-white text-xs",children:[Math.round((1-n.amount/n.originalAmount)*100),"% OFF"]})]}),s!=="USD"&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["~",ie(o,"USD")," USD"]})]})})]}),e.jsxs(Z,{className:"flex-1 flex flex-col space-y-6 p-5 sm:p-6 pt-0",children:[e.jsxs("div",{className:"space-y-4 flex-1",children:[e.jsxs("h4",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-primary"}),"AI Model Quotas"]}),e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),e.jsx("span",{className:"text-sm",children:"Scout (Fast)"})]}),e.jsx("span",{className:"text-sm font-bold text-blue-600 dark:text-blue-400","data-testid":`text-${t.name.toLowerCase()}-scout-limit`,children:t.scoutLimit===999999?"Unlimited":t.scoutLimit})]}),t.sonnetLimit>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),e.jsx("span",{className:"text-sm",children:"Sonnet (Smart)"})]}),e.jsx("span",{className:"text-sm font-bold text-blue-600 dark:text-blue-400","data-testid":`text-${t.name.toLowerCase()}-sonnet-limit`,children:t.sonnetLimit})]}),t.gpt5Limit>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"}),e.jsx("span",{className:"text-sm",children:"GPT-5 (Math)"})]}),e.jsx("span",{className:"text-sm font-bold text-emerald-600 dark:text-emerald-400","data-testid":`text-${t.name.toLowerCase()}-gpt5-limit`,children:t.gpt5Limit})]}),t.opusLimit>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"}),e.jsx("span",{className:"text-sm",children:"Opus (CFO)"})]}),e.jsx("span",{className:"text-sm font-bold text-amber-600 dark:text-amber-400","data-testid":`text-${t.name.toLowerCase()}-opus-limit`,children:t.opusLimit===999999?"Unlimited":t.opusLimit})]})]}),e.jsxs("div",{className:"space-y-2.5 pt-2",children:[e.jsxs("h4",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-green-500"}),"Features Included"]}),e.jsx("ul",{className:"space-y-2",children:t.features.slice(0,5).map((y,m)=>e.jsxs("li",{className:"flex items-center gap-2.5 text-sm",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:e.jsx(M,{className:"w-2.5 h-2.5 text-green-600 dark:text-green-400"})}),e.jsx("span",{className:"text-muted-foreground capitalize",children:y.replace(/_/g," ")})]},m))})]})]}),e.jsx(U,{className:`w-full h-12 text-base font-semibold ${a?"bg-muted text-muted-foreground cursor-not-allowed":x||i?"bg-primary hover:bg-primary/90 text-primary-foreground shadow-md hover:shadow-lg":"bg-primary hover:bg-primary/90 text-primary-foreground"}`,disabled:a,onClick:r,"data-testid":`button-upgrade-${t.name.toLowerCase()}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Current Plan"]}):c?e.jsxs(e.Fragment,{children:["Start Free",e.jsx(ge,{className:"w-4 h-4 ml-2"})]}):e.jsxs(e.Fragment,{children:["Upgrade to ",t.name,e.jsx(J,{className:"w-4 h-4 ml-2"})]})})]})]})})}function ps(){var b;const{toast:t}=st();at();const[a,s]=g.useState(!1),[r,l]=g.useState(null),{data:x,isLoading:i}=G({queryKey:["/api/subscription/plans"]}),{data:c,isLoading:o}=G({queryKey:["/api/subscription/current"]}),{data:n}=G({queryKey:["/api/subscription/usage"],refetchInterval:5*60*1e3}),{data:y}=G({queryKey:["/api/user-preferences"]}),m=d=>{d.name==="free"?pe("POST","/api/subscription/upgrade",{planId:d.id}).then(()=>{t({title:"Switched to Free Plan",description:"You're now on the Free plan."}),P.invalidateQueries({queryKey:["/api/subscription/current"]}),P.invalidateQueries({queryKey:["/api/subscription/usage"]})}).catch(p=>{t({title:"Upgrade failed",description:p.message||"Failed to change plan",variant:"destructive"})}):(l(d),s(!0))},h=()=>{s(!1),l(null)};if(i||o)return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-background/95 backdrop-blur border-b border-border/40 sticky top-0 z-30",children:e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx(H,{className:"h-8 w-48 mb-2"}),e.jsx(H,{className:"h-4 w-64"})]})}),e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-8 space-y-8",children:[e.jsx(Y,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(H,{className:"h-6 w-48"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[...Array(4)].map((d,p)=>e.jsx(H,{className:"h-32 rounded-xl"},p))})]})}),e.jsx("div",{className:"grid gap-6 md:grid-cols-3",children:[1,2,3].map(d=>e.jsx(H,{className:"h-[500px] rounded-xl"},d))})]})]});const u=(b=c==null?void 0:c.subscription)==null?void 0:b.plan,f=(y==null?void 0:y.currency)||"USD";return e.jsxs("div",{className:"min-h-screen-mobile bg-background pb-20 md:pb-0",children:[e.jsx("header",{className:"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border/40 sticky top-0 z-30",children:e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4 lg:py-6",children:e.jsxs(j.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4},children:[e.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl xl:text-3xl font-semibold tracking-tight text-foreground",children:"Subscription Plans"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5 sm:mt-1 line-clamp-1",children:"Upgrade your account to unlock advanced features"})]})})}),e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-6 sm:py-8 space-y-8 sm:space-y-12",children:[u&&e.jsx(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:e.jsxs(Y,{className:"border-border/40 overflow-hidden",children:[e.jsx(ue,{className:"space-y-3 pb-4",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:"Your Current Plan"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u.displayName})]}),e.jsx(D,{variant:"secondary",className:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 border-0",children:"Active"})]})}),e.jsxs(Z,{className:"space-y-6",children:[n&&e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(X,{title:"Scout Queries",used:n.scoutUsage.used,limit:n.scoutUsage.limit,icon:T,color:"blue",badge:"Fast",delay:0}),n.sonnetUsage.limit>0&&e.jsx(X,{title:"Sonnet Queries",used:n.sonnetUsage.used,limit:n.sonnetUsage.limit,icon:q,color:"blue",badge:"Smart",delay:.1}),n.gpt5Usage&&n.gpt5Usage.limit>0&&e.jsx(X,{title:"GPT-5 Queries",used:n.gpt5Usage.used,limit:n.gpt5Usage.limit,icon:ee,color:"emerald",badge:"Math",delay:.2}),n.opusUsage.limit>0&&e.jsx(X,{title:"Opus Queries",used:n.opusUsage.used,limit:n.opusUsage.limit,icon:J,color:"amber",badge:"CFO",delay:.3})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-3",children:[{label:"Insights Generated",value:(n==null?void 0:n.insights)||0,icon:q},{label:"Tokens Used",value:(n==null?void 0:n.totalTokens)||0,icon:T},{label:"AI Costs",value:ie(parseFloat((n==null?void 0:n.estimatedCost)||"0"),"USD"),icon:ee}].map((d,p)=>e.jsxs(j.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4+p*.1},className:"text-center p-4 sm:p-5 bg-muted/50 rounded-xl",children:[e.jsx(d.icon,{className:"w-5 h-5 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:typeof d.value=="number"?e.jsx(Be,{value:d.value,delay:400+p*100}):d.value}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:d.label})]},d.label))})]})]})}),e.jsx(qt,{userCurrency:f,currentTier:(u==null?void 0:u.name)==="enterprise"?"enterprise":(u==null?void 0:u.name)==="pro"?"pro":"free"}),e.jsxs("div",{className:"space-y-8 sm:space-y-10",children:[e.jsxs(j.div,{className:"text-center space-y-3 sm:space-y-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold tracking-tight text-foreground",children:"Choose Your Plan"}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg text-muted-foreground max-w-2xl mx-auto",children:"Start free and scale as you grow. Unlock AI-powered financial insights."}),e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-4 sm:gap-6 text-xs sm:text-sm text-muted-foreground pt-2",children:[{icon:he,text:"Cancel anytime"},{icon:T,text:"Instant activation"},{icon:jt,text:"No setup fees"}].map((d,p)=>e.jsxs(j.div,{className:"flex items-center gap-1.5",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3+p*.1},children:[e.jsx(d.icon,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:d.text})]},d.text))})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8 max-w-6xl mx-auto px-1",children:x==null?void 0:x.sort((d,p)=>d.sortOrder-p.sortOrder).slice(0,3).map((d,p)=>e.jsx(Yt,{plan:d,isCurrentPlan:(u==null?void 0:u.id)===d.id,userCurrency:f,onUpgrade:()=>m(d),delay:p*.15},d.id))})]}),e.jsx(j.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5,delay:.6},children:e.jsxs(Y,{className:"relative overflow-hidden border-border/40",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/5 via-primary/10 to-primary/5"}),e.jsx(Z,{className:"relative p-6 sm:p-8",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("div",{className:"p-3 sm:p-4 bg-primary/10 rounded-2xl",children:e.jsx(T,{className:"h-8 w-8 sm:h-10 sm:w-10 text-primary"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-foreground",children:"Why Choose Twealth AI?"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Advanced AI technology at unbeatable prices"})]})]}),e.jsx("div",{className:"grid gap-4 sm:gap-6 sm:grid-cols-3",children:[{value:"25x",label:"Cheaper than hiring a CFO"},{value:"4",label:"AI models working for you"},{value:"24/7",label:"Financial insights available"}].map((d,p)=>e.jsxs(j.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.8+p*.1},className:"text-center p-4 sm:p-6 bg-card rounded-xl border border-border/40",children:[e.jsx("p",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-primary",children:d.value}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:d.label})]},d.label))})]})})]})})]}),e.jsx(Qt,{isOpen:a,onClose:h,plan:r,localizedPrice:r?{...Ce(parseFloat(r.priceUsd),f)}:{amount:0,currency:{symbol:"$",code:"USD"}},userCurrency:f,onSuccess:()=>{t({title:"Subscription Activated!",description:`You're now on ${r==null?void 0:r.displayName}. Enjoy your premium features!`}),h()}})]})}export{ps as default};
