import{c as f,bD as b,u as w,a as N,g as k,h as y,j as e,bT as C,n as l,s as d,t as o,v as x,w as u,B as n,ai as I,o as D}from"./index-B1iCb0U8.js";import{B as h}from"./badge-BLQt1mrv.js";import{C as E}from"./calendar-BhxlC1A9.js";import{C as B}from"./circle-check-big-BvO-LMIQ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=f("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function R(){const[,c]=b("/invite/:token"),[,i]=w(),{toast:m}=N(),a=c==null?void 0:c.token,{data:s,isLoading:p,error:j}=k({queryKey:["/api/invites",a],queryFn:()=>fetch(`/api/invites/${a}`).then(t=>{if(!t.ok)throw new Error("Invalid or expired invite");return t.json()}),enabled:!!a}),r=y({mutationFn:()=>D("POST",`/api/invites/${a}/accept`,{}),onSuccess:()=>{var t;m({title:"Invite accepted!",description:`You've successfully joined ${(t=s==null?void 0:s.group)==null?void 0:t.name}`}),i("/groups")},onError:t=>{m({title:"Error",description:t.message||"Failed to accept invite",variant:"destructive"})}}),g=()=>{r.mutate()},v=()=>{i("/groups")};return p?e.jsx(C,{}):j||!s?e.jsx("div",{className:"flex items-center justify-center min-h-screen p-6",children:e.jsxs(l,{className:"max-w-md w-full",children:[e.jsxs(d,{children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 rounded-full bg-destructive/10 mx-auto mb-4",children:e.jsx(P,{className:"w-8 h-8 text-destructive"})}),e.jsx(o,{className:"text-center",children:"Invalid Invite"}),e.jsx(x,{className:"text-center",children:"This invite link is invalid or has expired."})]}),e.jsx(u,{children:e.jsx(n,{onClick:()=>i("/groups"),className:"w-full","data-testid":"button-back-to-groups",children:"Back to Groups"})})]})}):new Date(s.expiresAt)<new Date?e.jsx("div",{className:"flex items-center justify-center min-h-screen p-6",children:e.jsxs(l,{className:"max-w-md w-full",children:[e.jsxs(d,{children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 rounded-full bg-destructive/10 mx-auto mb-4",children:e.jsx(E,{className:"w-8 h-8 text-destructive"})}),e.jsx(o,{className:"text-center",children:"Invite Expired"}),e.jsx(x,{className:"text-center",children:"This invite link has expired. Please request a new invite from the group owner."})]}),e.jsx(u,{children:e.jsx(n,{onClick:()=>i("/groups"),className:"w-full","data-testid":"button-back-to-groups",children:"Back to Groups"})})]})}):e.jsx("div",{className:"flex items-center justify-center min-h-screen p-6 bg-white dark:bg-gray-900",children:e.jsxs(l,{className:"max-w-lg w-full shadow-2xl",children:[e.jsxs(d,{children:[e.jsx("div",{className:"flex items-center justify-center w-20 h-20 rounded-full bg-white dark:bg-gray-900 mx-auto mb-4",children:e.jsx(I,{className:"w-10 h-10 text-white"})}),e.jsx(o,{className:"text-2xl text-center",children:"You're Invited!"}),e.jsx(x,{className:"text-center text-base",children:"You've been invited to join a group"})]}),e.jsxs(u,{className:"space-y-6",children:[e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-900 rounded-lg border border-emerald-200 dark:border-emerald-800",children:[e.jsx("h3",{className:"text-xl font-bold mb-2 text-foreground",children:s.group.name}),s.group.description&&e.jsx("p",{className:"text-muted-foreground mb-4",children:s.group.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(h,{variant:"secondary",className:"capitalize",children:[s.role," Role"]}),e.jsxs(h,{variant:"outline",children:["Expires ",new Date(s.expiresAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(n,{onClick:v,variant:"outline",className:"flex-1",disabled:r.isPending,"data-testid":"button-decline-invite",children:"Decline"}),e.jsx(n,{onClick:g,className:"flex-1 bg-white dark:bg-gray-900",disabled:r.isPending,"data-testid":"button-accept-invite",children:r.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Accepting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Accept Invite"]})})]})]})]})})}export{R as default};
