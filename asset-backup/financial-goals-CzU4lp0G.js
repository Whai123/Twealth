import{c as O,r as k,a as me,a5 as ye,p as rt,h as Y,j as e,d as qe,e as ze,f as Ee,ab as E,I as ee,F as H,H as K,J as Q,K as _,M,B as S,O as it,o as J,Q as nt,ad as lt,R as V,n as F,s as G,t as P,w as T,P as ae,x as q,z as U,W as re,E as Z,g as W,a1 as Ne,y as Oe,ah as oe,A as ot,S as fe,i as Be,k as Ve,m as Re,ak as I,am as we,an as ct,Z as ie,_ as ke,Y as Se,D as ne,ag as dt,b as le,ao as mt,ap as ut,aq as xt,X as ht,a0 as pt,a2 as L,ar as gt,as as Ae,at as $e,au as Ce,av as Fe,G as De,V as R,aw as ft,U as jt,ax as yt,N as vt}from"./index-B1iCb0U8.js";import{E as bt}from"./empty-state-B00YxJ5W.js";import{B as C}from"./badge-BLQt1mrv.js";import{T as Nt,a as wt,b as te,c as se}from"./tabs-BIKejfai.js";import{T as kt}from"./textarea-BqHY_pYZ.js";import{A as St}from"./add-funds-form-B3SaNlWF.js";import{C as Ue,a as Te}from"./addMonths-4pYBL7X2.js";import{C as We,L as Ye}from"./lightbulb-bY4g1OJs.js";import{d as At,f as $t}from"./format-BI6KV3YQ.js";import{t as Ie}from"./startOfWeek-D6dzzDOw.js";import{C as ve}from"./calendar-BhxlC1A9.js";import{C as ue}from"./clock-D17WIfTi.js";import{C as je}from"./circle-check-big-BvO-LMIQ.js";import{A as ce}from"./award-CtYuvMv3.js";import{d as Me}from"./differenceInMonths-C41JoVav.js";import{Z as xe}from"./zap-Dg1ivvH7.js";import{S as de}from"./share-2-DgAeCUTh.js";import{M as Ct}from"./mail-DEFrcbWa.js";import{C as Ft}from"./copy-BNMDfCm1.js";import{G as Dt}from"./gift-DaYAbzLt.js";import{R as Tt}from"./rocket-CyseJzex.js";import{S as It}from"./scroll-area-WxKb7haM.js";import{E as Mt}from"./ellipsis-9pnAy1h0.js";import{T as Gt}from"./trash-2-CRPKIWBw.js";import"./message-square-CI5kBZgv.js";import"./endOfMonth-AzK47_pP.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=O("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=O("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=O("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=O("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=O("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=O("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=O("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),Et=nt({title:V().min(1,"Goal title is required"),description:V().optional(),targetAmount:V().min(1,"Target amount is required").refine(t=>!isNaN(parseFloat(t))&&parseFloat(t)>0,"Must be a valid positive number"),currentAmount:V().optional().refine(t=>!t||!isNaN(parseFloat(t))&&parseFloat(t)>=0,"Must be a valid positive number"),targetDate:V().min(1,"Target date is required"),category:V().optional(),priority:lt(["low","medium","high"]).default("medium")}),Ot=["emergency","house","vacation","car","education","retirement","investment","other"];function Bt({goal:t,onSuccess:m}){const[l,c]=k.useState(!1),{toast:i}=me(),g=ye(),f=n=>n?new Date(n).toISOString().split("T")[0]:"",{register:j,handleSubmit:a,setValue:r,watch:v,formState:{errors:o}}=rt({resolver:it(Et),defaultValues:{title:(t==null?void 0:t.title)||"",description:(t==null?void 0:t.description)||"",targetAmount:(t==null?void 0:t.targetAmount)||"",currentAmount:(t==null?void 0:t.currentAmount)||"0",targetDate:f(t==null?void 0:t.targetDate),category:(t==null?void 0:t.category)||"",priority:(t==null?void 0:t.priority)||"medium"}}),s=Y({mutationFn:n=>J("PUT",`/api/financial-goals/${t.id}`,{...n,targetAmount:n.targetAmount,currentAmount:n.currentAmount||"0",targetDate:new Date(n.targetDate)}),onSuccess:()=>{g.invalidateQueries({queryKey:["/api/financial-goals"]}),g.invalidateQueries({queryKey:["/api/dashboard/stats"]}),g.invalidateQueries({queryKey:["/api/goal-milestones"]}),i({title:"Goal updated",description:"Your financial goal has been updated successfully."}),m==null||m()},onError:n=>{i({title:"Error",description:n.message,variant:"destructive"})},onSettled:()=>{c(!1)}}),d=n=>{if(new Date(n.targetDate)<=new Date){i({title:"Invalid date",description:"Target date must be in the future.",variant:"destructive"});return}const h=parseFloat(n.currentAmount||"0"),b=parseFloat(n.targetAmount);if(h>b){i({title:"Invalid amounts",description:"Current amount cannot exceed target amount.",variant:"destructive"});return}c(!0),s.mutate(n)};return e.jsxs(e.Fragment,{children:[e.jsxs(qe,{children:[e.jsx(ze,{children:"Edit Financial Goal"}),e.jsx(Ee,{children:"Update your goal details, target amount, or deadline"})]}),e.jsxs("form",{onSubmit:a(d),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"title",children:"Goal Title"}),e.jsx(ee,{id:"title",...j("title"),placeholder:"e.g., Emergency Fund, Vacation, House Down Payment","data-testid":"input-edit-goal-title"}),o.title&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:o.title.message})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"description",children:"Description (Optional)"}),e.jsx(kt,{id:"description",...j("description"),placeholder:"Describe your goal and why it's important to you",rows:3,"data-testid":"input-edit-goal-description"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"targetAmount",children:"Target Amount ($)"}),e.jsx(ee,{id:"targetAmount",type:"number",step:"0.01",min:"0",...j("targetAmount"),placeholder:"10000","data-testid":"input-edit-goal-target-amount"}),o.targetAmount&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:o.targetAmount.message})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"currentAmount",children:"Current Amount ($)"}),e.jsx(ee,{id:"currentAmount",type:"number",step:"0.01",min:"0",...j("currentAmount"),placeholder:"0","data-testid":"input-edit-goal-current-amount"}),o.currentAmount&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:o.currentAmount.message})]})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"targetDate",children:"Target Date"}),e.jsx(ee,{id:"targetDate",type:"date",...j("targetDate"),"data-testid":"input-edit-goal-target-date"}),o.targetDate&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:o.targetDate.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"category",children:"Category"}),e.jsxs(H,{value:v("category")||"",onValueChange:n=>r("category",n||void 0),children:[e.jsx(K,{"data-testid":"select-edit-goal-category",children:e.jsx(Q,{placeholder:"Select category"})}),e.jsx(_,{children:Ot.map(n=>e.jsx(M,{value:n,children:n.charAt(0).toUpperCase()+n.slice(1)},n))})]})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"priority",children:"Priority"}),e.jsxs(H,{value:v("priority"),onValueChange:n=>r("priority",n),children:[e.jsx(K,{"data-testid":"select-edit-goal-priority",children:e.jsx(Q,{})}),e.jsxs(_,{children:[e.jsx(M,{value:"low",children:"Low"}),e.jsx(M,{value:"medium",children:"Medium"}),e.jsx(M,{value:"high",children:"High"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(S,{type:"button",variant:"outline",onClick:m,"data-testid":"button-cancel-edit",children:"Cancel"}),e.jsx(S,{type:"submit",disabled:l,"data-testid":"button-save-goal",children:l?"Saving...":"Save Changes"})]})]})]})}function D(t,m){const l=Ie(t),c=Ie(m),i=Le(l,c),g=Math.abs(At(l,c));l.setDate(l.getDate()-i*g);const f=+(Le(l,c)===-i),j=i*(g-f);return j===0?0:j}function Le(t,m){const l=t.getFullYear()-m.getFullYear()||t.getMonth()-m.getMonth()||t.getDate()-m.getDate()||t.getHours()-m.getHours()||t.getMinutes()-m.getMinutes()||t.getSeconds()-m.getSeconds()||t.getMilliseconds()-m.getMilliseconds();return l<0?-1:l>0?1:l}function Vt({goals:t,onGoalClick:m}){const l=k.useMemo(()=>t.filter(s=>s.status==="active"),[t]),c=k.useMemo(()=>t.filter(s=>s.status==="completed"),[t]),{totalSaved:i,totalTargets:g,overallProgress:f}=k.useMemo(()=>{const s=t.reduce((h,b)=>h+parseFloat(b.currentAmount),0),d=t.reduce((h,b)=>h+parseFloat(b.targetAmount),0),n=d>0?s/d*100:0;return{totalSaved:s,totalTargets:d,overallProgress:n}},[t]),j=s=>{if(!s.createdAt)return 0;const d=D(new Date,new Date(s.createdAt));return d<=0?0:parseFloat(s.currentAmount)/d},a=s=>{const d=j(s);if(d<=0)return null;const n=parseFloat(s.targetAmount)-parseFloat(s.currentAmount),h=Math.ceil(n/d),b=new Date;return b.setDate(b.getDate()+h),b},r=s=>{const d=parseFloat(s.currentAmount)/parseFloat(s.targetAmount)*100,n=D(new Date(s.targetDate),new Date),h=j(s),b=a(s);return d>=100?{type:"success",label:"Completed",icon:je,color:"text-green-600"}:n<0?{type:"danger",label:"Overdue",icon:re,color:"text-red-600"}:b&&b>new Date(s.targetDate)?{type:"warning",label:"At Risk",icon:re,color:"text-yellow-600"}:d>=80?{type:"success",label:"On Track",icon:q,color:"text-green-600"}:h>0?{type:"info",label:"Building",icon:q,color:"text-blue-600"}:{type:"neutral",label:"Getting Started",icon:Z,color:"text-gray-600"}},v=()=>{const s=l.reduce((d,n)=>{const h=n.category||"other";return d[h]||(d[h]={totalTarget:0,totalSaved:0,count:0}),d[h].totalTarget+=parseFloat(n.targetAmount),d[h].totalSaved+=parseFloat(n.currentAmount),d[h].count+=1,d},{});return Object.entries(s).map(([d,n])=>({category:d,progress:n.totalTarget>0?n.totalSaved/n.totalTarget*100:0,saved:n.totalSaved,target:n.totalTarget,count:n.count}))},o=k.useMemo(()=>v(),[l]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(F,{className:"bg-white dark:bg-gray-900 border-blue-200 dark:border-blue-800",children:[e.jsx(G,{className:"pb-3",children:e.jsxs(P,{className:"flex items-center text-blue-900 dark:text-blue-100",children:[e.jsx(Ue,{className:"mr-2 h-5 w-5"}),"Portfolio Overview"]})}),e.jsxs(T,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.length}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"Active Goals"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.length}),e.jsx("div",{className:"text-xs text-green-600/70",children:"Completed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["$",i.toLocaleString()]}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"Total Saved"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(f),"%"]}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"Overall Progress"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Portfolio Progress"}),e.jsxs("span",{children:["$",i.toLocaleString()," of $",g.toLocaleString()]})]}),e.jsx(ae,{value:f,className:"h-3"})]})]})]}),o.length>0&&e.jsxs(F,{children:[e.jsx(G,{children:e.jsxs(P,{className:"flex items-center",children:[e.jsx(We,{className:"mr-2 h-5 w-5"}),"Category Performance"]})}),e.jsx(T,{children:e.jsx("div",{className:"space-y-4",children:o.map(({category:s,progress:d,saved:n,target:h,count:b})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium capitalize",children:s}),e.jsxs(C,{variant:"secondary",className:"text-xs",children:[b," goals"]})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["$",n.toLocaleString()," / $",h.toLocaleString()]})]}),e.jsx(ae,{value:d,className:"h-2"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[Math.round(d),"% complete"]})]},s))})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Goal Analytics"}),l.map(s=>{const d=parseFloat(s.currentAmount)/parseFloat(s.targetAmount)*100,n=r(s),h=j(s),b=a(s),p=D(new Date(s.targetDate),new Date),u=p>0?(parseFloat(s.targetAmount)-parseFloat(s.currentAmount))/(p/30):0;return e.jsx(F,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>m==null?void 0:m(s),"data-testid":`card-goal-analytics-${s.id}`,children:e.jsxs(T,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-lg mb-1 truncate",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(n.icon,{className:`h-4 w-4 mr-1 ${n.color}`}),e.jsx("span",{className:n.color,children:n.label})]}),s.category&&e.jsx(C,{variant:"outline",className:"capitalize",children:s.category})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",parseFloat(s.currentAmount).toLocaleString()]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["of $",parseFloat(s.targetAmount).toLocaleString()]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(d),"%"]})]}),e.jsx(ae,{value:d,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[p," days"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"remaining"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:["$",h.toFixed(2)]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"daily rate"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:["$",u.toFixed(0)]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"monthly needed"})]})]}),b&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ue,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:$t(b,"MMM dd")}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"projected"})]})]})]}),n.type==="warning"&&e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-950/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(re,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Goal at risk"}),e.jsx("div",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:"Current pace may not meet target date. Consider increasing contributions."})]})]})})]})]})},s.id)})]})]})}function Rt({goals:t,onActionClick:m}){const{data:l}=W({queryKey:["/api/transactions"],queryFn:()=>fetch("/api/transactions").then(r=>r.json())}),c=t.filter(r=>r.status==="active"),i=t.filter(r=>r.status==="completed"),f=(()=>{const r=[];i.length>0&&r.push({id:"completion-celebration",type:"achievement",icon:ce,title:`${i.length} Goal${i.length>1?"s":""} Completed!`,description:`You've successfully completed ${i.length} financial goal${i.length>1?"s":""}. Your dedication is paying off!`,priority:1});const v=c.filter(p=>{const u=D(new Date(p.targetDate),new Date),N=parseFloat(p.currentAmount)/parseFloat(p.targetAmount)*100,w=u/30,x=w>0?(parseFloat(p.targetAmount)-parseFloat(p.currentAmount))/w:1/0;return u<60&&N<80&&x>1e3});v.length>0&&r.push({id:"goals-need-attention",type:"warning",icon:re,title:"Goals Need Attention",description:`${v.length} goal${v.length>1?"s are":" is"} at risk of missing target dates. Consider adjusting timelines or increasing contributions.`,action:"review-timeline",goalId:v[0].id,priority:2});const o=c.filter(p=>{const u=parseFloat(p.currentAmount)/parseFloat(p.targetAmount)*100,N=D(new Date(p.targetDate),new Date),w=p.createdAt?(1-N/D(new Date(p.targetDate),new Date(p.createdAt)))*100:0;return u>w+20&&u>=30});if(o.length>0&&r.push({id:"excellent-progress",type:"success",icon:q,title:"Excellent Progress!",description:`You're ahead of schedule on ${o.length} goal${o.length>1?"s":""}. Keep up the great work!`,priority:3}),l&&l.length>0){const p=l.filter(w=>w.type==="income"&&new Date(w.date)>=Te(new Date,-1)).reduce((w,x)=>w+parseFloat(x.amount),0),u=l.filter(w=>w.type==="expense"&&new Date(w.date)>=Te(new Date,-1)).reduce((w,x)=>w+parseFloat(x.amount),0),N=p-u;N>500&&c.length>0&&r.push({id:"savings-opportunity",type:"info",icon:U,title:"Savings Opportunity Identified",description:`Based on your income patterns, you could potentially save an additional $${N.toFixed(0)} monthly towards your goals.`,action:"optimize-budget",priority:4})}const s=new Set(c.map(p=>p.category).filter(Boolean));c.length>=3&&s.size===1&&r.push({id:"diversify-goals",type:"info",icon:Ue,title:"Consider Goal Diversification",description:"All your goals are in the same category. Consider diversifying across emergency funds, investments, and lifestyle goals.",action:"diversify-portfolio",priority:5});const d=c.filter(p=>Me(new Date(p.targetDate),new Date)<=12),n=c.filter(p=>Me(new Date(p.targetDate),new Date)>12);return d.length===0&&n.length>0&&r.push({id:"need-short-term-goals",type:"info",icon:ue,title:"Consider Short-term Goals",description:"Having some short-term goals (under 1 year) can help maintain motivation and create quick wins.",action:"create-short-term",priority:6}),((l==null?void 0:l.filter(p=>p.goalId&&c.some(u=>u.id===p.goalId)))||[]).filter(p=>D(new Date,new Date(p.date))<=7).length===0&&c.length>0&&r.push({id:"maintain-momentum",type:"info",icon:xe,title:"Maintain Your Momentum",description:"No contributions to goals this week. Small, consistent contributions lead to big results!",action:"quick-contribute",priority:7}),r.sort((p,u)=>p.priority-u.priority)})(),j=r=>{switch(r){case"success":return"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/20";case"warning":return"border-yellow-200 dark:border-yellow-800 bg-yellow-50 dark:bg-yellow-950/20";case"achievement":return"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20";default:return"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20"}},a=r=>{switch(r){case"success":return"text-green-600";case"warning":return"text-yellow-600";case"achievement":return"text-blue-600";default:return"text-blue-600"}};return f.length===0?e.jsxs(F,{children:[e.jsx(G,{children:e.jsxs(P,{className:"flex items-center",children:[e.jsx(Ne,{className:"mr-2 h-5 w-5"}),"Smart Insights"]})}),e.jsx(T,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ye,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Building Your Profile"}),e.jsx("p",{className:"text-muted-foreground",children:"Create some goals and start saving to unlock personalized insights and recommendations."})]})})]}):e.jsxs(F,{children:[e.jsx(G,{children:e.jsxs(P,{className:"flex items-center",children:[e.jsx(Ne,{className:"mr-2 h-5 w-5"}),"Smart Insights"]})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-4",children:[f.slice(0,5).map(r=>e.jsx("div",{className:`p-4 rounded-lg border ${j(r.type)}`,"data-testid":`insight-${r.id}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx(r.icon,{className:`h-5 w-5 mt-0.5 ${a(r.type)}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium mb-1",children:r.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]})]}),r.action&&e.jsx(S,{size:"sm",variant:"outline",onClick:()=>m==null?void 0:m(r.action,r.goalId),"data-testid":`button-insight-action-${r.id}`,className:"ml-4 shrink-0",children:"Take Action"})]})},r.id)),f.length>5&&e.jsx("div",{className:"text-center pt-2",children:e.jsxs(S,{variant:"ghost",size:"sm",className:"text-muted-foreground",children:["View ",f.length-5," More Insights"]})})]})})]})}function Ut({goals:t,onImplementSuggestion:m}){const[l,c]=k.useState("all"),{data:i}=W({queryKey:["/api/transactions"],queryFn:()=>fetch("/api/transactions").then(o=>o.json())}),g=t.filter(o=>o.status==="active"),j=(()=>{const o=[];if(!i||i.length===0)return[];const s=i.filter(u=>D(new Date,new Date(u.date))<=30),d=s.filter(u=>u.type==="income").reduce((u,N)=>u+parseFloat(N.amount),0),n=s.filter(u=>u.type==="expense").reduce((u,N)=>u+parseFloat(N.amount),0),h=s.filter(u=>u.type==="expense"&&["entertainment","dining","shopping","subscriptions"].includes(u.category||"")).reduce((u,N)=>u+parseFloat(N.amount),0);if(n>0){const u=s.filter(N=>N.type==="expense").length*.5;o.push({id:"round-up-savings",type:"automation",title:"Round-Up Savings",description:`Automatically round up purchases and save the change. Based on your spending, this could save ~$${u.toFixed(0)} monthly.`,impact:`+$${(u*12).toFixed(0)} annually`,difficulty:"easy",timeToSee:"1 week",monthlyIncrease:u,annualIncrease:u*12,confidence:95,actionButton:"Enable Round-Up"})}if(h>200){const u=h*.15;o.push({id:"reduce-discretionary",type:"optimization",title:"Optimize Discretionary Spending",description:`Reducing entertainment and dining expenses by 15% could free up $${u.toFixed(0)} monthly for goals.`,impact:`+$${(u*12).toFixed(0)} annually`,difficulty:"medium",timeToSee:"2 weeks",monthlyIncrease:u,annualIncrease:u*12,confidence:80,actionButton:"Set Spending Limits"})}if(g.forEach(u=>{const N=parseFloat(u.currentAmount)/parseFloat(u.targetAmount)*100,w=D(new Date(u.targetDate),new Date),x=w/30,A=x>0?(parseFloat(u.targetAmount)-parseFloat(u.currentAmount))/x:0;if(N<50&&w>30&&A<d*.3){const B=Math.min(A*1.2,d*.1);o.push({id:`increase-${u.id}`,type:"amount",goalId:u.id,title:`Accelerate"${u.title}"`,description:`Increase monthly contributions by $${B.toFixed(0)} to complete this goal ${Math.ceil(B/A*30)} days earlier.`,impact:`Goal completion ${Math.ceil(B/A*30)} days sooner`,difficulty:"easy",timeToSee:"1 month",monthlyIncrease:B,confidence:85,actionButton:"Increase Contribution"})}N<25&&w>60&&o.push({id:`automate-${u.id}`,type:"automation",goalId:u.id,title:`Automate"${u.title}" Savings`,description:`Set up automatic weekly transfers of $${(A/4).toFixed(0)} to stay on track without thinking about it.`,impact:"Consistent progress without manual effort",difficulty:"easy",timeToSee:"Immediate",monthlyIncrease:A,confidence:90,actionButton:"Set Up Automation"})}),d>0&&d<8e3&&o.push({id:"income-optimization",type:"optimization",title:"Explore Income Opportunities",description:"Consider side hustles, skill development, or asking for a raise to accelerate your savings goals.",impact:"Potentially +20-50% income",difficulty:"hard",timeToSee:"3-6 months",confidence:60,actionButton:"Explore Options"}),!g.some(u=>u.category==="emergency"||u.title.toLowerCase().includes("emergency"))&&n>0){const u=n*3;o.push({id:"emergency-fund",type:"optimization",title:"Create Emergency Fund Goal",description:`Build a safety net of $${u.toFixed(0)} (3 months of expenses) before focusing on other goals.`,impact:"Financial security and peace of mind",difficulty:"medium",timeToSee:"6-12 months",confidence:95,actionButton:"Create Emergency Fund"})}const p=t.reduce((u,N)=>u+parseFloat(N.currentAmount),0);return p>5e3&&o.push({id:"high-yield-savings",type:"optimization",title:"Optimize Savings Account",description:`With $${p.toLocaleString()} saved, switching to a high-yield account could earn an extra $${(p*.04).toFixed(0)} annually.`,impact:`+$${(p*.04).toFixed(0)} annually in interest`,difficulty:"easy",timeToSee:"1 month",annualIncrease:p*.04,confidence:85,actionButton:"Find Better Rates"}),o.sort((u,N)=>N.confidence-u.confidence)})(),a=l==="all"?j:j.filter(o=>o.type===l),r=o=>{switch(o){case"easy":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300";case"hard":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},v=o=>{switch(o){case"amount":return U;case"frequency":return ve;case"automation":return xe;case"optimization":return q;default:return Z}};return j.length===0?e.jsxs(F,{children:[e.jsx(G,{children:e.jsxs(P,{className:"flex items-center",children:[e.jsx(Ge,{className:"mr-2 h-5 w-5"}),"AI Savings Suggestions"]})}),e.jsx(T,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Oe,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Building Recommendations"}),e.jsx("p",{className:"text-muted-foreground",children:"Add some transactions and goals to unlock personalized savings strategies."})]})})]}):e.jsxs(F,{children:[e.jsx(G,{children:e.jsxs(P,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ge,{className:"mr-2 h-5 w-5"}),"AI Savings Suggestions"]}),e.jsxs(C,{variant:"secondary",className:"flex items-center",children:[e.jsx(oe,{className:"mr-1 h-3 w-3"}),j.length," suggestions"]})]})}),e.jsxs(T,{children:[e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:[{id:"all",label:"All Suggestions"},{id:"automation",label:"Automation"},{id:"amount",label:"Amounts"},{id:"optimization",label:"Optimization"}].map(o=>e.jsx(S,{variant:l===o.id?"default":"outline",size:"sm",onClick:()=>c(o.id),"data-testid":`filter-${o.id}`,children:o.label},o.id))}),e.jsx("div",{className:"space-y-4",children:a.slice(0,6).map(o=>{const s=v(o.type);return e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-sm transition-shadow","data-testid":`suggestion-${o.id}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(s,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h4",{className:"font-medium",children:o.title}),e.jsx(C,{className:r(o.difficulty),children:o.difficulty}),e.jsxs(C,{variant:"outline",className:"text-xs",children:[o.confidence,"% confidence"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:o.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-4 w-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Impact:"}),e.jsx("div",{className:"text-green-600",children:o.impact})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ue,{className:"h-4 w-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Timeline:"}),e.jsx("div",{className:"text-blue-600",children:o.timeToSee})]})]})]})]})]}),e.jsxs(S,{onClick:()=>m==null?void 0:m(o),className:"ml-4 shrink-0","data-testid":`button-implement-${o.id}`,children:[o.actionButton,e.jsx(ot,{className:"ml-2 h-4 w-4"})]})]})},o.id)})}),a.length>6&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs(S,{variant:"ghost",size:"sm",className:"text-muted-foreground",children:["View ",a.length-6," More Suggestions"]})})]})]})}const Wt=t=>{var f;const m=t.url||window.location.href,l=encodeURIComponent(m),c=encodeURIComponent(t.title),i=encodeURIComponent(t.description),g=((f=t.hashtags)==null?void 0:f.join(","))||"Twealth,FinancialGoals,AI";return{twitter:`https://twitter.com/intent/tweet?text=${c}&url=${l}&hashtags=${g}${t.via?`&via=${t.via}`:""}`,facebook:`https://www.facebook.com/sharer/sharer.php?u=${l}&quote=${c}`,linkedin:`https://www.linkedin.com/sharing/share-offsite/?url=${l}&title=${c}&summary=${i}`,whatsapp:`https://wa.me/?text=${c}%20${l}`,telegram:`https://t.me/share/url?url=${l}&text=${c}`,email:`mailto:?subject=${c}&body=${i}%20${l}`,copy:m}},Yt=t=>{const{achievementType:m,value:l,goalTitle:c,category:i,progress:g}=t,f={bronze:"Bronze",silver:"Silver",gold:"Gold",platinum:"Platinum"}[i||"bronze"];switch(m){case"milestone":return{title:`${f} Achievement unlocked! ${g}% progress towards "${c}"`,description:`I'm making great progress on my financial goals with Twealth's AI assistant! ${g}% closer to achieving "${c}". Join me on this journey to financial success!`,hashtags:["FinancialGoals","Achievement","Savings","TwealthAI","MoneyGoals"],via:"TwealthApp"};case"goal_completed":return{title:`Goal achieved! I just completed "${c}" with Twealth!`,description:`Another financial goal conquered! Just saved ${l} for "${c}" using Twealth's AI-powered financial planning. Ready to tackle the next one!`,hashtags:["GoalAchieved","FinancialSuccess","Savings","TwealthAI","MoneyWins"],via:"TwealthApp"};case"streak":return{title:`${l}-day savings streak! Consistency is key!`,description:`I've been consistently saving towards my goals for ${l} days straight using Twealth! The AI insights make it so much easier to stay on track.`,hashtags:["SavingsStreak","Consistency","FinancialHabits","TwealthAI","MoneyMotivation"],via:"TwealthApp"};case"ai_insight":return{title:`AI-powered insight: "${t.title}"`,description:`Twealth's AI just gave me this brilliant financial insight: "${t.description}" These personalized tips are game-changers for my money management!`,hashtags:["AIInsights","SmartMoney","FinancialTips","TwealthAI","MoneyHacks"],via:"TwealthApp"};default:return{title:"Making progress with Twealth!",description:"I'm using Twealth's AI-powered financial planning to achieve my goals! The insights and tracking make saving so much easier.",hashtags:["FinancialGoals","TwealthAI","MoneyManagement"],via:"TwealthApp"}}},Ht=(t,m)=>{const l=Wt(m);switch(t){case"copy":return navigator.clipboard.writeText(l.copy),{success:!0,message:"Link copied to clipboard!"};case"email":return window.location.href=l.email,{success:!0,message:"Email client opened"};default:const c=l[t];return c&&typeof c=="string"?(window.open(c,"_blank","noopener,noreferrer,width=600,height=400"),{success:!0,message:`Shared to ${t}`}):{success:!1,message:"Platform not supported"}}},Ke=()=>typeof navigator<"u"&&"share"in navigator,Kt=async t=>{if(Ke())try{return await navigator.share({title:t.title,text:t.description,url:t.url||window.location.href}),{success:!0,message:"Shared successfully!"}}catch{}const m=`${t.title}

${t.description}

${t.url||window.location.href}`;return await navigator.clipboard.writeText(m),{success:!0,message:"Content copied to clipboard!"}};function Qt({shareData:t,variant:m="outline",size:l="default",showText:c=!0,achievement:i=!1,className:g=""}){const[f,j]=k.useState(!1),{toast:a}=me(),r=async o=>{j(!0);try{const s=await Ht(o,t);s.success?a({title:"Shared successfully!",description:s.message}):a({title:"Share failed",description:s.message,variant:"destructive"})}catch{a({title:"Share failed",description:"Something went wrong. Please try again.",variant:"destructive"})}finally{j(!1)}},v=async()=>{j(!0);try{const o=await Kt(t);a({title:"Shared successfully",description:o.message})}catch{a({title:"Share failed",description:"Something went wrong. Please try again.",variant:"destructive"})}finally{j(!1)}};return Ke()?e.jsxs(S,{onClick:v,variant:m,size:l,disabled:f,className:`${i?"bg-primary text-primary-foreground border-0":""} ${g}`,"data-testid":"button-native-share",children:[i&&e.jsx(fe,{className:"w-4 h-4 mr-2"}),e.jsx(de,{className:"w-4 h-4 mr-2"}),c&&(i?"Share Achievement":"Share")]}):e.jsxs(Be,{children:[e.jsx(Ve,{asChild:!0,children:e.jsxs(S,{variant:m,size:l,disabled:f,className:`${i?"bg-primary text-primary-foreground border-0":""} ${g}`,"data-testid":"button-share-dropdown",children:[i&&e.jsx(fe,{className:"w-4 h-4 mr-2"}),e.jsx(de,{className:"w-4 h-4 mr-2"}),c&&(i?"Share Achievement":"Share")]})}),e.jsx(Re,{align:"end",className:"w-48",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Share to social media"}),e.jsxs(I,{onClick:()=>r("twitter"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-twitter",children:[e.jsx(zt,{className:"w-4 h-4 text-blue-500"}),"Twitter"]}),e.jsxs(I,{onClick:()=>r("facebook"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-facebook",children:[e.jsx(Pt,{className:"w-4 h-4 text-blue-600"}),"Facebook"]}),e.jsxs(I,{onClick:()=>r("linkedin"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-linkedin",children:[e.jsx(Lt,{className:"w-4 h-4 text-blue-700"}),"LinkedIn"]}),e.jsx(we,{}),e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2 mt-2",children:"Share via messaging"}),e.jsxs(I,{onClick:()=>r("whatsapp"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-whatsapp",children:[e.jsx(qt,{className:"w-4 h-4 text-green-500"}),"WhatsApp"]}),e.jsxs(I,{onClick:()=>r("telegram"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-telegram",children:[e.jsx(ct,{className:"w-4 h-4 text-blue-400"}),"Telegram"]}),e.jsxs(I,{onClick:()=>r("email"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-email",children:[e.jsx(Ct,{className:"w-4 h-4 text-gray-600"}),"Email"]}),e.jsx(we,{}),e.jsxs(I,{onClick:()=>r("copy"),className:"flex items-center gap-2 cursor-pointer font-medium","data-testid":"share-copy",children:[e.jsx(Ft,{className:"w-4 h-4"}),"Copy Link"]})]})})]})}function _t({goals:t,onCelebrate:m}){const c=(()=>{const a=[],r=t.filter(s=>s.status==="completed"),v=t.filter(s=>s.status==="active");return v.forEach(s=>{const d=parseFloat(s.currentAmount)/parseFloat(s.targetAmount)*100,n=parseFloat(s.currentAmount);d>=25&&d<50&&a.push({id:`quarter-${s.id}`,goalId:s.id,type:"progress",icon:ke,title:"Quarter Way There!",description:`You've saved 25% towards"${s.title}" - great start!`,status:"completed",progress:25,reward:"Bronze Achievement",category:"bronze",points:50}),d>=50&&d<75&&a.push({id:`half-${s.id}`,goalId:s.id,type:"progress",icon:Pe,title:"Halfway Hero!",description:`Incredible! You're halfway to your"${s.title}" goal!`,status:"completed",progress:50,reward:"Silver Achievement",category:"silver",points:100}),d>=75&&d<100&&a.push({id:`three-quarter-${s.id}`,goalId:s.id,type:"progress",icon:ie,title:"Almost There!",description:`You're 75% done with"${s.title}" - the finish line is in sight!`,status:"completed",progress:75,reward:"Gold Achievement",category:"gold",points:150}),d<25?a.push({id:`upcoming-quarter-${s.id}`,goalId:s.id,type:"upcoming",icon:ke,title:"First Quarter Goal",description:`${(parseFloat(s.targetAmount)*.25-n).toLocaleString()} away from 25% completion`,status:"upcoming",progress:d,category:"bronze",points:50}):d<50?a.push({id:`upcoming-half-${s.id}`,goalId:s.id,type:"upcoming",icon:Pe,title:"Halfway Point",description:`${(parseFloat(s.targetAmount)*.5-n).toLocaleString()} away from 50% completion`,status:"upcoming",progress:d,category:"silver",points:100}):d<75?a.push({id:`upcoming-three-quarter-${s.id}`,goalId:s.id,type:"upcoming",icon:ie,title:"Three-Quarter Mark",description:`${(parseFloat(s.targetAmount)*.75-n).toLocaleString()} away from 75% completion`,status:"upcoming",progress:d,category:"gold",points:150}):d<100&&a.push({id:`upcoming-complete-${s.id}`,goalId:s.id,type:"upcoming",icon:Se,title:"Goal Completion",description:`${(parseFloat(s.targetAmount)-n).toLocaleString()} away from completing this goal!`,status:"upcoming",progress:d,category:"platinum",points:500})}),r.forEach(s=>{a.push({id:`completed-${s.id}`,goalId:s.id,type:"achievement",icon:Se,title:"Goal Conquered!",description:`Successfully completed"${s.title}" - amazing work!`,status:"completed",progress:100,reward:"Platinum Achievement",category:"platinum",points:500})}),v.length>=3&&a.push({id:"multi-goal-manager",type:"achievement",icon:Z,title:"Multi-Goal Manager",description:`Managing ${v.length} goals simultaneously - you're a pro!`,status:"completed",reward:"Gold Achievement",category:"gold",points:200}),r.length>=1&&a.push({id:"goal-achiever",type:"achievement",icon:je,title:"Goal Achiever",description:"Completed your first financial goal - you're building great habits!",status:"completed",reward:"Silver Achievement",category:"silver",points:150}),r.length>=5&&a.push({id:"goal-master",type:"achievement",icon:Tt,title:"Goal Master",description:"Completed 5+ goals - you're a financial planning expert!",status:"completed",reward:"Platinum Achievement",category:"platinum",points:1e3}),r.filter(s=>{if(!s.createdAt)return!1;const d=D(new Date,new Date(s.createdAt)),n=D(new Date(s.targetDate),new Date(s.createdAt));return d<n*.8}).length>0&&a.push({id:"speed-saver",type:"achievement",icon:xe,title:"Speed Saver",description:"Completed a goal ahead of schedule - excellent planning!",status:"completed",reward:"Gold Achievement",category:"gold",points:300}),a.sort((s,d)=>{if(s.status!==d.status){if(s.status==="completed")return-1;if(d.status==="completed")return 1;if(s.status==="in-progress")return-1;if(d.status==="in-progress")return 1}return d.points-s.points})})(),i=c.filter(a=>a.status==="completed").reduce((a,r)=>a+r.points,0),g=a=>{switch(a){case"completed":return"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/20";case"in-progress":return"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20";case"upcoming":return"border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-950/20";default:return"border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-950/20"}},f=a=>{switch(a){case"bronze":return"text-orange-600";case"silver":return"text-gray-600";case"gold":return"text-yellow-600";case"platinum":return"text-blue-600";default:return"text-gray-600"}},j=a=>{switch(a){case"bronze":return"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300";case"silver":return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300";case"gold":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300";case"platinum":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}};return c.length===0?e.jsxs(F,{children:[e.jsx(G,{children:e.jsxs(P,{className:"flex items-center",children:[e.jsx(ce,{className:"mr-2 h-5 w-5"}),"Achievement Milestones"]})}),e.jsx(T,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ie,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Start Your Journey"}),e.jsx("p",{className:"text-muted-foreground",children:"Create goals and start saving to unlock achievements and celebrate your progress!"})]})})]}):e.jsxs(F,{children:[e.jsx(G,{children:e.jsxs(P,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"mr-2 h-5 w-5"}),"Achievement Milestones"]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(C,{variant:"secondary",className:"flex items-center",children:[e.jsx(fe,{className:"mr-1 h-3 w-3"}),i," points"]})})]})}),e.jsxs(T,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.filter(a=>a.status==="completed").length}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"Unlocked"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.filter(a=>a.status==="in-progress").length}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"In Progress"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:c.filter(a=>a.status==="upcoming").length}),e.jsx("div",{className:"text-xs text-gray-600/70",children:"Upcoming"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i}),e.jsx("div",{className:"text-xs text-green-600/70",children:"Total Points"})]})]}),e.jsx("div",{className:"space-y-4",children:c.slice(0,8).map(a=>{var r;return e.jsx("div",{className:`p-4 rounded-lg border ${g(a.status)}`,"data-testid":`milestone-${a.id}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg ${a.status==="completed"?"bg-green-100 dark:bg-green-900/20":"bg-gray-100 dark:bg-gray-900/20"}`,children:e.jsx(a.icon,{className:`h-5 w-5 ${f(a.category)}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h4",{className:"font-medium",children:a.title}),e.jsx(C,{className:j(a.category),children:a.category}),a.status==="completed"&&e.jsx(je,{className:"h-4 w-4 text-green-600"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:a.description}),a.progress!==void 0&&a.status==="upcoming"&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(a.progress),"%"]})]}),e.jsx(ae,{value:a.progress,className:"h-2"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[a.points," points"]}),a.reward&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(Dt,{className:"h-3 w-3 mr-1"}),a.reward]})]}),a.status==="completed"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{size:"sm",variant:"outline",onClick:()=>m==null?void 0:m(a),"data-testid":`button-celebrate-${a.id}`,children:"Celebrate"}),e.jsx(Qt,{shareData:Yt({title:a.title,description:a.description,achievementType:a.type==="progress"?"milestone":"goal_completed",goalTitle:(r=t.find(v=>v.id===a.goalId))==null?void 0:r.title,progress:a.progress,category:a.category}),variant:"outline",size:"sm",showText:!1,achievement:!0,"data-testid":`button-share-${a.id}`})]})]})]})]})})},a.id)})}),c.length>8&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs(S,{variant:"ghost",size:"sm",className:"text-muted-foreground",children:["View ",c.length-8," More Milestones"]})})]})]})}function Jt({goalId:t,goalTitle:m,open:l,onOpenChange:c,children:i}){const[g,f]=k.useState(""),[j,a]=k.useState("view"),{toast:r}=me(),v=ye(),{data:o=[],isLoading:s}=W({queryKey:["/api/friends"]}),{data:d=[],isLoading:n}=W({queryKey:["/api/goals",t,"shares"]}),h=Y({mutationFn:x=>J("POST",`/api/goals/${t}/share`,x),onSuccess:()=>{v.invalidateQueries({queryKey:["/api/goals",t,"shares"]}),r({title:"Goal shared successfully",description:`${m} has been shared with your friend.`}),f("")},onError:x=>{r({title:"Failed to share goal",description:x.message||"Something went wrong",variant:"destructive"})}}),b=Y({mutationFn:x=>J("DELETE",`/api/goals/${t}/share/${x}`),onSuccess:()=>{v.invalidateQueries({queryKey:["/api/goals",t,"shares"]}),r({title:"Share removed",description:"Access has been revoked successfully."})},onError:x=>{r({title:"Failed to remove share",description:x.message||"Something went wrong",variant:"destructive"})}}),p=Y({mutationFn:({userId:x,permission:A})=>J("PATCH",`/api/goals/${t}/share/${x}`,{permission:A}),onSuccess:()=>{v.invalidateQueries({queryKey:["/api/goals",t,"shares"]}),r({title:"Permission updated",description:"Share permission has been updated successfully."})}}),u=()=>{if(!g){r({title:"No friend selected",description:"Please select a friend to share with.",variant:"destructive"});return}h.mutate({sharedWithUserId:g,permission:j})},N=(x,A)=>`${(x==null?void 0:x[0])||""}${(A==null?void 0:A[0])||""}`.toUpperCase()||"?",w=o.filter(x=>!d.some(A=>A.sharedWith.id===x.id));return e.jsxs(ne,{open:l,onOpenChange:c,children:[i&&e.jsx(dt,{asChild:!0,children:i}),e.jsxs(le,{className:"max-w-2xl max-h-[90vh]",children:[e.jsxs(qe,{children:[e.jsxs(ze,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5"}),"Share Goal: ",m]}),e.jsx(Ee,{children:"Share this financial goal with friends. Choose whether they can view only or contribute to the goal."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4 border-b pb-6",children:[e.jsx("h3",{className:"font-semibold text-sm",children:"Share with a Friend"}),s?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading friends..."}):w.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:o.length===0?"You don't have any friends to share with yet.":"All your friends already have access to this goal."}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs(H,{value:g,onValueChange:f,children:[e.jsx(K,{"data-testid":"select-friend",children:e.jsx(Q,{placeholder:"Select a friend"})}),e.jsx(_,{children:w.map(x=>e.jsxs(M,{value:x.id,children:[x.firstName," ",x.lastName," (",x.email,")"]},x.id))})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(H,{value:j,onValueChange:x=>a(x),children:[e.jsx(K,{className:"flex-1","data-testid":"select-permission",children:e.jsx(Q,{})}),e.jsxs(_,{children:[e.jsx(M,{value:"view",children:"View Only"}),e.jsx(M,{value:"contribute",children:"Can Contribute"})]})]}),e.jsx(S,{onClick:u,disabled:!g||h.isPending,"data-testid":"button-share-goal",children:h.isPending?"Sharing...":"Share"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"View Only:"})," Friend can see the goal and its progress"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Can Contribute:"})," Friend can add funds to help reach the goal"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-sm",children:"People with Access"}),n?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading shares..."}):d.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"This goal isn't shared with anyone yet."}):e.jsx(It,{className:"max-h-60",children:e.jsx("div",{className:"space-y-3",children:d.map(x=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50","data-testid":`share-item-${x.sharedWith.id}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs(mt,{className:"w-10 h-10",children:[e.jsx(ut,{src:x.sharedWith.profileImageUrl}),e.jsx(xt,{children:N(x.sharedWith.firstName,x.sharedWith.lastName)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium",children:[x.sharedWith.firstName," ",x.sharedWith.lastName]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:x.sharedWith.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(H,{value:x.permission,onValueChange:A=>p.mutate({userId:x.sharedWith.id,permission:A}),children:[e.jsx(K,{className:"w-32",children:e.jsx(Q,{})}),e.jsxs(_,{children:[e.jsx(M,{value:"view",children:"View Only"}),e.jsx(M,{value:"contribute",children:"Can Contribute"})]})]}),e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>b.mutate(x.sharedWith.id),disabled:b.isPending,"data-testid":`button-remove-share-${x.sharedWith.id}`,children:e.jsx(ht,{className:"w-4 h-4"})})]})]},x.id))})})]})]})]})]})}function Qe({value:t,prefix:m="$",delay:l=0}){const[c,i]=k.useState(0);return k.useEffect(()=>{const g=setTimeout(()=>{const a=t/60;let r=0;const v=setInterval(()=>{r+=a,r>=t?(i(t),clearInterval(v)):i(r)},1e3/60);return()=>clearInterval(v)},l);return()=>clearTimeout(g)},[t,l]),e.jsxs("span",{children:[m,Math.round(c).toLocaleString()]})}function _e({progress:t,size:m=120,strokeWidth:l=8,delay:c=0}){const[i,g]=k.useState(0),f=(m-l)/2,j=f*2*Math.PI,a=j-i/100*j;k.useEffect(()=>{const v=setTimeout(()=>{const d=t/60;let n=0;const h=setInterval(()=>{n+=d,n>=t?(g(t),clearInterval(h)):g(n)},1200/60);return()=>clearInterval(h)},c);return()=>clearTimeout(v)},[t,c]);const r=()=>i>=80?"stroke-green-500":i>=50?"stroke-primary":i>=25?"stroke-amber-500":"stroke-red-500";return e.jsxs("div",{className:"relative",style:{width:m,height:m},children:[e.jsxs("svg",{className:"transform -rotate-90",width:m,height:m,children:[e.jsx("circle",{className:"stroke-muted",strokeWidth:l,fill:"transparent",r:f,cx:m/2,cy:m/2}),e.jsx("circle",{className:`${r()} transition-all duration-300`,strokeWidth:l,strokeLinecap:"round",fill:"transparent",r:f,cx:m/2,cy:m/2,style:{strokeDasharray:j,strokeDashoffset:a}})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-xl sm:text-2xl font-bold",children:[Math.round(i),"%"]})})]})}function Zt({goalId:t}){const{data:m,isLoading:l}=W({queryKey:["/api/transactions",t],queryFn:()=>fetch(`/api/transactions?goalId=${t}&limit=5`).then(i=>i.json())});if(l)return e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Recent Contributions"}),e.jsx("div",{className:"space-y-2",children:[...Array(3)].map((i,g)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(L,{className:"h-3 w-20"}),e.jsx(L,{className:"h-2 w-32"})]}),e.jsx(L,{className:"h-4 w-16"})]},g))})]});const c=m||[];return e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Recent Contributions"}),c.length===0?e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(U,{className:"mx-auto h-8 w-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No contributions yet"}),e.jsx("p",{className:"text-xs",children:"Start adding funds or income to see contributions here"})]}):e.jsxs("div",{className:"space-y-2",children:[c.map((i,g)=>e.jsxs(R.div,{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:g*.1},children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`p-1.5 rounded-full ${i.type==="income"?"bg-green-100 dark:bg-green-900/20":"bg-blue-100 dark:bg-blue-900/20"}`,children:i.type==="income"?e.jsx(q,{className:`h-3 w-3 ${i.type==="income"?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"}`}):e.jsx(U,{className:`h-3 w-3 ${i.type==="income"?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"}`})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("p",{className:"text-sm font-medium",children:[i.type==="income"?"Income":"Transfer",i.category&&` - ${i.category}`]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:i.description||`${i.type==="income"?"Income":"Transfer"} contribution`}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[e.jsx(ve,{className:"h-3 w-3 mr-1"}),new Date(i.date).toLocaleDateString()]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:`font-semibold ${i.type==="income"?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"}`,children:["+$",parseFloat(i.amount).toLocaleString()]})})]},i.id)),c.length===5&&e.jsx("div",{className:"text-center py-2",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"Showing last 5 contributions"})})]})]})}function Xt({goal:t,onEdit:m,onDelete:l,onAddFunds:c,onViewDetails:i,onShare:g,delay:f=0}){const j=parseFloat(t.currentAmount)/parseFloat(t.targetAmount)*100,a=parseFloat(t.targetAmount)-parseFloat(t.currentAmount),r=Math.ceil((new Date(t.targetDate).getTime()-new Date().getTime())/(1e3*60*60*24)),v=()=>r<0?"text-red-600 dark:text-red-400":r<30?"text-amber-600 dark:text-amber-400":"text-green-600 dark:text-green-400",o=s=>{switch(s){case"active":return e.jsx(C,{className:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 border-0",children:"Active"});case"completed":return e.jsx(C,{className:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400 border-0",children:"Completed"});case"paused":return e.jsx(C,{className:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400 border-0",children:"Paused"});default:return e.jsx(C,{variant:"secondary",children:s})}};return e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:f},children:e.jsxs(F,{className:"group relative overflow-hidden border-border/40 hover:shadow-lg hover:border-border transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary/50 via-primary to-primary/50",style:{clipPath:`inset(0 ${100-Math.min(j,100)}% 0 0)`}}),e.jsx(G,{className:"pb-3 sm:pb-4 p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o(t.status),j>=100&&e.jsxs(C,{className:"bg-primary/10 text-primary border-0",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Goal Reached"]})]}),e.jsx(P,{className:"text-base sm:text-lg font-semibold truncate","data-testid":`text-goal-title-${t.id}`,title:t.title,children:t.title}),t.description&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground line-clamp-2 mt-1",title:t.description,children:t.description})]}),e.jsxs(Be,{children:[e.jsx(Ve,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity","data-testid":`button-goal-menu-${t.id}`,children:e.jsx(Mt,{size:16})})}),e.jsxs(Re,{align:"end",children:[e.jsxs(I,{onClick:m,children:[e.jsx(He,{size:16,className:"mr-2"}),"Edit Goal"]}),e.jsxs(I,{onClick:g,children:[e.jsx(de,{size:16,className:"mr-2"}),"Share with Friends"]}),e.jsxs(I,{className:"text-destructive",onClick:l,children:[e.jsx(Gt,{size:16,className:"mr-2"}),"Delete Goal"]})]})]})]})}),e.jsxs(T,{className:"p-4 sm:p-6 pt-0",children:[e.jsxs("div",{className:"flex items-center gap-4 sm:gap-6 mb-4 sm:mb-6",children:[e.jsx(_e,{progress:Math.min(j,100),size:80,strokeWidth:6,delay:f*1e3+200}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current"}),e.jsx("p",{className:"text-lg sm:text-xl font-bold text-primary",children:e.jsx(Qe,{value:parseFloat(t.currentAmount),delay:f*1e3+100})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Target"}),e.jsxs("p",{className:"text-sm font-medium",children:["$",parseFloat(t.targetAmount).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2.5 sm:p-3 rounded-lg bg-muted/50",children:[e.jsx(ue,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"Time Left"}),e.jsx("p",{className:`text-xs sm:text-sm font-semibold ${v()}`,children:r>0?`${r} days`:r===0?"Due today":"Overdue"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2.5 sm:p-3 rounded-lg bg-muted/50",children:[e.jsx(U,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"Remaining"}),e.jsxs("p",{className:"text-xs sm:text-sm font-semibold",children:["$",a.toLocaleString()]})]})]})]}),r>0&&a>0&&e.jsx("div",{className:"p-2.5 sm:p-3 rounded-lg bg-primary/5 border border-primary/10 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-primary"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Save ",e.jsxs("span",{className:"font-semibold text-foreground",children:["$",Math.ceil(a/r).toLocaleString(),"/day"]})," to reach your goal"]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{variant:"outline",size:"sm",className:"flex-1 text-xs h-9",onClick:c,"data-testid":`button-add-funds-${t.id}`,children:[e.jsx(oe,{className:"w-3.5 h-3.5 mr-1.5"}),"Add Funds"]}),e.jsx(S,{size:"sm",className:"flex-1 text-xs h-9",onClick:i,"data-testid":`button-view-details-${t.id}`,children:"View Details"})]})]})]})})}function ge({title:t,value:m,icon:l,colorClass:c,bgClass:i,delay:g=0,suffix:f=""}){return e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:g},children:e.jsx(F,{className:"border-border/40 hover:shadow-md transition-shadow",children:e.jsxs(T,{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[e.jsx("div",{className:`p-2 rounded-xl ${i}`,children:e.jsx(l,{className:`w-4 h-4 sm:w-5 sm:h-5 ${c}`})}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:t})]}),e.jsxs("p",{className:`text-xl sm:text-2xl md:text-3xl font-bold tracking-tight ${c}`,children:[e.jsx(Qe,{value:m,prefix:f?"":"$",delay:g*1e3}),f&&e.jsx("span",{className:"text-lg sm:text-xl text-muted-foreground/60",children:f})]})]})})})}function As(){const{t}=pt(),[m,l]=k.useState(!1),[c,i]=k.useState(!1),[g,f]=k.useState("overview");k.useEffect(()=>{new URLSearchParams(window.location.search).get("create")==="1"&&(l(!0),window.history.replaceState({},"","/financial-goals"))},[]);const[j,a]=k.useState(!1),[r,v]=k.useState(!1),[o,s]=k.useState(!1),[d,n]=k.useState(!1),[h,b]=k.useState(null),{toast:p}=me(),u=ye(),{data:N,isLoading:w}=W({queryKey:["/api/financial-goals"],queryFn:()=>fetch("/api/financial-goals").then(y=>y.json())}),x=N||[],A=Y({mutationFn:y=>J("DELETE",`/api/financial-goals/${y}`),onSuccess:()=>{u.invalidateQueries({queryKey:["/api/financial-goals"]}),p({title:"Goal deleted",description:"The financial goal has been successfully deleted.",icon:e.jsx(vt,{className:"h-5 w-5 text-green-600 dark:text-green-400"})})},onError:y=>{p({title:"Couldn't Delete Goal",description:y.message||"Something went wrong. Please try again.",variant:"destructive",icon:e.jsx(yt,{className:"h-5 w-5"})})}}),B=y=>{confirm("Are you sure you want to delete this goal?")&&A.mutate(y)},he=y=>{b(y),a(!0)},X=y=>{b(y),v(!0)},be=y=>{b(y),s(!0)},Je=y=>{b(y),n(!0)},Ze=(y,$)=>{switch(y){case"review-timeline":if($){const z=x.find(pe=>pe.id===$);z&&he(z)}break;case"quick-contribute":if($){const z=x.find(pe=>pe.id===$);z&&X(z)}else x.length>0&&X(x[0]);break;case"create-short-term":l(!0);break;default:p({title:"Coming Soon",description:"This feature will be available in a future update."})}},Xe=y=>{p({title:"Suggestion Noted",description:`We'll help you implement: ${y.title}`})},et=y=>{p({title:"Congratulations!",description:`You've unlocked: ${y.title}`})},tt=x.reduce((y,$)=>y+parseFloat($.currentAmount||0),0),st=x.filter(y=>y.status==="active").length,at=x.length>0?Math.round(x.reduce((y,$)=>{const z=parseFloat($.currentAmount||0)/parseFloat($.targetAmount||1)*100;return y+z},0)/x.length):0;return w?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border/40 sticky top-0 z-30",children:e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 py-6",children:[e.jsx(L,{className:"h-8 w-48 mb-2"}),e.jsx(L,{className:"h-4 w-64"})]})}),e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 py-8",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[...Array(3)].map((y,$)=>e.jsxs(F,{className:"p-6",children:[e.jsx(L,{className:"h-10 w-10 rounded-xl mb-3"}),e.jsx(L,{className:"h-4 w-24 mb-2"}),e.jsx(L,{className:"h-8 w-32"})]},$))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[...Array(6)].map((y,$)=>e.jsx(gt,{},$))})]})]}):e.jsxs("div",{className:"min-h-screen-mobile bg-background pb-20 md:pb-0",children:[e.jsx(Ae,{open:c,onOpenChange:i,children:e.jsx($e,{className:"max-h-[90vh]",children:e.jsxs("div",{className:"p-4 pb-6",children:[e.jsx(Ce,{className:"text-xl font-semibold mb-2",children:"Create Your First Goal"}),e.jsx(Fe,{className:"text-muted-foreground mb-4",children:"Start your financial journey by setting up your first savings goal"}),e.jsx(De,{onSuccess:()=>i(!1)})]})})}),e.jsx("header",{className:"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border/40 sticky top-0 z-30",children:e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 py-4 sm:py-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs(R.div,{className:"flex-1 min-w-0",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4},children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-semibold tracking-tight text-foreground",children:"Financial Goals"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5 sm:mt-1 hidden sm:block",children:"Track your savings progress and achieve your financial targets"})]}),e.jsx(R.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.2},children:e.jsxs(Ae,{open:m,onOpenChange:l,children:[e.jsx(ft,{asChild:!0,children:e.jsxs(S,{className:"shadow-sm min-h-[44px]","data-testid":"button-create-goal",children:[e.jsx(oe,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"New Goal"}),e.jsx("span",{className:"sm:hidden",children:"New"})]})}),e.jsx($e,{className:"max-h-[90vh]",children:e.jsxs("div",{className:"p-4 pb-6",children:[e.jsx(Ce,{className:"text-xl font-semibold mb-2",children:"Create New Goal"}),e.jsx(Fe,{className:"text-muted-foreground mb-4",children:"Set up a new financial goal to track your savings progress"}),e.jsx(De,{onSuccess:()=>l(!1)})]})})]})})]})})}),e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 py-4 sm:py-6 md:py-8",children:[e.jsxs(Nt,{value:g,onValueChange:f,className:"space-y-4 sm:space-y-6",children:[e.jsx(R.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(wt,{className:"grid w-full grid-cols-4 h-auto bg-muted/50",children:[e.jsxs(te,{value:"overview","data-testid":"tab-overview",className:"text-xs sm:text-sm min-h-[44px] py-2.5 sm:py-2 data-[state=active]:bg-background data-[state=active]:shadow-sm","aria-label":"Overview",children:[e.jsx(Z,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Overview"})]}),e.jsxs(te,{value:"analytics","data-testid":"tab-analytics",className:"text-xs sm:text-sm min-h-[44px] py-2.5 sm:py-2 data-[state=active]:bg-background data-[state=active]:shadow-sm","aria-label":"Analytics",children:[e.jsx(We,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Analytics"})]}),e.jsxs(te,{value:"insights","data-testid":"tab-insights",className:"text-xs sm:text-sm min-h-[44px] py-2.5 sm:py-2 data-[state=active]:bg-background data-[state=active]:shadow-sm","aria-label":"Insights",children:[e.jsx(Ye,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Insights"})]}),e.jsxs(te,{value:"achievements","data-testid":"tab-achievements",className:"text-xs sm:text-sm min-h-[44px] py-2.5 sm:py-2 data-[state=active]:bg-background data-[state=active]:shadow-sm","aria-label":"Achievements",children:[e.jsx(ce,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Achievements"})]})]})}),e.jsx(se,{value:"overview",className:"space-y-4 sm:space-y-6",children:x.length===0?e.jsx(bt,{illustration:"goals",title:"No Financial Goals Yet",description:"Create your first financial goal to start tracking your savings progress and build your future.",actionLabel:"Create Your First Goal",onAction:()=>i(!0),actionTestId:"button-create-first-goal"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsx(ge,{title:"Total Saved",value:tt,icon:Oe,colorClass:"text-green-600 dark:text-green-400",bgClass:"bg-green-100 dark:bg-green-900/30",delay:0}),e.jsx(ge,{title:"Active Goals",value:st,icon:Z,colorClass:"text-primary",bgClass:"bg-primary/10",delay:.1,suffix:""}),e.jsx(ge,{title:"Avg Progress",value:at,icon:q,colorClass:"text-blue-600 dark:text-blue-400",bgClass:"bg-blue-100 dark:bg-blue-900/30",delay:.2,suffix:"%"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:e.jsx(jt,{mode:"popLayout",children:x.map((y,$)=>e.jsx(Xt,{goal:y,onEdit:()=>he(y),onDelete:()=>B(y.id),onAddFunds:()=>X(y),onViewDetails:()=>be(y),onShare:()=>Je(y),delay:$*.1},y.id))})})]})}),e.jsx(se,{value:"analytics",className:"space-y-6",children:e.jsx(Vt,{goals:x,onGoalClick:be})}),e.jsx(se,{value:"insights",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Rt,{goals:x,onActionClick:Ze}),e.jsx(Ut,{goals:x,onImplementSuggestion:Xe})]})}),e.jsx(se,{value:"achievements",className:"space-y-6",children:e.jsx(_t,{goals:x,onCelebrate:et})})]}),e.jsx(ne,{open:j,onOpenChange:a,children:e.jsx(le,{className:"w-[95vw] max-w-2xl max-h-[90vh] overflow-y-auto",children:h&&e.jsx(Bt,{goal:h,onSuccess:()=>a(!1)})})}),e.jsx(ne,{open:r,onOpenChange:v,children:e.jsx(le,{className:"w-[95vw] max-w-md max-h-[90vh] overflow-y-auto",children:h&&e.jsx(St,{goalId:h.id,goalTitle:h.title,currentAmount:h.currentAmount,targetAmount:h.targetAmount,onSuccess:()=>v(!1)})})}),h&&e.jsx(Jt,{goalId:h.id,goalTitle:h.title,open:d,onOpenChange:n}),e.jsx(ne,{open:o,onOpenChange:s,children:e.jsx(le,{className:"w-[95vw] max-w-2xl max-h-[90vh] overflow-y-auto",children:h&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-1",children:h.title}),h.description&&e.jsx("p",{className:"text-muted-foreground text-sm",children:h.description})]}),e.jsx("div",{className:"flex items-center justify-center py-6",children:e.jsx(_e,{progress:Math.min(parseFloat(h.currentAmount)/parseFloat(h.targetAmount)*100,100),size:160,strokeWidth:12})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Current Amount"}),e.jsxs("p",{className:"text-xl font-bold text-green-600",children:["$",parseFloat(h.currentAmount).toLocaleString()]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Target Amount"}),e.jsxs("p",{className:"text-xl font-bold",children:["$",parseFloat(h.targetAmount).toLocaleString()]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Remaining"}),e.jsxs("p",{className:"text-xl font-bold",children:["$",(parseFloat(h.targetAmount)-parseFloat(h.currentAmount)).toLocaleString()]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Target Date"}),e.jsx("p",{className:"text-xl font-bold",children:new Date(h.targetDate).toLocaleDateString()})]})]}),e.jsx(Zt,{goalId:h.id}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(S,{variant:"outline",className:"flex-1",onClick:()=>he(h),children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),"Edit Goal"]}),e.jsxs(S,{className:"flex-1",onClick:()=>{s(!1),X(h)},children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Add Funds"]})]})]})})})]})]})}export{As as default};
