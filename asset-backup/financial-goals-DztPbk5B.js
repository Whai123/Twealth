import{c as B,r as A,q as he,ae as be,L as lt,M as ct,N as ot,z as K,B as Q,j as e,v as Oe,w as Le,x as Be,ak as L,Z as se,$ as _,a0 as J,a1 as Z,a2 as X,a3 as G,H as C,am as dt,a5 as U,a6 as V,O as $,Q as P,S as q,V as M,Y,J as ie,K as ee,y as W,aa as ke,aq as de,as as Ve,at as Re,au as Ue,av as I,ax as Ae,a7 as Se,s as ne,ap as mt,t as le,ay as ut,az as ht,aA as xt,X as pt,a8 as gt,aB as ft,a4 as yt,ab as z,aC as jt,aD as Ce,aE as De,aF as Fe,aG as $e,G as Te,aH as vt}from"./index-NNgTI0RQ.js";import{C as He,a as Me,E as bt}from"./addMonths-C4oyVVPj.js";import{B as F}from"./badge-D7Q8E7hz.js";import{T as Nt,a as wt,b as ae,c as re}from"./tabs-a-uRWqhW.js";import{T as kt}from"./textarea-CFY__GU9.js";import{A as At}from"./add-funds-form-GVHq_cWS.js";import{P as ce}from"./progress-COOXQNiG.js";import{C as Ye}from"./chart-column-CHgS_Ivl.js";import{d as St,f as Ct}from"./format-BI6KV3YQ.js";import{t as Ie}from"./startOfWeek-D6dzzDOw.js";import{C as Ne}from"./calendar-CwD0FHKB.js";import{T as E}from"./trending-up-BnP5NHLE.js";import{C as xe}from"./clock-QmJAeAa1.js";import{C as je}from"./circle-check-big-DIqrf9ZE.js";import{L as We}from"./lightbulb-DBIXkFLe.js";import{A as me}from"./award-cHD21S_y.js";import{d as Ge}from"./differenceInMonths-C41JoVav.js";import{Z as pe}from"./zap-jVm97dbR.js";import{P as Ke}from"./piggy-bank-Bku1OXn_.js";import{A as Dt}from"./arrow-right-l9D0Ocf3.js";import{S as ve}from"./sparkles-yxnOzOhM.js";import{S as ue}from"./share-2-BhmftWRX.js";import{S as Ft}from"./send-CxgCRlQP.js";import{M as $t}from"./mail-Ct9URLDv.js";import{C as Tt}from"./copy-CwyWwbxF.js";import{T as oe}from"./trophy-DkSOE-LA.js";import{G as Mt}from"./gift-DelZ40eJ.js";import{S as Pe}from"./star-DAdPyuou.js";import{R as It}from"./rocket-DI11t3VL.js";import{S as Gt}from"./scroll-area-BXgXk91y.js";import{m as H}from"./proxy-C8xz_zGI.js";import{A as Pt}from"./index-BV8oB33o.js";import{E as qt}from"./ellipsis-Darsu7If.js";import{T as zt}from"./trash-2-iBqgHWxY.js";import"./credit-card-BRwojsv2.js";import"./bell-B71JwlkR.js";import"./message-square-T3TIwvoE.js";import"./endOfMonth-AzK47_pP.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=B("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=B("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=B("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=B("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=B("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=B("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=B("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),Vt=ot({title:U().min(1,"Goal title is required"),description:U().optional(),targetAmount:U().min(1,"Target amount is required").refine(t=>!isNaN(parseFloat(t))&&parseFloat(t)>0,"Must be a valid positive number"),currentAmount:U().optional().refine(t=>!t||!isNaN(parseFloat(t))&&parseFloat(t)>=0,"Must be a valid positive number"),targetDate:U().min(1,"Target date is required"),category:U().optional(),priority:dt(["low","medium","high"]).default("medium")}),Rt=["emergency","house","vacation","car","education","retirement","investment","other"];function Ut({goal:t,onSuccess:l}){const[i,u]=A.useState(!1),{toast:n}=he(),d=be(),f=r=>r?new Date(r).toISOString().split("T")[0]:"",{register:j,handleSubmit:b,setValue:a,watch:o,formState:{errors:y}}=lt({resolver:ct(Vt),defaultValues:{title:(t==null?void 0:t.title)||"",description:(t==null?void 0:t.description)||"",targetAmount:(t==null?void 0:t.targetAmount)||"",currentAmount:(t==null?void 0:t.currentAmount)||"0",targetDate:f(t==null?void 0:t.targetDate),category:(t==null?void 0:t.category)||"",priority:(t==null?void 0:t.priority)||"medium"}}),m=K({mutationFn:r=>Q("PUT",`/api/financial-goals/${t.id}`,{...r,targetAmount:r.targetAmount,currentAmount:r.currentAmount||"0",targetDate:new Date(r.targetDate)}),onSuccess:()=>{d.invalidateQueries({queryKey:["/api/financial-goals"]}),d.invalidateQueries({queryKey:["/api/dashboard/stats"]}),d.invalidateQueries({queryKey:["/api/goal-milestones"]}),n({title:"Goal updated",description:"Your financial goal has been updated successfully."}),l==null||l()},onError:r=>{n({title:"Error",description:r.message,variant:"destructive"})},onSettled:()=>{u(!1)}}),s=r=>{if(new Date(r.targetDate)<=new Date){n({title:"Invalid date",description:"Target date must be in the future.",variant:"destructive"});return}const x=parseFloat(r.currentAmount||"0"),N=parseFloat(r.targetAmount);if(x>N){n({title:"Invalid amounts",description:"Current amount cannot exceed target amount.",variant:"destructive"});return}u(!0),m.mutate(r)};return e.jsxs(e.Fragment,{children:[e.jsxs(Oe,{children:[e.jsx(Le,{children:"Edit Financial Goal"}),e.jsx(Be,{children:"Update your goal details, target amount, or deadline"})]}),e.jsxs("form",{onSubmit:b(s),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(L,{htmlFor:"title",children:"Goal Title"}),e.jsx(se,{id:"title",...j("title"),placeholder:"e.g., Emergency Fund, Vacation, House Down Payment","data-testid":"input-edit-goal-title"}),y.title&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:y.title.message})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"description",children:"Description (Optional)"}),e.jsx(kt,{id:"description",...j("description"),placeholder:"Describe your goal and why it's important to you",rows:3,"data-testid":"input-edit-goal-description"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{htmlFor:"targetAmount",children:"Target Amount ($)"}),e.jsx(se,{id:"targetAmount",type:"number",step:"0.01",min:"0",...j("targetAmount"),placeholder:"10000","data-testid":"input-edit-goal-target-amount"}),y.targetAmount&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:y.targetAmount.message})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"currentAmount",children:"Current Amount ($)"}),e.jsx(se,{id:"currentAmount",type:"number",step:"0.01",min:"0",...j("currentAmount"),placeholder:"0","data-testid":"input-edit-goal-current-amount"}),y.currentAmount&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:y.currentAmount.message})]})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"targetDate",children:"Target Date"}),e.jsx(se,{id:"targetDate",type:"date",...j("targetDate"),"data-testid":"input-edit-goal-target-date"}),y.targetDate&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:y.targetDate.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{htmlFor:"category",children:"Category"}),e.jsxs(_,{value:o("category")||"",onValueChange:r=>a("category",r||void 0),children:[e.jsx(J,{"data-testid":"select-edit-goal-category",children:e.jsx(Z,{placeholder:"Select category"})}),e.jsx(X,{children:Rt.map(r=>e.jsx(G,{value:r,children:r.charAt(0).toUpperCase()+r.slice(1)},r))})]})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"priority",children:"Priority"}),e.jsxs(_,{value:o("priority"),onValueChange:r=>a("priority",r),children:[e.jsx(J,{"data-testid":"select-edit-goal-priority",children:e.jsx(Z,{})}),e.jsxs(X,{children:[e.jsx(G,{value:"low",children:"Low"}),e.jsx(G,{value:"medium",children:"Medium"}),e.jsx(G,{value:"high",children:"High"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(C,{type:"button",variant:"outline",onClick:l,"data-testid":"button-cancel-edit",children:"Cancel"}),e.jsx(C,{type:"submit",disabled:i,"data-testid":"button-save-goal",children:i?"Saving...":"Save Changes"})]})]})]})}function T(t,l){const i=Ie(t),u=Ie(l),n=Ee(i,u),d=Math.abs(St(i,u));i.setDate(i.getDate()-n*d);const f=+(Ee(i,u)===-n),j=n*(d-f);return j===0?0:j}function Ee(t,l){const i=t.getFullYear()-l.getFullYear()||t.getMonth()-l.getMonth()||t.getDate()-l.getDate()||t.getHours()-l.getHours()||t.getMinutes()-l.getMinutes()||t.getSeconds()-l.getSeconds()||t.getMilliseconds()-l.getMilliseconds();return i<0?-1:i>0?1:i}function Ht({goals:t,onGoalClick:l}){const{formatAmount:i}=V(),u=A.useMemo(()=>t.filter(s=>s.status==="active"),[t]),n=A.useMemo(()=>t.filter(s=>s.status==="completed"),[t]),{totalSaved:d,totalTargets:f,overallProgress:j}=A.useMemo(()=>{const s=t.reduce((N,p)=>N+parseFloat(p.currentAmount),0),r=t.reduce((N,p)=>N+parseFloat(p.targetAmount),0),x=r>0?s/r*100:0;return{totalSaved:s,totalTargets:r,overallProgress:x}},[t]),b=s=>{if(!s.createdAt)return 0;const r=T(new Date,new Date(s.createdAt));return r<=0?0:parseFloat(s.currentAmount)/r},a=s=>{const r=b(s);if(r<=0)return null;const x=parseFloat(s.targetAmount)-parseFloat(s.currentAmount),N=Math.ceil(x/r),p=new Date;return p.setDate(p.getDate()+N),p},o=s=>{const r=parseFloat(s.currentAmount)/parseFloat(s.targetAmount)*100,x=T(new Date(s.targetDate),new Date),N=b(s),p=a(s);return r>=100?{type:"success",label:"Completed",icon:je,color:"text-green-600"}:x<0?{type:"danger",label:"Overdue",icon:ie,color:"text-red-600"}:p&&p>new Date(s.targetDate)?{type:"warning",label:"At Risk",icon:ie,color:"text-yellow-600"}:r>=80?{type:"success",label:"On Track",icon:E,color:"text-green-600"}:N>0?{type:"info",label:"Building",icon:E,color:"text-blue-600"}:{type:"neutral",label:"Getting Started",icon:ee,color:"text-gray-600"}},y=()=>{const s=u.reduce((r,x)=>{const N=x.category||"other";return r[N]||(r[N]={totalTarget:0,totalSaved:0,count:0}),r[N].totalTarget+=parseFloat(x.targetAmount),r[N].totalSaved+=parseFloat(x.currentAmount),r[N].count+=1,r},{});return Object.entries(s).map(([r,x])=>({category:r,progress:x.totalTarget>0?x.totalSaved/x.totalTarget*100:0,saved:x.totalSaved,target:x.totalTarget,count:x.count}))},m=A.useMemo(()=>y(),[u]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{className:"bg-white dark:bg-gray-900 border-blue-200 dark:border-blue-800",children:[e.jsx(P,{className:"pb-3",children:e.jsxs(q,{className:"flex items-center text-blue-900 dark:text-blue-100",children:[e.jsx(He,{className:"mr-2 h-5 w-5"}),"Portfolio Overview"]})}),e.jsxs(M,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:u.length}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"Active Goals"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.length}),e.jsx("div",{className:"text-xs text-green-600/70",children:"Completed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i(d)}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"Total Saved"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(j),"%"]}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"Overall Progress"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Portfolio Progress"}),e.jsxs("span",{children:[i(d)," of ",i(f)]})]}),e.jsx(ce,{value:j,className:"h-3"})]})]})]}),m.length>0&&e.jsxs($,{children:[e.jsx(P,{children:e.jsxs(q,{className:"flex items-center",children:[e.jsx(Ye,{className:"mr-2 h-5 w-5"}),"Category Performance"]})}),e.jsx(M,{children:e.jsx("div",{className:"space-y-4",children:m.map(({category:s,progress:r,saved:x,target:N,count:p})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium capitalize",children:s}),e.jsxs(F,{variant:"secondary",className:"text-xs",children:[p," goals"]})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[i(x)," / ",i(N)]})]}),e.jsx(ce,{value:r,className:"h-2"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[Math.round(r),"% complete"]})]},s))})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Goal Analytics"}),u.map(s=>{const r=parseFloat(s.currentAmount)/parseFloat(s.targetAmount)*100,x=o(s),N=b(s),p=a(s),g=T(new Date(s.targetDate),new Date),c=g>0?(parseFloat(s.targetAmount)-parseFloat(s.currentAmount))/(g/30):0;return e.jsx($,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>l==null?void 0:l(s),"data-testid":`card-goal-analytics-${s.id}`,children:e.jsxs(M,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-lg mb-1 truncate",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(x.icon,{className:`h-4 w-4 mr-1 ${x.color}`}),e.jsx("span",{className:x.color,children:x.label})]}),s.category&&e.jsx(F,{variant:"outline",className:"capitalize",children:s.category})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold",children:i(parseFloat(s.currentAmount))}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["of ",i(parseFloat(s.targetAmount))]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(r),"%"]})]}),e.jsx(ce,{value:r,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[g," days"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"remaining"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i(N)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"daily rate"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Y,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i(c)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"monthly needed"})]})]}),p&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:Ct(p,"MMM dd")}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"projected"})]})]})]}),x.type==="warning"&&e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-950/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(ie,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Goal at risk"}),e.jsx("div",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:"Current pace may not meet target date. Consider increasing contributions."})]})]})})]})]})},s.id)})]})]})}function Yt({goals:t,onActionClick:l}){const{formatAmount:i}=V(),{data:u}=W({queryKey:["/api/transactions"],queryFn:()=>fetch("/api/transactions").then(o=>o.json())}),n=t.filter(o=>o.status==="active"),d=t.filter(o=>o.status==="completed"),j=(()=>{const o=[];d.length>0&&o.push({id:"completion-celebration",type:"achievement",icon:me,title:`${d.length} Goal${d.length>1?"s":""} Completed!`,description:`You've successfully completed ${d.length} financial goal${d.length>1?"s":""}. Your dedication is paying off!`,priority:1});const y=n.filter(g=>{const c=T(new Date(g.targetDate),new Date),w=parseFloat(g.currentAmount)/parseFloat(g.targetAmount)*100,h=c/30,S=h>0?(parseFloat(g.targetAmount)-parseFloat(g.currentAmount))/h:1/0;return c<60&&w<80&&S>1e3});y.length>0&&o.push({id:"goals-need-attention",type:"warning",icon:ie,title:"Goals Need Attention",description:`${y.length} goal${y.length>1?"s are":" is"} at risk of missing target dates. Consider adjusting timelines or increasing contributions.`,action:"review-timeline",goalId:y[0].id,priority:2});const m=n.filter(g=>{const c=parseFloat(g.currentAmount)/parseFloat(g.targetAmount)*100,w=T(new Date(g.targetDate),new Date),h=g.createdAt?(1-w/T(new Date(g.targetDate),new Date(g.createdAt)))*100:0;return c>h+20&&c>=30});if(m.length>0&&o.push({id:"excellent-progress",type:"success",icon:E,title:"Excellent Progress!",description:`You're ahead of schedule on ${m.length} goal${m.length>1?"s":""}. Keep up the great work!`,priority:3}),u&&u.length>0){const g=u.filter(h=>h.type==="income"&&new Date(h.date)>=Me(new Date,-1)).reduce((h,S)=>h+parseFloat(S.amount),0),c=u.filter(h=>h.type==="expense"&&new Date(h.date)>=Me(new Date,-1)).reduce((h,S)=>h+parseFloat(S.amount),0),w=g-c;w>500&&n.length>0&&o.push({id:"savings-opportunity",type:"info",icon:Y,title:"Savings Opportunity Identified",description:`Based on your income patterns, you could potentially save an additional ${i(w)} monthly towards your goals.`,action:"optimize-budget",priority:4})}const s=new Set(n.map(g=>g.category).filter(Boolean));n.length>=3&&s.size===1&&o.push({id:"diversify-goals",type:"info",icon:He,title:"Consider Goal Diversification",description:"All your goals are in the same category. Consider diversifying across emergency funds, investments, and lifestyle goals.",action:"diversify-portfolio",priority:5});const r=n.filter(g=>Ge(new Date(g.targetDate),new Date)<=12),x=n.filter(g=>Ge(new Date(g.targetDate),new Date)>12);return r.length===0&&x.length>0&&o.push({id:"need-short-term-goals",type:"info",icon:xe,title:"Consider Short-term Goals",description:"Having some short-term goals (under 1 year) can help maintain motivation and create quick wins.",action:"create-short-term",priority:6}),((u==null?void 0:u.filter(g=>g.goalId&&n.some(c=>c.id===g.goalId)))||[]).filter(g=>T(new Date,new Date(g.date))<=7).length===0&&n.length>0&&o.push({id:"maintain-momentum",type:"info",icon:pe,title:"Maintain Your Momentum",description:"No contributions to goals this week. Small, consistent contributions lead to big results!",action:"quick-contribute",priority:7}),o.sort((g,c)=>g.priority-c.priority)})(),b=o=>{switch(o){case"success":return"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/20";case"warning":return"border-yellow-200 dark:border-yellow-800 bg-yellow-50 dark:bg-yellow-950/20";case"achievement":return"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20";default:return"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20"}},a=o=>{switch(o){case"success":return"text-green-600";case"warning":return"text-yellow-600";case"achievement":return"text-blue-600";default:return"text-blue-600"}};return j.length===0?e.jsxs($,{children:[e.jsx(P,{children:e.jsxs(q,{className:"flex items-center",children:[e.jsx(ke,{className:"mr-2 h-5 w-5"}),"Smart Insights"]})}),e.jsx(M,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(We,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Building Your Profile"}),e.jsx("p",{className:"text-muted-foreground",children:"Create some goals and start saving to unlock personalized insights and recommendations."})]})})]}):e.jsxs($,{children:[e.jsx(P,{children:e.jsxs(q,{className:"flex items-center",children:[e.jsx(ke,{className:"mr-2 h-5 w-5"}),"Smart Insights"]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4",children:[j.slice(0,5).map(o=>e.jsx("div",{className:`p-4 rounded-lg border ${b(o.type)}`,"data-testid":`insight-${o.id}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx(o.icon,{className:`h-5 w-5 mt-0.5 ${a(o.type)}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium mb-1",children:o.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o.description})]})]}),o.action&&e.jsx(C,{size:"sm",variant:"outline",onClick:()=>l==null?void 0:l(o.action,o.goalId),"data-testid":`button-insight-action-${o.id}`,className:"ml-4 shrink-0",children:"Take Action"})]})},o.id)),j.length>5&&e.jsx("div",{className:"text-center pt-2",children:e.jsxs(C,{variant:"ghost",size:"sm",className:"text-muted-foreground",children:["View ",j.length-5," More Insights"]})})]})})]})}function Wt({goals:t,onImplementSuggestion:l}){const{formatAmount:i}=V(),[u,n]=A.useState("all"),{data:d}=W({queryKey:["/api/transactions"],queryFn:()=>fetch("/api/transactions").then(m=>m.json())}),f=t.filter(m=>m.status==="active"),b=(()=>{const m=[];if(!d||d.length===0)return[];const s=d.filter(c=>T(new Date,new Date(c.date))<=30),r=s.filter(c=>c.type==="income").reduce((c,w)=>c+parseFloat(w.amount),0),x=s.filter(c=>c.type==="expense").reduce((c,w)=>c+parseFloat(w.amount),0),N=s.filter(c=>c.type==="expense"&&["entertainment","dining","shopping","subscriptions"].includes(c.category||"")).reduce((c,w)=>c+parseFloat(w.amount),0);if(x>0){const c=s.filter(w=>w.type==="expense").length*.5;m.push({id:"round-up-savings",type:"automation",title:"Round-Up Savings",description:`Automatically round up purchases and save the change. Based on your spending, this could save ~${i(c)} monthly.`,impact:`+${i(c*12)} annually`,difficulty:"easy",timeToSee:"1 week",monthlyIncrease:c,annualIncrease:c*12,confidence:95,actionButton:"Enable Round-Up"})}if(N>200){const c=N*.15;m.push({id:"reduce-discretionary",type:"optimization",title:"Optimize Discretionary Spending",description:`Reducing entertainment and dining expenses by 15% could free up ${i(c)} monthly for goals.`,impact:`+${i(c*12)} annually`,difficulty:"medium",timeToSee:"2 weeks",monthlyIncrease:c,annualIncrease:c*12,confidence:80,actionButton:"Set Spending Limits"})}if(f.forEach(c=>{const w=parseFloat(c.currentAmount)/parseFloat(c.targetAmount)*100,h=T(new Date(c.targetDate),new Date),S=h/30,k=S>0?(parseFloat(c.targetAmount)-parseFloat(c.currentAmount))/S:0;if(w<50&&h>30&&k<r*.3){const R=Math.min(k*1.2,r*.1);m.push({id:`increase-${c.id}`,type:"amount",goalId:c.id,title:`Accelerate"${c.title}"`,description:`Increase monthly contributions by ${i(R)} to complete this goal ${Math.ceil(R/k*30)} days earlier.`,impact:`Goal completion ${Math.ceil(R/k*30)} days sooner`,difficulty:"easy",timeToSee:"1 month",monthlyIncrease:R,confidence:85,actionButton:"Increase Contribution"})}w<25&&h>60&&m.push({id:`automate-${c.id}`,type:"automation",goalId:c.id,title:`Automate"${c.title}" Savings`,description:`Set up automatic weekly transfers of ${i(k/4)} to stay on track without thinking about it.`,impact:"Consistent progress without manual effort",difficulty:"easy",timeToSee:"Immediate",monthlyIncrease:k,confidence:90,actionButton:"Set Up Automation"})}),r>0&&r<8e3&&m.push({id:"income-optimization",type:"optimization",title:"Explore Income Opportunities",description:"Consider side hustles, skill development, or asking for a raise to accelerate your savings goals.",impact:"Potentially +20-50% income",difficulty:"hard",timeToSee:"3-6 months",confidence:60,actionButton:"Explore Options"}),!f.some(c=>c.category==="emergency"||c.title.toLowerCase().includes("emergency"))&&x>0){const c=x*3;m.push({id:"emergency-fund",type:"optimization",title:"Create Emergency Fund Goal",description:`Build a safety net of ${i(c)} (3 months of expenses) before focusing on other goals.`,impact:"Financial security and peace of mind",difficulty:"medium",timeToSee:"6-12 months",confidence:95,actionButton:"Create Emergency Fund"})}const g=t.reduce((c,w)=>c+parseFloat(w.currentAmount),0);return g>5e3&&m.push({id:"high-yield-savings",type:"optimization",title:"Optimize Savings Account",description:`With ${i(g)} saved, switching to a high-yield account could earn an extra ${i(g*.04)} annually.`,impact:`+${i(g*.04)} annually in interest`,difficulty:"easy",timeToSee:"1 month",annualIncrease:g*.04,confidence:85,actionButton:"Find Better Rates"}),m.sort((c,w)=>w.confidence-c.confidence)})(),a=u==="all"?b:b.filter(m=>m.type===u),o=m=>{switch(m){case"easy":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300";case"hard":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},y=m=>{switch(m){case"amount":return Y;case"frequency":return Ne;case"automation":return pe;case"optimization":return E;default:return ee}};return b.length===0?e.jsxs($,{children:[e.jsx(P,{children:e.jsxs(q,{className:"flex items-center",children:[e.jsx(qe,{className:"mr-2 h-5 w-5"}),"AI Savings Suggestions"]})}),e.jsx(M,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ke,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Building Recommendations"}),e.jsx("p",{className:"text-muted-foreground",children:"Add some transactions and goals to unlock personalized savings strategies."})]})})]}):e.jsxs($,{children:[e.jsx(P,{children:e.jsxs(q,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(qe,{className:"mr-2 h-5 w-5"}),"AI Savings Suggestions"]}),e.jsxs(F,{variant:"secondary",className:"flex items-center",children:[e.jsx(de,{className:"mr-1 h-3 w-3"}),b.length," suggestions"]})]})}),e.jsxs(M,{children:[e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:[{id:"all",label:"All Suggestions"},{id:"automation",label:"Automation"},{id:"amount",label:"Amounts"},{id:"optimization",label:"Optimization"}].map(m=>e.jsx(C,{variant:u===m.id?"default":"outline",size:"sm",onClick:()=>n(m.id),"data-testid":`filter-${m.id}`,children:m.label},m.id))}),e.jsx("div",{className:"space-y-4",children:a.slice(0,6).map(m=>{const s=y(m.type);return e.jsx("div",{className:"p-4 border rounded-lg hover:shadow-sm transition-shadow","data-testid":`suggestion-${m.id}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(s,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h4",{className:"font-medium",children:m.title}),e.jsx(F,{className:o(m.difficulty),children:m.difficulty}),e.jsxs(F,{variant:"outline",className:"text-xs",children:[m.confidence,"% confidence"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:m.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"h-4 w-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Impact:"}),e.jsx("div",{className:"text-green-600",children:m.impact})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(xe,{className:"h-4 w-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Timeline:"}),e.jsx("div",{className:"text-blue-600",children:m.timeToSee})]})]})]})]})]}),e.jsxs(C,{onClick:()=>l==null?void 0:l(m),className:"ml-4 shrink-0","data-testid":`button-implement-${m.id}`,children:[m.actionButton,e.jsx(Dt,{className:"ml-2 h-4 w-4"})]})]})},m.id)})}),a.length>6&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs(C,{variant:"ghost",size:"sm",className:"text-muted-foreground",children:["View ",a.length-6," More Suggestions"]})})]})]})}const Kt=t=>{var f;const l=t.url||window.location.href,i=encodeURIComponent(l),u=encodeURIComponent(t.title),n=encodeURIComponent(t.description),d=((f=t.hashtags)==null?void 0:f.join(","))||"Twealth,FinancialGoals,AI";return{twitter:`https://twitter.com/intent/tweet?text=${u}&url=${i}&hashtags=${d}${t.via?`&via=${t.via}`:""}`,facebook:`https://www.facebook.com/sharer/sharer.php?u=${i}&quote=${u}`,linkedin:`https://www.linkedin.com/sharing/share-offsite/?url=${i}&title=${u}&summary=${n}`,whatsapp:`https://wa.me/?text=${u}%20${i}`,telegram:`https://t.me/share/url?url=${i}&text=${u}`,email:`mailto:?subject=${u}&body=${n}%20${i}`,copy:l}},Qt=t=>{const{achievementType:l,value:i,goalTitle:u,category:n,progress:d}=t,f={bronze:"Bronze",silver:"Silver",gold:"Gold",platinum:"Platinum"}[n||"bronze"];switch(l){case"milestone":return{title:`${f} Achievement unlocked! ${d}% progress towards "${u}"`,description:`I'm making great progress on my financial goals with Twealth's AI assistant! ${d}% closer to achieving "${u}". Join me on this journey to financial success!`,hashtags:["FinancialGoals","Achievement","Savings","TwealthAI","MoneyGoals"],via:"TwealthApp"};case"goal_completed":return{title:`Goal achieved! I just completed "${u}" with Twealth!`,description:`Another financial goal conquered! Just saved ${i} for "${u}" using Twealth's AI-powered financial planning. Ready to tackle the next one!`,hashtags:["GoalAchieved","FinancialSuccess","Savings","TwealthAI","MoneyWins"],via:"TwealthApp"};case"streak":return{title:`${i}-day savings streak! Consistency is key!`,description:`I've been consistently saving towards my goals for ${i} days straight using Twealth! The AI insights make it so much easier to stay on track.`,hashtags:["SavingsStreak","Consistency","FinancialHabits","TwealthAI","MoneyMotivation"],via:"TwealthApp"};case"ai_insight":return{title:`AI-powered insight: "${t.title}"`,description:`Twealth's AI just gave me this brilliant financial insight: "${t.description}" These personalized tips are game-changers for my money management!`,hashtags:["AIInsights","SmartMoney","FinancialTips","TwealthAI","MoneyHacks"],via:"TwealthApp"};default:return{title:"Making progress with Twealth!",description:"I'm using Twealth's AI-powered financial planning to achieve my goals! The insights and tracking make saving so much easier.",hashtags:["FinancialGoals","TwealthAI","MoneyManagement"],via:"TwealthApp"}}},_t=(t,l)=>{const i=Kt(l);switch(t){case"copy":return navigator.clipboard.writeText(i.copy),{success:!0,message:"Link copied to clipboard!"};case"email":return window.location.href=i.email,{success:!0,message:"Email client opened"};default:const u=i[t];return u&&typeof u=="string"?(window.open(u,"_blank","noopener,noreferrer,width=600,height=400"),{success:!0,message:`Shared to ${t}`}):{success:!1,message:"Platform not supported"}}},_e=()=>typeof navigator<"u"&&"share"in navigator,Jt=async t=>{if(_e())try{return await navigator.share({title:t.title,text:t.description,url:t.url||window.location.href}),{success:!0,message:"Shared successfully!"}}catch{}const l=`${t.title}

${t.description}

${t.url||window.location.href}`;return await navigator.clipboard.writeText(l),{success:!0,message:"Content copied to clipboard!"}};function Zt({shareData:t,variant:l="outline",size:i="default",showText:u=!0,achievement:n=!1,className:d=""}){const[f,j]=A.useState(!1),{toast:b}=he(),a=async y=>{j(!0);try{const m=await _t(y,t);m.success?b({title:"Shared successfully!",description:m.message}):b({title:"Share failed",description:m.message,variant:"destructive"})}catch{b({title:"Share failed",description:"Something went wrong. Please try again.",variant:"destructive"})}finally{j(!1)}},o=async()=>{j(!0);try{const y=await Jt(t);b({title:"Shared successfully",description:y.message})}catch{b({title:"Share failed",description:"Something went wrong. Please try again.",variant:"destructive"})}finally{j(!1)}};return _e()?e.jsxs(C,{onClick:o,variant:l,size:i,disabled:f,className:`${n?"bg-primary text-primary-foreground border-0":""} ${d}`,"data-testid":"button-native-share",children:[n&&e.jsx(ve,{className:"w-4 h-4 mr-2"}),e.jsx(ue,{className:"w-4 h-4 mr-2"}),u&&(n?"Share Achievement":"Share")]}):e.jsxs(Ve,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(C,{variant:l,size:i,disabled:f,className:`${n?"bg-primary text-primary-foreground border-0":""} ${d}`,"data-testid":"button-share-dropdown",children:[n&&e.jsx(ve,{className:"w-4 h-4 mr-2"}),e.jsx(ue,{className:"w-4 h-4 mr-2"}),u&&(n?"Share Achievement":"Share")]})}),e.jsx(Ue,{align:"end",className:"w-48",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Share to social media"}),e.jsxs(I,{onClick:()=>a("twitter"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-twitter",children:[e.jsx(Bt,{className:"w-4 h-4 text-blue-500"}),"Twitter"]}),e.jsxs(I,{onClick:()=>a("facebook"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-facebook",children:[e.jsx(Et,{className:"w-4 h-4 text-blue-600"}),"Facebook"]}),e.jsxs(I,{onClick:()=>a("linkedin"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-linkedin",children:[e.jsx(Ot,{className:"w-4 h-4 text-blue-700"}),"LinkedIn"]}),e.jsx(Ae,{}),e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2 mt-2",children:"Share via messaging"}),e.jsxs(I,{onClick:()=>a("whatsapp"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-whatsapp",children:[e.jsx(Lt,{className:"w-4 h-4 text-green-500"}),"WhatsApp"]}),e.jsxs(I,{onClick:()=>a("telegram"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-telegram",children:[e.jsx(Ft,{className:"w-4 h-4 text-blue-400"}),"Telegram"]}),e.jsxs(I,{onClick:()=>a("email"),className:"flex items-center gap-2 cursor-pointer","data-testid":"share-email",children:[e.jsx($t,{className:"w-4 h-4 text-gray-600"}),"Email"]}),e.jsx(Ae,{}),e.jsxs(I,{onClick:()=>a("copy"),className:"flex items-center gap-2 cursor-pointer font-medium","data-testid":"share-copy",children:[e.jsx(Tt,{className:"w-4 h-4"}),"Copy Link"]})]})})]})}function Xt({goals:t,onCelebrate:l}){const{formatAmount:i}=V(),n=(()=>{const a=[],o=t.filter(s=>s.status==="completed"),y=t.filter(s=>s.status==="active");return y.forEach(s=>{const r=parseFloat(s.currentAmount)/parseFloat(s.targetAmount)*100,x=parseFloat(s.currentAmount);r>=25&&r<50&&a.push({id:`quarter-${s.id}`,goalId:s.id,type:"progress",icon:Pe,title:"Quarter Way There!",description:`You've saved 25% towards"${s.title}" - great start!`,status:"completed",progress:25,reward:"Bronze Achievement",category:"bronze",points:50}),r>=50&&r<75&&a.push({id:`half-${s.id}`,goalId:s.id,type:"progress",icon:ze,title:"Halfway Hero!",description:`Incredible! You're halfway to your"${s.title}" goal!`,status:"completed",progress:50,reward:"Silver Achievement",category:"silver",points:100}),r>=75&&r<100&&a.push({id:`three-quarter-${s.id}`,goalId:s.id,type:"progress",icon:oe,title:"Almost There!",description:`You're 75% done with"${s.title}" - the finish line is in sight!`,status:"completed",progress:75,reward:"Gold Achievement",category:"gold",points:150}),r<25?a.push({id:`upcoming-quarter-${s.id}`,goalId:s.id,type:"upcoming",icon:Pe,title:"First Quarter Goal",description:`${i(parseFloat(s.targetAmount)*.25-x)} away from 25% completion`,status:"upcoming",progress:r,category:"bronze",points:50}):r<50?a.push({id:`upcoming-half-${s.id}`,goalId:s.id,type:"upcoming",icon:ze,title:"Halfway Point",description:`${i(parseFloat(s.targetAmount)*.5-x)} away from 50% completion`,status:"upcoming",progress:r,category:"silver",points:100}):r<75?a.push({id:`upcoming-three-quarter-${s.id}`,goalId:s.id,type:"upcoming",icon:oe,title:"Three-Quarter Mark",description:`${i(parseFloat(s.targetAmount)*.75-x)} away from 75% completion`,status:"upcoming",progress:r,category:"gold",points:150}):r<100&&a.push({id:`upcoming-complete-${s.id}`,goalId:s.id,type:"upcoming",icon:Se,title:"Goal Completion",description:`${i(parseFloat(s.targetAmount)-x)} away from completing this goal!`,status:"upcoming",progress:r,category:"platinum",points:500})}),o.forEach(s=>{a.push({id:`completed-${s.id}`,goalId:s.id,type:"achievement",icon:Se,title:"Goal Conquered!",description:`Successfully completed"${s.title}" - amazing work!`,status:"completed",progress:100,reward:"Platinum Achievement",category:"platinum",points:500})}),y.length>=3&&a.push({id:"multi-goal-manager",type:"achievement",icon:ee,title:"Multi-Goal Manager",description:`Managing ${y.length} goals simultaneously - you're a pro!`,status:"completed",reward:"Gold Achievement",category:"gold",points:200}),o.length>=1&&a.push({id:"goal-achiever",type:"achievement",icon:je,title:"Goal Achiever",description:"Completed your first financial goal - you're building great habits!",status:"completed",reward:"Silver Achievement",category:"silver",points:150}),o.length>=5&&a.push({id:"goal-master",type:"achievement",icon:It,title:"Goal Master",description:"Completed 5+ goals - you're a financial planning expert!",status:"completed",reward:"Platinum Achievement",category:"platinum",points:1e3}),o.filter(s=>{if(!s.createdAt)return!1;const r=T(new Date,new Date(s.createdAt)),x=T(new Date(s.targetDate),new Date(s.createdAt));return r<x*.8}).length>0&&a.push({id:"speed-saver",type:"achievement",icon:pe,title:"Speed Saver",description:"Completed a goal ahead of schedule - excellent planning!",status:"completed",reward:"Gold Achievement",category:"gold",points:300}),a.sort((s,r)=>{if(s.status!==r.status){if(s.status==="completed")return-1;if(r.status==="completed")return 1;if(s.status==="in-progress")return-1;if(r.status==="in-progress")return 1}return r.points-s.points})})(),d=n.filter(a=>a.status==="completed").reduce((a,o)=>a+o.points,0),f=a=>{switch(a){case"completed":return"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/20";case"in-progress":return"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20";case"upcoming":return"border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-950/20";default:return"border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-950/20"}},j=a=>{switch(a){case"bronze":return"text-orange-600";case"silver":return"text-gray-600";case"gold":return"text-yellow-600";case"platinum":return"text-blue-600";default:return"text-gray-600"}},b=a=>{switch(a){case"bronze":return"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300";case"silver":return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300";case"gold":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300";case"platinum":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}};return n.length===0?e.jsxs($,{children:[e.jsx(P,{children:e.jsxs(q,{className:"flex items-center",children:[e.jsx(me,{className:"mr-2 h-5 w-5"}),"Achievement Milestones"]})}),e.jsx(M,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(oe,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Start Your Journey"}),e.jsx("p",{className:"text-muted-foreground",children:"Create goals and start saving to unlock achievements and celebrate your progress!"})]})})]}):e.jsxs($,{children:[e.jsx(P,{children:e.jsxs(q,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(me,{className:"mr-2 h-5 w-5"}),"Achievement Milestones"]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(F,{variant:"secondary",className:"flex items-center",children:[e.jsx(ve,{className:"mr-1 h-3 w-3"}),d," points"]})})]})}),e.jsxs(M,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 p-4 bg-white dark:bg-gray-900 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.filter(a=>a.status==="completed").length}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"Unlocked"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.filter(a=>a.status==="in-progress").length}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"In Progress"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:n.filter(a=>a.status==="upcoming").length}),e.jsx("div",{className:"text-xs text-gray-600/70",children:"Upcoming"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:d}),e.jsx("div",{className:"text-xs text-green-600/70",children:"Total Points"})]})]}),e.jsx("div",{className:"space-y-4",children:n.slice(0,8).map(a=>{var o;return e.jsx("div",{className:`p-4 rounded-lg border ${f(a.status)}`,"data-testid":`milestone-${a.id}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg ${a.status==="completed"?"bg-green-100 dark:bg-green-900/20":"bg-gray-100 dark:bg-gray-900/20"}`,children:e.jsx(a.icon,{className:`h-5 w-5 ${j(a.category)}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h4",{className:"font-medium",children:a.title}),e.jsx(F,{className:b(a.category),children:a.category}),a.status==="completed"&&e.jsx(je,{className:"h-4 w-4 text-green-600"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:a.description}),a.progress!==void 0&&a.status==="upcoming"&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(a.progress),"%"]})]}),e.jsx(ce,{value:a.progress,className:"h-2"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[a.points," points"]}),a.reward&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(Mt,{className:"h-3 w-3 mr-1"}),a.reward]})]}),a.status==="completed"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{size:"sm",variant:"outline",onClick:()=>l==null?void 0:l(a),"data-testid":`button-celebrate-${a.id}`,children:"Celebrate"}),e.jsx(Zt,{shareData:Qt({title:a.title,description:a.description,achievementType:a.type==="progress"?"milestone":"goal_completed",goalTitle:(o=t.find(y=>y.id===a.goalId))==null?void 0:o.title,progress:a.progress,category:a.category}),variant:"outline",size:"sm",showText:!1,achievement:!0,"data-testid":`button-share-${a.id}`})]})]})]})]})})},a.id)})}),n.length>8&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs(C,{variant:"ghost",size:"sm",className:"text-muted-foreground",children:["View ",n.length-8," More Milestones"]})})]})]})}function es({goalId:t,goalTitle:l,open:i,onOpenChange:u,children:n}){const[d,f]=A.useState(""),[j,b]=A.useState("view"),{toast:a}=he(),o=be(),{data:y=[],isLoading:m}=W({queryKey:["/api/friends"]}),{data:s=[],isLoading:r}=W({queryKey:["/api/goals",t,"shares"]}),x=K({mutationFn:h=>Q("POST",`/api/goals/${t}/share`,h),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/goals",t,"shares"]}),a({title:"Goal shared successfully",description:`${l} has been shared with your friend.`}),f("")},onError:h=>{a({title:"Failed to share goal",description:h.message||"Something went wrong",variant:"destructive"})}}),N=K({mutationFn:h=>Q("DELETE",`/api/goals/${t}/share/${h}`),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/goals",t,"shares"]}),a({title:"Share removed",description:"Access has been revoked successfully."})},onError:h=>{a({title:"Failed to remove share",description:h.message||"Something went wrong",variant:"destructive"})}}),p=K({mutationFn:({userId:h,permission:S})=>Q("PATCH",`/api/goals/${t}/share/${h}`,{permission:S}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/goals",t,"shares"]}),a({title:"Permission updated",description:"Share permission has been updated successfully."})}}),g=()=>{if(!d){a({title:"No friend selected",description:"Please select a friend to share with.",variant:"destructive"});return}x.mutate({sharedWithUserId:d,permission:j})},c=(h,S)=>`${(h==null?void 0:h[0])||""}${(S==null?void 0:S[0])||""}`.toUpperCase()||"?",w=y.filter(h=>!s.some(S=>S.sharedWith.id===h.id));return e.jsxs(ne,{open:i,onOpenChange:u,children:[n&&e.jsx(mt,{asChild:!0,children:n}),e.jsxs(le,{className:"max-w-2xl max-h-[90vh]",children:[e.jsxs(Oe,{children:[e.jsxs(Le,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5"}),"Share Goal: ",l]}),e.jsx(Be,{children:"Share this financial goal with friends. Choose whether they can view only or contribute to the goal."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4 border-b pb-6",children:[e.jsx("h3",{className:"font-semibold text-sm",children:"Share with a Friend"}),m?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading friends..."}):w.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:y.length===0?"You don't have any friends to share with yet.":"All your friends already have access to this goal."}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs(_,{value:d,onValueChange:f,children:[e.jsx(J,{"data-testid":"select-friend",children:e.jsx(Z,{placeholder:"Select a friend"})}),e.jsx(X,{children:w.map(h=>e.jsxs(G,{value:h.id,children:[h.firstName," ",h.lastName," (",h.email,")"]},h.id))})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(_,{value:j,onValueChange:h=>b(h),children:[e.jsx(J,{className:"flex-1","data-testid":"select-permission",children:e.jsx(Z,{})}),e.jsxs(X,{children:[e.jsx(G,{value:"view",children:"View Only"}),e.jsx(G,{value:"contribute",children:"Can Contribute"})]})]}),e.jsx(C,{onClick:g,disabled:!d||x.isPending,"data-testid":"button-share-goal",children:x.isPending?"Sharing...":"Share"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"View Only:"})," Friend can see the goal and its progress"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Can Contribute:"})," Friend can add funds to help reach the goal"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-sm",children:"People with Access"}),r?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading shares..."}):s.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"This goal isn't shared with anyone yet."}):e.jsx(Gt,{className:"max-h-60",children:e.jsx("div",{className:"space-y-3",children:s.map(h=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50","data-testid":`share-item-${h.sharedWith.id}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs(ut,{className:"w-10 h-10",children:[e.jsx(ht,{src:h.sharedWith.profileImageUrl}),e.jsx(xt,{children:c(h.sharedWith.firstName,h.sharedWith.lastName)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium",children:[h.sharedWith.firstName," ",h.sharedWith.lastName]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.sharedWith.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{value:h.permission,onValueChange:S=>p.mutate({userId:h.sharedWith.id,permission:S}),children:[e.jsx(J,{className:"w-32",children:e.jsx(Z,{})}),e.jsxs(X,{children:[e.jsx(G,{value:"view",children:"View Only"}),e.jsx(G,{value:"contribute",children:"Can Contribute"})]})]}),e.jsx(C,{variant:"ghost",size:"icon",onClick:()=>N.mutate(h.sharedWith.id),disabled:N.isPending,"data-testid":`button-remove-share-${h.sharedWith.id}`,children:e.jsx(pt,{className:"w-4 h-4"})})]})]},h.id))})})]})]})]})]})}function Je({value:t,prefix:l="$",delay:i=0}){const[u,n]=A.useState(0);return A.useEffect(()=>{const d=setTimeout(()=>{const b=t/60;let a=0;const o=setInterval(()=>{a+=b,a>=t?(n(t),clearInterval(o)):n(a)},1e3/60);return()=>clearInterval(o)},i);return()=>clearTimeout(d)},[t,i]),e.jsxs("span",{children:[l,Math.round(u).toLocaleString()]})}function Ze({progress:t,size:l=120,strokeWidth:i=8,delay:u=0}){const[n,d]=A.useState(0),f=(l-i)/2,j=f*2*Math.PI,b=j-n/100*j;A.useEffect(()=>{const o=setTimeout(()=>{const s=t/60;let r=0;const x=setInterval(()=>{r+=s,r>=t?(d(t),clearInterval(x)):d(r)},1200/60);return()=>clearInterval(x)},u);return()=>clearTimeout(o)},[t,u]);const a=()=>n>=80?"stroke-green-500":n>=50?"stroke-primary":n>=25?"stroke-amber-500":"stroke-red-500";return e.jsxs("div",{className:"relative",style:{width:l,height:l},children:[e.jsxs("svg",{className:"transform -rotate-90",width:l,height:l,children:[e.jsx("circle",{className:"stroke-muted",strokeWidth:i,fill:"transparent",r:f,cx:l/2,cy:l/2}),e.jsx("circle",{className:`${a()} transition-all duration-300`,strokeWidth:i,strokeLinecap:"round",fill:"transparent",r:f,cx:l/2,cy:l/2,style:{strokeDasharray:j,strokeDashoffset:b}})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-xl sm:text-2xl font-bold",children:[Math.round(n),"%"]})})]})}function ts({goalId:t}){const{formatAmount:l}=V(),{data:i,isLoading:u}=W({queryKey:["/api/transactions",t],queryFn:()=>fetch(`/api/transactions?goalId=${t}&limit=5`).then(d=>d.json())});if(u)return e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Recent Contributions"}),e.jsx("div",{className:"space-y-2",children:[...Array(3)].map((d,f)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(z,{className:"h-3 w-20"}),e.jsx(z,{className:"h-2 w-32"})]}),e.jsx(z,{className:"h-4 w-16"})]},f))})]});const n=i||[];return e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Recent Contributions"}),n.length===0?e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(Y,{className:"mx-auto h-8 w-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No contributions yet"}),e.jsx("p",{className:"text-xs",children:"Start adding funds or income to see contributions here"})]}):e.jsxs("div",{className:"space-y-2",children:[n.map((d,f)=>e.jsxs(H.div,{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:f*.1},children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`p-1.5 rounded-full ${d.type==="income"?"bg-green-100 dark:bg-green-900/20":"bg-blue-100 dark:bg-blue-900/20"}`,children:d.type==="income"?e.jsx(E,{className:`h-3 w-3 ${d.type==="income"?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"}`}):e.jsx(Y,{className:`h-3 w-3 ${d.type==="income"?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"}`})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("p",{className:"text-sm font-medium",children:[d.type==="income"?"Income":"Transfer",d.category&&` - ${d.category}`]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:d.description||`${d.type==="income"?"Income":"Transfer"} contribution`}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[e.jsx(Ne,{className:"h-3 w-3 mr-1"}),new Date(d.date).toLocaleDateString()]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:`font-semibold ${d.type==="income"?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"}`,children:["+",l(parseFloat(d.amount))]})})]},d.id)),n.length===5&&e.jsx("div",{className:"text-center py-2",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"Showing last 5 contributions"})})]})]})}function ss({goal:t,onEdit:l,onDelete:i,onAddFunds:u,onViewDetails:n,onShare:d,delay:f=0}){const{formatAmount:j,currencySymbol:b}=V(),a=parseFloat(t.currentAmount)/parseFloat(t.targetAmount)*100,o=parseFloat(t.targetAmount)-parseFloat(t.currentAmount),y=Math.ceil((new Date(t.targetDate).getTime()-new Date().getTime())/(1e3*60*60*24)),m=()=>y<0?"text-red-600 dark:text-red-400":y<30?"text-amber-600 dark:text-amber-400":"text-green-600 dark:text-green-400",s=r=>{switch(r){case"active":return e.jsx(F,{className:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 border-0",children:"Active"});case"completed":return e.jsx(F,{className:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400 border-0",children:"Completed"});case"paused":return e.jsx(F,{className:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400 border-0",children:"Paused"});default:return e.jsx(F,{variant:"secondary",children:r})}};return e.jsx(H.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:f},children:e.jsxs($,{className:"group relative overflow-hidden border-border/40 hover:shadow-lg hover:border-border transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary/50 via-primary to-primary/50",style:{clipPath:`inset(0 ${100-Math.min(a,100)}% 0 0)`}}),e.jsx(P,{className:"pb-3 sm:pb-4 p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s(t.status),a>=100&&e.jsxs(F,{className:"bg-primary/10 text-primary border-0",children:[e.jsx(oe,{className:"w-3 h-3 mr-1"}),"Goal Reached"]})]}),e.jsx(q,{className:"text-base sm:text-lg font-semibold truncate","data-testid":`text-goal-title-${t.id}`,title:t.title,children:t.title}),t.description&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground line-clamp-2 mt-1",title:t.description,children:t.description})]}),e.jsxs(Ve,{children:[e.jsx(Re,{asChild:!0,children:e.jsx(C,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity","data-testid":`button-goal-menu-${t.id}`,children:e.jsx(qt,{size:16})})}),e.jsxs(Ue,{align:"end",children:[e.jsxs(I,{onClick:l,children:[e.jsx(Qe,{size:16,className:"mr-2"}),"Edit Goal"]}),e.jsxs(I,{onClick:d,children:[e.jsx(ue,{size:16,className:"mr-2"}),"Share with Friends"]}),e.jsxs(I,{className:"text-destructive",onClick:i,children:[e.jsx(zt,{size:16,className:"mr-2"}),"Delete Goal"]})]})]})]})}),e.jsxs(M,{className:"p-4 sm:p-6 pt-0",children:[e.jsxs("div",{className:"flex items-center gap-4 sm:gap-6 mb-4 sm:mb-6",children:[e.jsx(Ze,{progress:Math.min(a,100),size:80,strokeWidth:6,delay:f*1e3+200}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current"}),e.jsx("p",{className:"text-lg sm:text-xl font-bold text-primary",children:e.jsx(Je,{value:parseFloat(t.currentAmount),prefix:b,delay:f*1e3+100})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Target"}),e.jsx("p",{className:"text-sm font-medium",children:j(parseFloat(t.targetAmount))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2.5 sm:p-3 rounded-lg bg-muted/50",children:[e.jsx(xe,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"Time Left"}),e.jsx("p",{className:`text-xs sm:text-sm font-semibold ${m()}`,children:y>0?`${y} days`:y===0?"Due today":"Overdue"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2.5 sm:p-3 rounded-lg bg-muted/50",children:[e.jsx(Y,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"Remaining"}),e.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:j(o)})]})]})]}),y>0&&o>0&&e.jsx("div",{className:"p-2.5 sm:p-3 rounded-lg bg-primary/5 border border-primary/10 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-primary"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Save ",e.jsxs("span",{className:"font-semibold text-foreground",children:[j(Math.ceil(o/y)),"/day"]})," to reach your goal"]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(C,{variant:"outline",size:"sm",className:"flex-1 text-xs h-9",onClick:u,"data-testid":`button-add-funds-${t.id}`,children:[e.jsx(de,{className:"w-3.5 h-3.5 mr-1.5"}),"Add Funds"]}),e.jsx(C,{size:"sm",className:"flex-1 text-xs h-9",onClick:n,"data-testid":`button-view-details-${t.id}`,children:"View Details"})]})]})]})})}function ye({title:t,value:l,icon:i,colorClass:u,bgClass:n,delay:d=0,suffix:f="",currencyPrefix:j=""}){return e.jsx(H.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:d},children:e.jsx($,{className:"border-border/40 hover:shadow-md transition-shadow",children:e.jsxs(M,{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[e.jsx("div",{className:`p-2 rounded-xl ${n}`,children:e.jsx(i,{className:`w-4 h-4 sm:w-5 sm:h-5 ${u}`})}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:t})]}),e.jsxs("p",{className:`text-xl sm:text-2xl md:text-3xl font-bold tracking-tight ${u}`,children:[e.jsx(Je,{value:l,prefix:f?"":j,delay:d*1e3}),f&&e.jsx("span",{className:"text-lg sm:text-xl text-muted-foreground/60",children:f})]})]})})})}function Bs(){const{t}=gt(),{formatAmount:l,currencySymbol:i}=V(),[u,n]=A.useState(!1),[d,f]=A.useState(!1),[j,b]=A.useState("overview");A.useEffect(()=>{new URLSearchParams(window.location.search).get("create")==="1"&&(n(!0),window.history.replaceState({},"","/financial-goals"))},[]);const[a,o]=A.useState(!1),[y,m]=A.useState(!1),[s,r]=A.useState(!1),[x,N]=A.useState(!1),[p,g]=A.useState(null),{toast:c}=he(),w=be(),{data:h,isLoading:S}=W({queryKey:["/api/financial-goals"],queryFn:()=>fetch("/api/financial-goals").then(v=>v.json())}),k=h||[],R=K({mutationFn:v=>Q("DELETE",`/api/financial-goals/${v}`),onSuccess:()=>{w.invalidateQueries({queryKey:["/api/financial-goals"]}),c({title:"Goal deleted",description:"The financial goal has been successfully deleted.",icon:e.jsx(yt,{className:"h-5 w-5 text-green-600 dark:text-green-400"})})},onError:v=>{c({title:"Couldn't Delete Goal",description:v.message||"Something went wrong. Please try again.",variant:"destructive",icon:e.jsx(ft,{className:"h-5 w-5"})})}}),Xe=v=>{confirm("Are you sure you want to delete this goal?")&&R.mutate(v)},ge=v=>{g(v),o(!0)},te=v=>{g(v),m(!0)},we=v=>{g(v),r(!0)},et=v=>{g(v),N(!0)},tt=(v,D)=>{switch(v){case"review-timeline":if(D){const O=k.find(fe=>fe.id===D);O&&ge(O)}break;case"quick-contribute":if(D){const O=k.find(fe=>fe.id===D);O&&te(O)}else k.length>0&&te(k[0]);break;case"create-short-term":n(!0);break;default:c({title:"Coming Soon",description:"This feature will be available in a future update."})}},st=v=>{c({title:"Suggestion Noted",description:`We'll help you implement: ${v.title}`})},at=v=>{c({title:"Congratulations!",description:`You've unlocked: ${v.title}`})},rt=k.reduce((v,D)=>v+parseFloat(D.currentAmount||0),0),it=k.filter(v=>v.status==="active").length,nt=k.length>0?Math.round(k.reduce((v,D)=>{const O=parseFloat(D.currentAmount||0)/parseFloat(D.targetAmount||1)*100;return v+O},0)/k.length):0;return S?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border/40 sticky top-0 z-30",children:e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 py-6",children:[e.jsx(z,{className:"h-8 w-48 mb-2"}),e.jsx(z,{className:"h-4 w-64"})]})}),e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 py-8",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[...Array(3)].map((v,D)=>e.jsxs($,{className:"p-6",children:[e.jsx(z,{className:"h-10 w-10 rounded-xl mb-3"}),e.jsx(z,{className:"h-4 w-24 mb-2"}),e.jsx(z,{className:"h-8 w-32"})]},D))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[...Array(6)].map((v,D)=>e.jsx(jt,{},D))})]})]}):e.jsxs("div",{className:"min-h-screen-mobile bg-background pb-20 md:pb-0",children:[e.jsx(Ce,{open:d,onOpenChange:f,children:e.jsx(De,{className:"max-h-[90vh]",children:e.jsxs("div",{className:"p-4 pb-6",children:[e.jsx(Fe,{className:"text-xl font-semibold mb-2",children:"Create Your First Goal"}),e.jsx($e,{className:"text-muted-foreground mb-4",children:"Start your financial journey by setting up your first savings goal"}),e.jsx(Te,{onSuccess:()=>f(!1)})]})})}),e.jsx("header",{className:"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border/40 sticky top-0 z-30",children:e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 py-4 sm:py-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs(H.div,{className:"flex-1 min-w-0",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4},children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-semibold tracking-tight text-foreground",children:"Financial Goals"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5 sm:mt-1 hidden sm:block",children:"Track your savings progress and achieve your financial targets"})]}),e.jsx(H.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.2},children:e.jsxs(Ce,{open:u,onOpenChange:n,children:[e.jsx(vt,{asChild:!0,children:e.jsxs(C,{className:"shadow-sm min-h-[44px]","data-testid":"button-create-goal",children:[e.jsx(de,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"New Goal"}),e.jsx("span",{className:"sm:hidden",children:"New"})]})}),e.jsx(De,{className:"max-h-[90vh]",children:e.jsxs("div",{className:"p-4 pb-6",children:[e.jsx(Fe,{className:"text-xl font-semibold mb-2",children:"Create New Goal"}),e.jsx($e,{className:"text-muted-foreground mb-4",children:"Set up a new financial goal to track your savings progress"}),e.jsx(Te,{onSuccess:()=>n(!1)})]})})]})})]})})}),e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 py-4 sm:py-6 md:py-8",children:[e.jsxs(Nt,{value:j,onValueChange:b,className:"space-y-4 sm:space-y-6",children:[e.jsx(H.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(wt,{className:"grid w-full grid-cols-4 h-auto bg-muted/50",children:[e.jsxs(ae,{value:"overview","data-testid":"tab-overview",className:"text-xs sm:text-sm min-h-[44px] py-2.5 sm:py-2 data-[state=active]:bg-background data-[state=active]:shadow-sm","aria-label":"Overview",children:[e.jsx(ee,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Overview"})]}),e.jsxs(ae,{value:"analytics","data-testid":"tab-analytics",className:"text-xs sm:text-sm min-h-[44px] py-2.5 sm:py-2 data-[state=active]:bg-background data-[state=active]:shadow-sm","aria-label":"Analytics",children:[e.jsx(Ye,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Analytics"})]}),e.jsxs(ae,{value:"insights","data-testid":"tab-insights",className:"text-xs sm:text-sm min-h-[44px] py-2.5 sm:py-2 data-[state=active]:bg-background data-[state=active]:shadow-sm","aria-label":"Insights",children:[e.jsx(We,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Insights"})]}),e.jsxs(ae,{value:"achievements","data-testid":"tab-achievements",className:"text-xs sm:text-sm min-h-[44px] py-2.5 sm:py-2 data-[state=active]:bg-background data-[state=active]:shadow-sm","aria-label":"Achievements",children:[e.jsx(me,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Achievements"})]})]})}),e.jsx(re,{value:"overview",className:"space-y-4 sm:space-y-6",children:k.length===0?e.jsx(bt,{illustration:"goals",title:"No Financial Goals Yet",description:"Create your first financial goal to start tracking your savings progress and build your future.",actionLabel:"Create Your First Goal",onAction:()=>f(!0),actionTestId:"button-create-first-goal"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsx(ye,{title:"Total Saved",value:rt,icon:Ke,colorClass:"text-green-600 dark:text-green-400",bgClass:"bg-green-100 dark:bg-green-900/30",delay:0,currencyPrefix:i}),e.jsx(ye,{title:"Active Goals",value:it,icon:ee,colorClass:"text-primary",bgClass:"bg-primary/10",delay:.1,suffix:""}),e.jsx(ye,{title:"Avg Progress",value:nt,icon:E,colorClass:"text-blue-600 dark:text-blue-400",bgClass:"bg-blue-100 dark:bg-blue-900/30",delay:.2,suffix:"%"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:e.jsx(Pt,{mode:"popLayout",children:k.map((v,D)=>e.jsx(ss,{goal:v,onEdit:()=>ge(v),onDelete:()=>Xe(v.id),onAddFunds:()=>te(v),onViewDetails:()=>we(v),onShare:()=>et(v),delay:D*.1},v.id))})})]})}),e.jsx(re,{value:"analytics",className:"space-y-6",children:e.jsx(Ht,{goals:k,onGoalClick:we})}),e.jsx(re,{value:"insights",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Yt,{goals:k,onActionClick:tt}),e.jsx(Wt,{goals:k,onImplementSuggestion:st})]})}),e.jsx(re,{value:"achievements",className:"space-y-6",children:e.jsx(Xt,{goals:k,onCelebrate:at})})]}),e.jsx(ne,{open:a,onOpenChange:o,children:e.jsx(le,{className:"w-[95vw] max-w-2xl max-h-[90vh] overflow-y-auto",children:p&&e.jsx(Ut,{goal:p,onSuccess:()=>o(!1)})})}),e.jsx(ne,{open:y,onOpenChange:m,children:e.jsx(le,{className:"w-[95vw] max-w-md max-h-[90vh] overflow-y-auto",children:p&&e.jsx(At,{goalId:p.id,goalTitle:p.title,currentAmount:p.currentAmount,targetAmount:p.targetAmount,onSuccess:()=>m(!1)})})}),p&&e.jsx(es,{goalId:p.id,goalTitle:p.title,open:x,onOpenChange:N}),e.jsx(ne,{open:s,onOpenChange:r,children:e.jsx(le,{className:"w-[95vw] max-w-2xl max-h-[90vh] overflow-y-auto",children:p&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-1",children:p.title}),p.description&&e.jsx("p",{className:"text-muted-foreground text-sm",children:p.description})]}),e.jsx("div",{className:"flex items-center justify-center py-6",children:e.jsx(Ze,{progress:Math.min(parseFloat(p.currentAmount)/parseFloat(p.targetAmount)*100,100),size:160,strokeWidth:12})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Current Amount"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:l(parseFloat(p.currentAmount))})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Target Amount"}),e.jsx("p",{className:"text-xl font-bold",children:l(parseFloat(p.targetAmount))})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Remaining"}),e.jsx("p",{className:"text-xl font-bold",children:l(parseFloat(p.targetAmount)-parseFloat(p.currentAmount))})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Target Date"}),e.jsx("p",{className:"text-xl font-bold",children:new Date(p.targetDate).toLocaleDateString()})]})]}),e.jsx(ts,{goalId:p.id}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(C,{variant:"outline",className:"flex-1",onClick:()=>ge(p),children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Edit Goal"]}),e.jsxs(C,{className:"flex-1",onClick:()=>{r(!1),te(p)},children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Add Funds"]})]})]})})})]})]})}export{Bs as default};
