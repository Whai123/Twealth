import{c as V,a8 as X,r as v,q as Z,ae as _,y,z as w,B as k,j as e,ar as D,O as h,Q as C,S as q,V as F,_ as j,K as J,ay as p,aA as g,H as d,I as W,X as ee,Z as se,s as ae,t as te,v as re,w as ie,ak as ne}from"./index-NNgTI0RQ.js";import{B as de}from"./badge-D7Q8E7hz.js";import{T as le,a as ce,b as E,c as M}from"./tabs-a-uRWqhW.js";import{T as oe}from"./textarea-CFY__GU9.js";import{M as I}from"./mail-Ct9URLDv.js";import{S as $}from"./search-BBfzKtVe.js";import{C as me}from"./calendar-CwD0FHKB.js";import{T as xe}from"./trending-up-BnP5NHLE.js";import{M as ue}from"./message-square-T3TIwvoE.js";import{U as he}from"./user-plus-BpZZgIzm.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=V("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function qe(){const{t:m}=X(),[l,K]=v.useState(""),[i,S]=v.useState(null),[L,U]=v.useState(""),[Q,f]=v.useState(!1),{toast:n}=Z(),x=_(),{data:t=[],isLoading:z}=y({queryKey:["/api/friends"]}),{data:r=[],isLoading:R}=y({queryKey:["/api/friend-requests/pending"]}),{data:c=[],isLoading:B}=y({queryKey:["/api/friend-requests/sent"]}),{data:o=[],isLoading:H}=y({queryKey:["/api/users/search",l],queryFn:async()=>{if(l.length<2)return[];const s=await fetch(`/api/users/search?q=${encodeURIComponent(l)}`);if(!s.ok)return[];const a=await s.json();return Array.isArray(a)?a:[]},enabled:l.length>=2}),b=w({mutationFn:async({toUserId:s,message:a})=>(await k("POST","/api/friend-requests",{toUserId:s,message:a})).json(),onSuccess:()=>{x.invalidateQueries({queryKey:["/api/friend-requests/sent"]}),f(!1),S(null),U(""),n({title:m("common.success"),description:m("common.success")})},onError:s=>{n({title:"Error",description:s.message||m("common.error"),variant:"destructive"})}}),N=w({mutationFn:async({requestId:s,status:a})=>(await k("PUT",`/api/friend-requests/${s}/respond`,{status:a})).json(),onSuccess:(s,a)=>{x.invalidateQueries({queryKey:["/api/friend-requests/pending"]}),x.invalidateQueries({queryKey:["/api/friends"]}),n({title:(a.status==="accepted",m("common.success")),description:a.status==="accepted"?"You are now friends!":"Friend request declined."})},onError:s=>{n({title:"Error",description:s.message||"Failed to respond to friend request",variant:"destructive"})}}),P=w({mutationFn:async s=>{await k("DELETE",`/api/friends/${s}`)},onSuccess:()=>{x.invalidateQueries({queryKey:["/api/friends"]}),n({title:"Friend removed",description:"You are no longer friends with this user."})},onError:s=>{n({title:"Error",description:s.message||"Failed to remove friend",variant:"destructive"})}}),A=w({mutationFn:async s=>{await k("DELETE",`/api/friend-requests/${s}`)},onSuccess:()=>{x.invalidateQueries({queryKey:["/api/friend-requests/sent"]}),n({title:"Friend request cancelled",description:"Your friend request has been cancelled."})},onError:s=>{n({title:"Error",description:s.message||"Failed to cancel friend request",variant:"destructive"})}}),u=(s,a)=>{const T=(s==null?void 0:s.charAt(0))||"",G=(a==null?void 0:a.charAt(0))||"";return(T+G).toUpperCase()||"?"},O=s=>{S(s),f(!0)},Y=()=>{i&&b.mutate({toUserId:i.id,message:L.trim()||void 0})};return e.jsx("div",{className:"min-h-screen bg-pink-50 dark:bg-pink-900/20",children:e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 py-4 sm:py-6 md:py-8",children:[e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-bold mb-2 text-pink-600 dark:text-pink-400",children:"Friends"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Connect with friends to collaborate on groups and events"})]}),e.jsxs(le,{defaultValue:"friends",className:"space-y-6",children:[e.jsxs(ce,{children:[e.jsxs(E,{value:"friends","data-testid":"tab-friends",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"My Friends ",(t==null?void 0:t.length)>0&&`(${t.length})`]}),e.jsxs(E,{value:"requests","data-testid":"tab-requests",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Requests ",(r==null?void 0:r.length)>0&&`(${r.length})`]}),e.jsxs(E,{value:"search","data-testid":"tab-search",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Find Friends"]})]}),e.jsx(M,{value:"friends",children:e.jsxs(h,{children:[e.jsx(C,{children:e.jsx(q,{children:"My Friends"})}),e.jsx(F,{children:z?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(j,{className:"h-6 w-6"})}):(t==null?void 0:t.length)===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsxs("div",{className:"relative mb-10",children:[e.jsx("div",{className:"absolute inset-0 bg-pink-500/20 rounded-full blur-3xl"}),e.jsx("div",{className:"relative bg-pink-500 rounded-3xl p-6 w-32 h-32 mx-auto flex items-center justify-center shadow-2xl",children:e.jsx(D,{className:"h-16 w-16 text-white"})})]}),e.jsx("h3",{className:"text-3xl font-bold text-pink-600 dark:text-pink-400 mb-3",children:"Build Your Network"}),e.jsx("p",{className:"text-muted-foreground text-lg mb-4 max-w-lg mx-auto",children:"Connect with friends to collaborate on goals, share events, and achieve more together"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-3xl mx-auto mb-10",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl p-6 border border-blue-200/50 dark:border-blue-700/50",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 dark:bg-blue-500 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-lg",children:e.jsx(J,{className:"h-6 w-6 text-white"})}),e.jsx("h4",{className:"font-bold mb-2 text-blue-800 dark:text-blue-200",children:"Shared Goals"}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-300",children:"Collaborate on financial targets"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl p-6 border border-blue-200/50 dark:border-blue-700/50",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 dark:bg-blue-500 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-lg",children:e.jsx(me,{className:"h-6 w-6 text-white"})}),e.jsx("h4",{className:"font-bold mb-2 text-blue-800 dark:text-blue-200",children:"Group Events"}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-300",children:"Plan activities together"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl p-6 border border-blue-200/50 dark:border-blue-700/50",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 dark:bg-blue-500 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-lg",children:e.jsx(xe,{className:"h-6 w-6 text-white"})}),e.jsx("h4",{className:"font-bold mb-2 text-blue-800 dark:text-blue-200",children:"Social Motivation"}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-300",children:"Stay accountable together"})]})]}),e.jsx("p",{className:"text-muted-foreground mb-6",children:'Use the"Find Friends" tab to search for people and send friend requests'})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:t==null?void 0:t.map(s=>e.jsx(h,{className:"p-4","data-testid":`friend-card-${s.id}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(p,{children:e.jsx(g,{children:u(s.firstName,s.lastName)})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold","data-testid":`friend-name-${s.id}`,children:[s.firstName," ",s.lastName]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email})]})]}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>P.mutate(s.id),disabled:P.isPending,"data-testid":`button-remove-friend-${s.id}`,children:e.jsx(je,{className:"h-4 w-4"})})]})},s.id))})})]})}),e.jsx(M,{value:"requests",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(h,{children:[e.jsx(C,{children:e.jsx(q,{children:"Pending Requests"})}),e.jsx(F,{children:R?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(j,{className:"h-6 w-6"})}):(r==null?void 0:r.length)===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(I,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No pending friend requests"})]}):e.jsx("div",{className:"space-y-4",children:r==null?void 0:r.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg","data-testid":`request-${s.id}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(p,{children:e.jsx(g,{children:u(s.fromUser.firstName,s.fromUser.lastName)})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:[s.fromUser.firstName," ",s.fromUser.lastName]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.fromUser.email}),s.message&&e.jsxs("p",{className:"text-sm mt-1 text-muted-foreground flex items-center",children:[e.jsx(ue,{className:"h-3 w-3 mr-1"}),s.message]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(d,{size:"sm",onClick:()=>N.mutate({requestId:s.id,status:"accepted"}),disabled:N.isPending,"data-testid":`button-accept-${s.id}`,children:[e.jsx(W,{className:"h-4 w-4 mr-1"}),"Accept"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>N.mutate({requestId:s.id,status:"declined"}),disabled:N.isPending,"data-testid":`button-decline-${s.id}`,children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),"Decline"]})]})]},s.id))})})]}),e.jsxs(h,{children:[e.jsx(C,{children:e.jsx(q,{children:"Sent Requests"})}),e.jsx(F,{children:B?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(j,{className:"h-6 w-6"})}):(c==null?void 0:c.length)===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{children:"No sent friend requests"})}):e.jsx("div",{className:"space-y-4",children:c==null?void 0:c.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(p,{children:e.jsx(g,{children:u(s.toUser.firstName,s.toUser.lastName)})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:[s.toUser.firstName," ",s.toUser.lastName]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.toUser.email}),e.jsx(de,{variant:"secondary",className:"mt-1",children:"Pending"})]})]}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>A.mutate(s.id),disabled:A.isPending,"data-testid":`button-cancel-${s.id}`,children:"Cancel"})]},s.id))})})]})]})}),e.jsx(M,{value:"search",children:e.jsxs(h,{children:[e.jsx(C,{children:e.jsx(q,{children:"Find Friends"})}),e.jsx(F,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(se,{placeholder:"Search by name or email...",value:l,onChange:s=>K(s.target.value),className:"pl-10","data-testid":"input-search-users"})]}),l.length<2?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx($,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Enter at least 2 characters to search for users"})]}):H?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(j,{className:"h-6 w-6"})}):(o==null?void 0:o.length)===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{children:"No users found"})}):e.jsx("div",{className:"space-y-4",children:o==null?void 0:o.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg","data-testid":`search-result-${s.id}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(p,{children:e.jsx(g,{children:u(s.firstName,s.lastName)})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:[s.firstName," ",s.lastName]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email})]})]}),e.jsxs(d,{size:"sm",onClick:()=>O(s),disabled:b.isPending,"data-testid":`button-add-friend-${s.id}`,children:[e.jsx(he,{className:"h-4 w-4 mr-1"}),"Add Friend"]})]},s.id))})]})})]})})]}),e.jsx(ae,{open:Q,onOpenChange:f,children:e.jsxs(te,{children:[e.jsx(re,{children:e.jsx(ie,{children:"Send Friend Request"})}),e.jsxs("div",{className:"space-y-4",children:[i&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-muted rounded-lg",children:[e.jsx(p,{children:e.jsx(g,{children:u(i.firstName,i.lastName)})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:[i.firstName," ",i.lastName]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.email})]})]}),e.jsxs("div",{children:[e.jsx(ne,{htmlFor:"message",children:"Add a message (optional)"}),e.jsx(oe,{id:"message",placeholder:"Hi! I'd like to connect with you...",value:L,onChange:s=>U(s.target.value),className:"mt-2",rows:3,"data-testid":"textarea-friend-request-message"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(d,{variant:"outline",onClick:()=>{f(!1),S(null),U("")},"data-testid":"button-cancel-request",children:"Cancel"}),e.jsxs(d,{onClick:Y,disabled:b.isPending,"data-testid":"button-send-request",children:[b.isPending&&e.jsx(j,{className:"h-4 w-4 mr-2"}),"Send Request"]})]})]})]})})]})})}export{qe as default};
